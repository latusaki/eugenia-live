jade=function(e){function t(e){return e!=null}return Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}),e.merge=function(n,r){var i=n["class"],s=r["class"];if(i||s)i=i||[],s=s||[],Array.isArray(i)||(i=[i]),Array.isArray(s)||(s=[s]),i=i.filter(t),s=s.filter(t),n["class"]=i.concat(s).join(" ");for(var o in r)o!="class"&&(n[o]=r[o]);return n},e.attrs=function(n,r){var i=[],s=n.terse;delete n.terse;var o=Object.keys(n),u=o.length;if(u){i.push("");for(var a=0;a<u;++a){var f=o[a],l=n[f];"boolean"==typeof l||null==l?l&&(s?i.push(f):i.push(f+'="'+f+'"')):0==f.indexOf("data")&&"string"!=typeof l?i.push(f+"='"+JSON.stringify(l)+"'"):"class"==f&&Array.isArray(l)?i.push(f+'="'+e.escape(l.join(" "))+'"'):r&&r[f]?i.push(f+'="'+e.escape(l)+'"'):i.push(f+'="'+l+'"')}}return i.join(" ")},e.escape=function(t){return String(t).replace(/&(?!(\w+|\#\d+);)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},e.rethrow=function(t,n,r){if(!n)throw t;var i=3,s=require("fs").readFileSync(n,"utf8"),o=s.split("\n"),u=Math.max(r-i,0),a=Math.min(o.length,r+i),i=o.slice(u,a).map(function(e,t){var n=t+u+1;return(n==r?"  > ":"    ")+n+"| "+e}).join("\n");throw t.path=n,t.message=(n||"Jade")+":"+r+"\n"+i+"\n\n"+t.message,t},e}({});var paper=new function(){var e=new function(){function h(e,n,r,s,o,u){function l(t,s,u,l){var s=s||(s=f(n,t))&&(s.get?s:s.value);typeof s=="string"&&s[0]==="#"&&(s=e[s.substring(1)]||s);var h=typeof s=="function",p=s,d=o||h?s&&s.get?t in e:e[t]:null,v;if((u||s!==undefined&&n.hasOwnProperty(t))&&(!o||!d)){h&&d&&(s.base=d),h&&a&&s.length===0&&(v=t.match(/^(get|is)(([A-Z])(.*))$/))&&a.push([v[3].toLowerCase()+v[4],v[2]]);if(!p||h||!p.get)p={value:p,writable:!0};(f(e,t)||{configurable:!0}).configurable&&(p.configurable=!0,p.enumerable=r),c(e,t,p)}l&&h&&(!o||!l[t])&&(l[t]=function(n){return n&&e[t].apply(n,i.call(arguments,1))})}var a;if(n){a=[];for(var h in n)n.hasOwnProperty(h)&&!t.test(h)&&l(h,null,!0,u);l("toString"),l("valueOf");for(var p=0,d=a&&a.length;p<d;p++)try{var v=a[p],m=v[1];l(v[0],{get:e["get"+m]||e["is"+m],set:e["set"+m]},!0)}catch(g){}}return e}function p(t,n,r,i){try{t&&(i||typeof i=="undefined"&&u(t)?s:o).call(t,n,r=r||t)}catch(a){if(a!==e.stop)throw a}return r}function d(e){return p(e,function(e,t){this[t]=e},new e.constructor)}var t=/^(statics|generics|preserve|enumerable|prototype|toString|valueOf)$/,n=Object.prototype.toString,r=Array.prototype,i=r.slice,s=r.forEach||function(e,t){for(var n=0,r=this.length;n<r;n++)e.call(t,this[n],n,this)},o=function(e,t){for(var n in this)this.hasOwnProperty(n)&&e.call(t,this[n],n,this)},u=Array.isArray=Array.isArray||function(e){return n.call(e)==="[object Array]"},a=Object.create||function(e){return{__proto__:e}},f=Object.getOwnPropertyDescriptor||function(e,t){var n=e.__lookupGetter__&&e.__lookupGetter__(t);return n?{get:n,set:e.__lookupSetter__(t),enumerable:!0,configurable:!0}:e.hasOwnProperty(t)?{value:e[t],enumerable:!0,configurable:!0,writable:!0}:null},l=Object.defineProperty||function(e,t,n){return(n.get||n.set)&&e.__defineGetter__?(n.get&&e.__defineGetter__(t,n.get),n.set&&e.__defineSetter__(t,n.set)):e[t]=n.value,e},c=function(e,t,n){return delete e[t],l(e,t,n)};return h(function(){},{inject:function(e){if(e){var t=this.prototype,n=Object.getPrototypeOf(t).constructor,r=e.statics===!0?e:e.statics;r!=e&&h(t,e,e.enumerable,n&&n.prototype,e.preserve,e.generics&&this),h(this,r,!0,n,e.preserve)}for(var i=1,s=arguments.length;i<s;i++)this.inject(arguments[i]);return this},extend:function(){var e=this,t;for(var n=0,r=arguments.length;n<r;n++)if(t=arguments[n].initialize)break;return t=t||function(){e.apply(this,arguments)},t.prototype=a(this.prototype),c(t.prototype,"constructor",{value:t,writable:!0,configurable:!0}),h(t,this,!0),arguments.length?this.inject.apply(t,arguments):t}},!0).inject({inject:function(){for(var e=0,t=arguments.length;e<t;e++)h(this,arguments[e],arguments[e].enumerable);return this},extend:function(){var e=a(this);return e.inject.apply(e,arguments)},each:function(e,t){return p(this,e,t)},clone:function(){return d(this)},statics:{each:p,clone:d,define:c,describe:f,create:function(e){return a(e.prototype)},isPlainObject:function(t){var n=t!=null&&t.constructor;return n&&(n===Object||n===e||n.name==="Object")},check:function(e){return!!e||e===0},pick:function(){for(var e=0,t=arguments.length;e<t;e++)if(arguments[e]!==undefined)return arguments[e];return null},stop:{}}})};typeof module!="undefined"&&(module.exports=e),e.inject({generics:!0,clone:function(){return new this.constructor(this)},toString:function(){return this._id!=null?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+e.each(this,function(e,t){if(!/^_/.test(t)){var n=typeof e;this.push(t+": "+(n==="number"?s.instance.number(e):n==="string"?"'"+e+"'":e))}},[]).join(", ")+" }"},exportJSON:function(t){return e.exportJSON(this,t)},toJSON:function(){return e.serialize(this)},_set:function(t,n){if(t&&e.isPlainObject(t)){for(var r in t)t.hasOwnProperty(r)&&r in this&&(!n||!n[r])&&(this[r]=t[r]);return!0}},statics:{exports:{},extend:function tt(){var t=tt.base.apply(this,arguments),n=t.prototype._class;return n&&!e.exports[n]&&(e.exports[n]=t),t},equals:function(t,n){function r(e,t){for(var n in e)if(e.hasOwnProperty(n)&&typeof t[n]=="undefined")return!1;return!0}if(t===n)return!0;if(t&&t.equals)return t.equals(n);if(n&&n.equals)return n.equals(t);if(Array.isArray(t)&&Array.isArray(n)){if(t.length!==n.length)return!1;for(var i=0,s=t.length;i<s;i++)if(!e.equals(t[i],n[i]))return!1;return!0}if(t&&typeof t=="object"&&n&&typeof n=="object"){if(!r(t,n)||!r(n,t))return!1;for(var i in t)if(t.hasOwnProperty(i)&&!e.equals(t[i],n[i]))return!1;return!0}return!1},read:function(t,n,r,i){if(this===e){var s=this.peek(t,n);return t._index++,t.__read=1,s}var o=this.prototype,u=o._readIndex,a=n||u&&t._index||0;r||(r=t.length-a);var f=t[a];return f instanceof this||i&&i.readNull&&f==null&&r<=1?(u&&(t._index=a+1),f&&i&&i.clone?f.clone():f):(f=e.create(this),u&&(f.__read=!0),i&&(f.__options=i),f=f.initialize.apply(f,a>0||r<t.length?Array.prototype.slice.call(t,a,a+r):t)||f,u&&(t._index=a+f.__read,t.__read=f.__read,delete f.__read,i&&delete f.__options),f)},peek:function(e,t){return e[e._index=t||e._index||0]},readAll:function(e,t,n){var r=[],i;for(var s=t||0,o=e.length;s<o;s++)r.push(Array.isArray(i=e[s])?this.read(i,0,0,n):this.read(e,s,1,n));return r},readNamed:function(e,t,n,r,i){var s=this.getNamed(e,t);return this.read(s!=null?[s]:e,n,r,i)},getNamed:function(t,n){var r=t[0];t._hasObject===undefined&&(t._hasObject=t.length===1&&e.isPlainObject(r));if(t._hasObject)return n?r[n]:r},hasNamed:function(e,t){return!!this.getNamed(e,t)},isPlainValue:function(e){return this.isPlainObject(e)||Array.isArray(e)},serialize:function(t,n,r,i){n=n||{};var o=!i,u;o&&(n.formatter=new s(n.precision),i={length:0,definitions:{},references:{},add:function(e,t){var n="#"+e._id,r=this.references[n];if(!r){this.length++;var i=t.call(e),s=e._class;s&&i[0]!==s&&i.unshift(s),this.definitions[n]=i,r=this.references[n]=[n]}return r}});if(t&&t._serialize){u=t._serialize(n,i);var a=t._class;a&&!r&&!u._compact&&u[0]!==a&&u.unshift(a)}else if(Array.isArray(t)){u=[];for(var f=0,l=t.length;f<l;f++)u[f]=e.serialize(t[f],n,r,i);r&&(u._compact=!0)}else if(e.isPlainObject(t)){u={};for(var f in t)t.hasOwnProperty(f)&&(u[f]=e.serialize(t[f],n,r,i))}else typeof t=="number"?u=n.formatter.number(t,n.precision):u=t;return o&&i.length>0?[["dictionary",i.definitions],u]:u},deserialize:function(t,n){var r=t;n=n||{};if(Array.isArray(t)){var i=t[0],s=i==="dictionary";if(!s){if(n.dictionary&&t.length==1&&/^#/.test(i))return n.dictionary[i];i=e.exports[i]}r=[];for(var o=i?1:0,u=t.length;o<u;o++)r.push(e.deserialize(t[o],n));if(s)n.dictionary=r[0];else if(i){var a=r;r=e.create(i),i.apply(r,a)}}else if(e.isPlainObject(t)){r={};for(var f in t)r[f]=e.deserialize(t[f],n)}return r},exportJSON:function(t,n){return JSON.stringify(e.serialize(t,n))},importJSON:function(t){return e.deserialize(typeof t=="string"?JSON.parse(t):t)},splice:function(e,t,n,r){var i=t&&t.length,s=n===undefined;n=s?e.length:n,n>e.length&&(n=e.length);for(var o=0;o<i;o++)t[o]._index=n+o;if(s)return e.push.apply(e,t),[];var u=[n,r];t&&u.push.apply(u,t);var a=e.splice.apply(e,u);for(var o=0,f=a.length;o<f;o++)delete a[o]._index;for(var o=n+i,f=e.length;o<f;o++)e[o]._index=o;return a},merge:function(){return e.each(arguments,function(t){e.each(t,function(e,t){this[t]=e},this)},new e,!0)},capitalize:function(e){return e.replace(/\b[a-z]/g,function(e){return e.toUpperCase()})},camelize:function(e){return e.replace(/-(.)/g,function(e,t){return t.toUpperCase()})},hyphenate:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var t={attach:function(t,n){if(typeof t!="string"){e.each(t,function(e,t){this.attach(t,e)},this);return}var r=this._eventTypes[t];if(r){var i=this._handlers=this._handlers||{};i=i[t]=i[t]||[],i.indexOf(n)==-1&&(i.push(n),r.install&&i.length==1&&r.install.call(this,t))}},detach:function(t,n){if(typeof t!="string"){e.each(t,function(e,t){this.detach(t,e)},this);return}var r=this._eventTypes[t],i=this._handlers&&this._handlers[t],s;r&&i&&(!n||(s=i.indexOf(n))!=-1&&i.length==1?(r.uninstall&&r.uninstall.call(this,t),delete this._handlers[t]):s!=-1&&i.splice(s,1))},once:function(e,t){this.attach(e,function(){t.apply(this,arguments),this.detach(e,t)})},fire:function(t,n){var r=this._handlers&&this._handlers[t];if(!r)return!1;var i=[].slice.call(arguments,1);return e.each(r,function(e){e.apply(this,i)===!1&&n&&n.stop&&n.stop()},this),!0},responds:function(e){return!!this._handlers&&!!this._handlers[e]},on:"#attach",off:"#detach",trigger:"#fire",statics:{inject:function nt(){for(var t=0,n=arguments.length;t<n;t++){var r=arguments[t],i=r._events;if(i){var s={};e.each(i,function(t,n){var i=typeof t=="string",o=i?t:n,u=e.capitalize(o),a=o.substring(2).toLowerCase();s[a]=i?{}:t,o="_"+o,r["get"+u]=function(){return this[o]},r["set"+u]=function(e){e?this.attach(a,e):this[o]&&this.detach(a,this[o]),this[o]=e}}),r._eventTypes=s}nt.base.call(this,r)}return this}}},n=e.extend({_class:"PaperScope",initialize:function rt(e){paper=this,this.project=null,this.projects=[],this.tools=[],this.palettes=[],this._id=e&&(e.getAttribute("id")||e.src)||"paperscope-"+rt._id++,e&&e.setAttribute("id",this._id),rt._scopes[this._id]=this;if(!this.support){var t=G.getContext(1,1);rt.prototype.support={nativeDash:"setLineDash"in t||"mozDash"in t,nativeBlendModes:Y.nativeModes},G.release(t)}},version:"0.9.9",getView:function(){return this.project&&this.project.view},getTool:function(){return this._tool||(this._tool=new Q),this._tool},evaluate:function(e){var t=paper.PaperScript.evaluate(e,this);return U.updateFocus(),t},install:function(t){var n=this;e.each(["project","view","tool"],function(r){e.define(t,r,{configurable:!0,get:function(){return n[r]}})});for(var r in this)!/^(version|_id)/.test(r)&&!(r in t)&&(t[r]=this[r])},setup:function(e){return paper=this,this.project=new m(e),this},activate:function(){paper=this},clear:function(){for(var e=this.projects.length-1;e>=0;e--)this.projects[e].remove();for(var e=this.tools.length-1;e>=0;e--)this.tools[e].remove();for(var e=this.palettes.length-1;e>=0;e--)this.palettes[e].remove()},remove:function(){this.clear(),delete n._scopes[this._id]},statics:new function(){function e(e){return e+="Attribute",function(t,n){return t[e](n)||t[e]("data-paper-"+n)}}return{_scopes:{},_id:0,get:function(e){return typeof e=="object"&&(e=e.getAttribute("id")),this._scopes[e]||null},getAttribute:e("get"),hasAttribute:e("has")}}}),r=e.extend(t,{initialize:function(e){this._scope=paper,this._index=this._scope[this._list].push(this)-1,(e||!this._scope[this._reference])&&this.activate()},activate:function(){if(!this._scope)return!1;var e=this._scope[this._reference];return e&&e!=this&&e.fire("deactivate"),this._scope[this._reference]=this,this.fire("activate",e),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return this._index==null?!1:(e.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)}}),s=e.extend({initialize:function(e){this.precision=e||5,this.multiplier=Math.pow(10,this.precision)},number:function(e){return Math.round(e*this.multiplier)/this.multiplier},point:function(e,t){return this.number(e.x)+(t||",")+this.number(e.y)},size:function(e,t){return this.number(e.width)+(t||",")+this.number(e.height)},rectangle:function(e,t){return this.point(e,t)+(t||",")+this.size(e,t)}});s.instance=new s(5);var o=new function(){var e=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],t=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],n=Math.abs,r=Math.sqrt,i=Math.pow,s=Math.cos,u=Math.PI;return{TOLERANCE:1e-5,EPSILON:1e-11,KAPPA:4*(r(2)-1)/3,isZero:function(e){return n(e)<=this.EPSILON},integrate:function(n,r,i,s){var o=e[s-2],u=t[s-2],a=.5*(i-r),f=a+r,l=0,c=s+1>>1,h=s&1?u[l++]*n(f):0;while(l<c){var p=a*o[l];h+=u[l++]*(n(f+p)+n(f-p))}return a*h},findRoot:function(e,t,r,i,s,o,u){for(var a=0;a<o;a++){var f=e(r),l=f/t(r);if(n(l)<u)return r;var c=r-l;f>0?(s=r,r=c<=i?.5*(i+s):c):(i=r,r=c>=s?.5*(i+s):c)}},solveQuadratic:function(e,t,i,s){var o=this.EPSILON;if(n(e)<o)return n(t)>=o?(s[0]=-i/t,1):n(i)<o?-1:0;var u=t*t-4*e*i;if(u<0)return 0;u=r(u),e*=2;var a=0;return s[a++]=(-t-u)/e,u>0&&(s[a++]=(-t+u)/e),a},solveCubic:function(e,t,a,f,l){var c=this.EPSILON;if(n(e)<c)return o.solveQuadratic(t,a,f,l);t/=e,a/=e,f/=e;var h=t*t,p=(h-3*a)/9,d=(2*h*t-9*t*a+27*f)/54,v=p*p*p,m=d*d-v;t/=3;if(n(m)<c){if(n(d)<c)return l[0]=-t,1;var g=r(p),y=d>0?1:-1;return l[0]=-y*2*g-t,l[1]=y*g-t,2}if(m<0){var g=r(p),b=Math.acos(d/(g*g*g))/3,w=-2*g,E=2*u/3;return l[0]=w*s(b)-t,l[1]=w*s(b+E)-t,l[2]=w*s(b-E)-t,3}var S=(d>0?-1:1)*i(n(d)+r(m),1/3);return l[0]=S+p/S-t,1}}},u=e.extend({_class:"Point",_readIndex:!0,initialize:function(t,n){var r=typeof t;if(r==="number"){var i=typeof n=="number";this.x=t,this.y=i?n:t,this.__read&&(this.__read=i?2:1)}else r==="undefined"||t===null?(this.x=this.y=0,this.__read&&(this.__read=t===null?1:0)):(Array.isArray(t)?(this.x=t[0],this.y=t.length>1?t[1]:t[0]):t.x!=null?(this.x=t.x,this.y=t.y):t.width!=null?(this.x=t.width,this.y=t.height):t.angle!=null?(this.x=t.length,this.y=0,this.setAngle(t.angle)):(this.x=this.y=0,this.__read&&(this.__read=0)),this.__read&&(this.__read=1))},set:function(e,t){return this.x=e,this.y=t,this},equals:function(e){return e===this||e&&(this.x===e.x&&this.y===e.y||Array.isArray(e)&&this.x===e[0]&&this.y===e[1])||!1},clone:function(){return new u(this.x,this.y)},toString:function(){var e=s.instance;return"{ x: "+e.number(this.x)+", y: "+e.number(this.y)+" }"},_serialize:function(e){var t=e.formatter;return[t.number(this.x),t.number(this.y)]},add:function(e){return e=u.read(arguments),new u(this.x+e.x,this.y+e.y)},subtract:function(e){return e=u.read(arguments),new u(this.x-e.x,this.y-e.y)},multiply:function(e){return e=u.read(arguments),new u(this.x*e.x,this.y*e.y)},divide:function(e){return e=u.read(arguments),new u(this.x/e.x,this.y/e.y)},modulo:function(e){return e=u.read(arguments),new u(this.x%e.x,this.y%e.y)},negate:function(){return new u(-this.x,-this.y)},transform:function(e){return e?e._transformPoint(this):this},getDistance:function(e,t){e=u.read(arguments);var n=e.x-this.x,r=e.y-this.y,i=n*n+r*r;return t?i:Math.sqrt(i)},getLength:function(){var e=this.x*this.x+this.y*this.y;return arguments.length&&arguments[0]?e:Math.sqrt(e)},setLength:function(e){if(this.isZero()){var t=this._angle||0;this.set(Math.cos(t)*e,Math.sin(t)*e)}else{var n=e/this.getLength();o.isZero(n)&&this.getAngle(),this.set(this.x*n,this.y*n)}return this},normalize:function(e){e===undefined&&(e=1);var t=this.getLength(),n=t!==0?e/t:0,r=new u(this.x*n,this.y*n);return r._angle=this._angle,r},getAngle:function(){return this.getAngleInRadians(arguments[0])*180/Math.PI},setAngle:function(e){e=this._angle=e*Math.PI/180;if(!this.isZero()){var t=this.getLength();this.set(Math.cos(e)*t,Math.sin(e)*t)}return this},getAngleInRadians:function(){if(arguments[0]===undefined)return this._angle==null&&(this._angle=Math.atan2(this.y,this.x)),this._angle;var e=u.read(arguments),t=this.getLength()*e.getLength();return o.isZero(t)?NaN:Math.acos(this.dot(e)/t)},getAngleInDegrees:function(){return this.getAngle(arguments[0])},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3},getDirectedAngle:function(e){return e=u.read(arguments),Math.atan2(this.cross(e),this.dot(e))*180/Math.PI},rotate:function(e,t){if(e===0)return this.clone();e=e*Math.PI/180;var n=t?this.subtract(t):this,r=Math.sin(e),i=Math.cos(e);return n=new u(n.x*i-n.y*r,n.y*i+n.x*r),t?n.add(t):n},isInside:function(e){return e.contains(this)},isClose:function(e,t){return this.getDistance(e)<t},isColinear:function(e){return this.cross(e)<1e-5},isOrthogonal:function(e){return this.dot(e)<1e-5},isZero:function(){return o.isZero(this.x)&&o.isZero(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},dot:function(e){return e=u.read(arguments),this.x*e.x+this.y*e.y},cross:function(e){return e=u.read(arguments),this.x*e.y-this.y*e.x},project:function(e){e=u.read(arguments);if(e.isZero())return new u(0,0);var t=this.dot(e)/e.dot(e);return new u(e.x*t,e.y*t)},statics:{min:function(){var e=u.read(arguments);return point2=u.read(arguments),new u(Math.min(e.x,point2.x),Math.min(e.y,point2.y))},max:function(){var e=u.read(arguments);return point2=u.read(arguments),new u(Math.max(e.x,point2.x),Math.max(e.y,point2.y))},random:function(){return new u(Math.random(),Math.random())}}},e.each(["round","ceil","floor","abs"],function(e){var t=Math[e];this[e]=function(){return new u(t(this.x),t(this.y))}},{})),a=u.extend({initialize:function(t,n,r,i){this._x=t,this._y=n,this._owner=r,this._setter=i},set:function(e,t,n){return this._x=e,this._y=t,n||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(e){this._x=e,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(e){this._y=e,this._owner[this._setter](this)}}),f=e.extend({_class:"Size",_readIndex:!0,initialize:function(t,n){var r=typeof t;if(r==="number"){var i=typeof n=="number";this.width=t,this.height=i?n:t,this.__read&&(this.__read=i?2:1)}else r==="undefined"||t===null?(this.width=this.height=0,this.__read&&(this.__read=t===null?1:0)):(Array.isArray(t)?(this.width=t[0],this.height=t.length>1?t[1]:t[0]):t.width!=null?(this.width=t.width,this.height=t.height):t.x!=null?(this.width=t.x,this.height=t.y):(this.width=this.height=0,this.__read&&(this.__read=0)),this.__read&&(this.__read=1))},set:function(e,t){return this.width=e,this.height=t,this},equals:function(e){return e===this||e&&(this.width===e.width&&this.height===e.height||Array.isArray(e)&&this.width===e[0]&&this.height===e[1])||!1},clone:function(){return new f(this.width,this.height)},toString:function(){var e=s.instance;return"{ width: "+e.number(this.width)+", height: "+e.number(this.height)+" }"},_serialize:function(e){var t=e.formatter;return[t.number(this.width),t.number(this.height)]},add:function(e){return e=f.read(arguments),new f(this.width+e.width,this.height+e.height)},subtract:function(e){return e=f.read(arguments),new f(this.width-e.width,this.height-e.height)},multiply:function(e){return e=f.read(arguments),new f(this.width*e.width,this.height*e.height)},divide:function(e){return e=f.read(arguments),new f(this.width/e.width,this.height/e.height)},modulo:function(e){return e=f.read(arguments),new f(this.width%e.width,this.height%e.height)},negate:function(){return new f(-this.width,-this.height)},isZero:function(){return o.isZero(this.width)&&o.isZero(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(e,t){return new f(Math.min(e.width,t.width),Math.min(e.height,t.height))},max:function(e,t){return new f(Math.max(e.width,t.width),Math.max(e.height,t.height))},random:function(){return new f(Math.random(),Math.random())}}},e.each(["round","ceil","floor","abs"],function(e){var t=Math[e];this[e]=function(){return new f(t(this.width),t(this.height))}},{})),c=f.extend({initialize:function(t,n,r,i){this._width=t,this._height=n,this._owner=r,this._setter=i},set:function(e,t,n){return this._width=e,this._height=t,n||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(e){this._width=e,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(e){this._height=e,this._owner[this._setter](this)}}),h=e.extend({_class:"Rectangle",_readIndex:!0,initialize:function(n,r,i,s){var o=typeof n,a=0;o==="number"?(this.x=n,this.y=r,this.width=i,this.height=s,a=4):o==="undefined"||n===null?(this.x=this.y=this.width=this.height=0,a=n===null?1:0):arguments.length===1&&(Array.isArray(n)?(this.x=n[0],this.y=n[1],this.width=n[2],this.height=n[3],a=1):n.x!==undefined||n.width!==undefined?(this.x=n.x||0,this.y=n.y||0,this.width=n.width||0,this.height=n.height||0,a=1):n.from===undefined&&n.to===undefined&&(this.x=this.y=this.width=this.height=0,this._set(n),a=1));if(!a){var l=u.readNamed(arguments,"from"),c=e.peek(arguments);this.x=l.x,this.y=l.y;if(c&&c.x!==undefined||e.hasNamed(arguments,"to")){var h=u.readNamed(arguments,"to");this.width=h.x-l.x,this.height=h.y-l.y,this.width<0&&(this.x=h.x,this.width=-this.width),this.height<0&&(this.y=h.y,this.height=-this.height)}else{var p=f.read(arguments);this.width=p.width,this.height=p.height}a=arguments._index}this.__read&&(this.__read=a)},set:function(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this},clone:function(){return new h(this.x,this.y,this.width,this.height)},equals:function(t){return e.isPlainValue(t)&&(t=h.read(arguments)),t===this||t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height||!1},toString:function(){var e=s.instance;return"{ x: "+e.number(this.x)+", y: "+e.number(this.y)+", width: "+e.number(this.width)+", height: "+e.number(this.height)+" }"},_serialize:function(e){var t=e.formatter;return[t.number(this.x),t.number(this.y),t.number(this.width),t.number(this.height)]},getPoint:function(){return new(arguments[0]?u:a)(this.x,this.y,this,"setPoint")},setPoint:function(e){e=u.read(arguments),this.x=e.x,this.y=e.y},getSize:function(){return new(arguments[0]?f:c)(this.width,this.height,this,"setSize")},setSize:function(e){e=f.read(arguments),this._fixX&&(this.x+=(this.width-e.width)*this._fixX),this._fixY&&(this.y+=(this.height-e.height)*this._fixY),this.width=e.width,this.height=e.height,this._fixW=1,this._fixH=1},getLeft:function(){return this.x},setLeft:function(e){this._fixW||(this.width-=e-this.x),this.x=e,this._fixX=0},getTop:function(){return this.y},setTop:function(e){this._fixH||(this.height-=e-this.y),this.y=e,this._fixY=0},getRight:function(){return this.x+this.width},setRight:function(e){this._fixX!==undefined&&this._fixX!==1&&(this._fixW=0),this._fixW?this.x=e-this.width:this.width=e-this.x,this._fixX=1},getBottom:function(){return this.y+this.height},setBottom:function(e){this._fixY!==undefined&&this._fixY!==1&&(this._fixH=0),this._fixH?this.y=e-this.height:this.height=e-this.y,this._fixY=1},getCenterX:function(){return this.x+this.width*.5},setCenterX:function(e){this.x=e-this.width*.5,this._fixX=.5},getCenterY:function(){return this.y+this.height*.5},setCenterY:function(e){this.y=e-this.height*.5,this._fixY=.5},getCenter:function(){return new(arguments[0]?u:a)(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(e){return e=u.read(arguments),this.setCenterX(e.x),this.setCenterY(e.y),this},isEmpty:function(){return this.width==0||this.height==0},contains:function(e){return e&&e.width!==undefined||(Array.isArray(e)?e:arguments).length==4?this._containsRectangle(h.read(arguments)):this._containsPoint(u.read(arguments))},_containsPoint:function(e){var t=e.x,n=e.y;return t>=this.x&&n>=this.y&&t<=this.x+this.width&&n<=this.y+this.height},_containsRectangle:function(e){var t=e.x,n=e.y;return t>=this.x&&n>=this.y&&t+e.width<=this.x+this.width&&n+e.height<=this.y+this.height},intersects:function(e){return e=h.read(arguments),e.x+e.width>this.x&&e.y+e.height>this.y&&e.x<this.x+this.width&&e.y<this.y+this.height},touches:function(e){return e=h.read(arguments),e.x+e.width>=this.x&&e.y+e.height>=this.y&&e.x<=this.x+this.width&&e.y<=this.y+this.height},intersect:function(e){e=h.read(arguments);var t=Math.max(this.x,e.x),n=Math.max(this.y,e.y),r=Math.min(this.x+this.width,e.x+e.width),i=Math.min(this.y+this.height,e.y+e.height);return new h(t,n,r-t,i-n)},unite:function(e){e=h.read(arguments);var t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),r=Math.max(this.x+this.width,e.x+e.width),i=Math.max(this.y+this.height,e.y+e.height);return new h(t,n,r-t,i-n)},include:function(e){e=u.read(arguments);var t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),r=Math.max(this.x+this.width,e.x),i=Math.max(this.y+this.height,e.y);return new h(t,n,r-t,i-n)},expand:function(e,t){return t===undefined&&(t=e),new h(this.x-e/2,this.y-t/2,this.width+e,this.height+t)},scale:function(e,t){return this.expand(this.width*e-this.width,this.height*(t===undefined?e:t)-this.height)}},new function(){return e.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],function(e,t){var n=e.join(""),r=/^[RL]/.test(n);t>=4&&(e[1]+=r?"Y":"X");var i=e[r?0:1],s=e[r?1:0],o="get"+i,f="get"+s,l="set"+i,c="set"+s,h="get"+n,p="set"+n;this[h]=function(){return new(arguments[0]?u:a)(this[o](),this[f](),this,p)},this[p]=function(e){e=u.read(arguments),this[l](e.x),this[c](e.y)}},{})}),p=h.extend({initialize:function(t,n,r,i,s,o){this.set(t,n,r,i,!0),this._owner=s,this._setter=o},set:function(e,t,n,r,i){return this._x=e,this._y=t,this._width=n,this._height=r,i||this._owner[this._setter](this),this}},new function(){var t=h.prototype;return e.each(["x","y","width","height"],function(t){var n=e.capitalize(t),r="_"+t;this["get"+n]=function(){return this[r]},this["set"+n]=function(e){this[r]=e,this._dontNotify||this._owner[this._setter](this)}},e.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],function(e){var n="set"+e;this[n]=function(){this._dontNotify=!0,t[n].apply(this,arguments),delete this._dontNotify,this._owner[this._setter](this)}},{isSelected:function(){return this._owner._boundsSelected},setSelected:function(e){var t=this._owner;t.setSelected&&(t._boundsSelected=e,t.setSelected(e||t._selectedSegmentState>0))}}))}),d=e.extend({_class:"Matrix",initialize:function it(e){var t=arguments.length,n=!0;t==6?this.set.apply(this,arguments):t==1?e instanceof it?this.set(e._a,e._c,e._b,e._d,e._tx,e._ty):Array.isArray(e)?this.set.apply(this,e):n=!1:t==0?this.reset():n=!1;if(!n)throw new Error("Unsupported matrix parameters")},set:function(e,t,n,r,i,s){return this._a=e,this._c=t,this._b=n,this._d=r,this._tx=i,this._ty=s,this},_serialize:function(t){return e.serialize(this.getValues(),t)},clone:function(){return new d(this._a,this._c,this._b,this._d,this._tx,this._ty)},equals:function(e){return e===this||e&&this._a==e._a&&this._b==e._b&&this._c==e._c&&this._d==e._d&&this._tx==e._tx&&this._ty==e._ty||!1},toString:function(){var e=s.instance;return"[["+[e.number(this._a),e.number(this._b),e.number(this._tx)].join(", ")+"], ["+[e.number(this._c),e.number(this._d),e.number(this._ty)].join(", ")+"]]"},reset:function(){return this._a=this._d=1,this._c=this._b=this._tx=this._ty=0,this},scale:function(){var e=u.read(arguments),t=u.read(arguments,0,0,{readNull:!0});return t&&this.translate(t),this._a*=e.x,this._c*=e.x,this._b*=e.y,this._d*=e.y,t&&this.translate(t.negate()),this},translate:function(e){e=u.read(arguments);var t=e.x,n=e.y;return this._tx+=t*this._a+n*this._b,this._ty+=t*this._c+n*this._d,this},rotate:function(e,t){t=u.read(arguments,1),e=e*Math.PI/180;var n=t.x,r=t.y,i=Math.cos(e),s=Math.sin(e),o=n-n*i+r*s,a=r-n*s-r*i,f=this._a,l=this._b,c=this._c,h=this._d;return this._a=i*f+s*l,this._b=-s*f+i*l,this._c=i*c+s*h,this._d=-s*c+i*h,this._tx+=o*f+a*l,this._ty+=o*c+a*h,this},shear:function(){var e=u.read(arguments),t=u.read(arguments,0,0,{readNull:!0});t&&this.translate(t);var n=this._a,r=this._c;return this._a+=e.y*this._b,this._c+=e.y*this._d,this._b+=e.x*n,this._d+=e.x*r,t&&this.translate(t.negate()),this},isIdentity:function(){return this._a==1&&this._c==0&&this._b==0&&this._d==1&&this._tx==0&&this._ty==0},isInvertible:function(){return!!this._getDeterminant()},isSingular:function(){return!this._getDeterminant()},concatenate:function(e){var t=this._a,n=this._b,r=this._c,i=this._d;return this._a=e._a*t+e._c*n,this._b=e._b*t+e._d*n,this._c=e._a*r+e._c*i,this._d=e._b*r+e._d*i,this._tx+=e._tx*t+e._ty*n,this._ty+=e._tx*r+e._ty*i,this},preConcatenate:function(e){var t=this._a,n=this._b,r=this._c,i=this._d,s=this._tx,o=this._ty;return this._a=e._a*t+e._b*r,this._b=e._a*n+e._b*i,this._c=e._c*t+e._d*r,this._d=e._c*n+e._d*i,this._tx=e._a*s+e._b*o+e._tx,this._ty=e._c*s+e._d*o+e._ty,this},transform:function(e,t,n,r,i){return arguments.length<5?this._transformPoint(u.read(arguments)):this._transformCoordinates(e,t,n,r,i)},_transformPoint:function(e,t,n){var r=e.x,i=e.y;return t||(t=new u),t.set(r*this._a+i*this._b+this._tx,r*this._c+i*this._d+this._ty,n)},_transformCoordinates:function(e,t,n,r,i){var s=t,o=r,u=t+2*i;while(s<u){var a=e[s++],f=e[s++];n[o++]=a*this._a+f*this._b+this._tx,n[o++]=a*this._c+f*this._d+this._ty}return n},_transformCorners:function(e){var t=e.x,n=e.y,r=t+e.width,i=n+e.height,s=[t,n,r,n,r,i,t,i];return this._transformCoordinates(s,0,s,0,4)},_transformBounds:function(e,t,n){var r=this._transformCorners(e),i=r.slice(0,2),s=r.slice();for(var o=2;o<8;o++){var u=r[o],a=o&1;u<i[a]?i[a]=u:u>s[a]&&(s[a]=u)}return t||(t=new h),t.set(i[0],i[1],s[0]-i[0],s[1]-i[1],n)},inverseTransform:function(){return this._inverseTransform(u.read(arguments))},_getDeterminant:function(){var e=this._a*this._d-this._b*this._c;return isFinite(e)&&!o.isZero(e)&&isFinite(this._tx)&&isFinite(this._ty)?e:null},_inverseTransform:function(e,t,n){var r=this._getDeterminant();if(!r)return null;var i=e.x-this._tx,s=e.y-this._ty;return t||(t=new u),t.set((i*this._d-s*this._b)/r,(s*this._a-i*this._c)/r,n)},decompose:function(){var e=this._a,t=this._b,n=this._c,r=this._d;if(o.isZero(e*r-t*n))return null;var i=Math.sqrt(e*e+t*t);e/=i,t/=i;var s=e*n+t*r;n-=e*s,r-=t*s;var a=Math.sqrt(n*n+r*r);return n/=a,r/=a,s/=a,e*r<t*n&&(e=-e,t=-t,s=-s,i=-i),{translation:this.getTranslation(),scaling:new u(i,a),rotation:-Math.atan2(t,e)*180/Math.PI,shearing:s}},getValues:function(){return[this._a,this._c,this._b,this._d,this._tx,this._ty]},getTranslation:function(){return new u(this._tx,this._ty)},getScaling:function(){return(this.decompose()||{}).scaling},getRotation:function(){return(this.decompose()||{}).rotation},inverted:function(){var e=this._getDeterminant();return e&&new d(this._d/e,-this._c/e,-this._b/e,this._a/e,(this._b*this._ty-this._d*this._tx)/e,(this._c*this._tx-this._a*this._ty)/e)},shiftless:function(){return new d(this._a,this._c,this._b,this._d,0,0)},applyToContext:function(e){e.transform(this._a,this._c,this._b,this._d,this._tx,this._ty)}},new function(){return e.each({scaleX:"_a",scaleY:"_d",translateX:"_tx",translateY:"_ty",shearX:"_b",shearY:"_c"},function(t,n){n=e.capitalize(n),this["get"+n]=function(){return this[t]},this["set"+n]=function(e){this[t]=e}},{})}),v=e.extend({_class:"Line",initialize:function(t,n,r,i,s){var o=!1;arguments.length>=4?(this._px=t,this._py=n,this._vx=r,this._vy=i,o=s):(this._px=t.x,this._py=t.y,this._vx=n.x,this._vy=n.y,o=r),o||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new u(this._px,this._py)},getVector:function(){return new u(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(e,t){return v.intersect(this._px,this._py,this._vx,this._vy,e._px,e._py,e._vx,e._vy,!0,t)},getSide:function(e){return v.getSide(this._px,this._py,this._vx,this._vy,e.x,e.y,!0)},getDistance:function(e){return Math.abs(v.getSignedDistance(this._px,this._py,this._vx,this._vy,e.x,e.y,!0))},statics:{intersect:function(e,t,n,r,i,s,a,f,l,c){l||(n-=e,r-=t,a-=i,f-=s);var h=f*n-a*r;if(!o.isZero(h)){var p=e-i,d=t-s,v=(a*d-f*p)/h,m=(n*d-r*p)/h;if((c||0<=v&&v<=1)&&(c||0<=m&&m<=1))return new u(e+v*n,t+v*r)}},getSide:function(e,t,n,r,i,s,o){o||(n-=e,r-=t);var u=i-e,a=s-t,f=u*r-a*n;return f===0&&(f=u*n+a*r,f>0&&(u-=n,a-=r,f=u*n+a*r,f<0&&(f=0))),f<0?-1:f>0?1:0},getSignedDistance:function(e,t,n,r,i,s,o){o||(n-=e,r-=t);var u=r/n,a=t-u*e;return(s-u*i-a)/Math.sqrt(u*u+1)}}}),m=r.extend({_class:"Project",_list:"projects",_reference:"project",initialize:function(t){r.call(this,!0),this.layers=[],this.symbols=[],this._currentStyle=new I,this.activeLayer=new w,t&&(this.view=t instanceof U?t:U.create(t)),this._selectedItems={},this._selectedItemCount=0,this._drawCount=0,this.options={}},_serialize:function(t,n){return e.serialize(this.layers,t,!0,n)},clear:function(){for(var e=this.layers.length-1;e>=0;e--)this.layers[e].remove();this.symbols=[]},remove:function st(){return st.base.call(this)?(this.view&&this.view.remove(),!0):!1},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(e){this._currentStyle.initialize(e)},getIndex:function(){return this._index},getSelectedItems:function(){var e=[];for(var t in this._selectedItems){var n=this._selectedItems[t];n._drawCount===this._drawCount&&e.push(n)}return e},_updateSelection:function(e){e._selected?(this._selectedItemCount++,this._selectedItems[e._id]=e,e.isInserted()&&(e._drawCount=this._drawCount)):(this._selectedItemCount--,delete this._selectedItems[e._id])},selectAll:function(){for(var e=0,t=this.layers.length;e<t;e++)this.layers[e].setSelected(!0)},deselectAll:function(){for(var e in this._selectedItems)this._selectedItems[e].setSelected(!1)},hitTest:function(t,n){t=u.read(arguments),n=T.getOptions(e.read(arguments));for(var r=this.layers.length-1;r>=0;r--){var i=this.layers[r].hitTest(t,n);if(i)return i}return null},importJSON:function(t){return this.activate(),e.importJSON(t)},draw:function(t,n){this._drawCount++,t.save(),n.applyToContext(t);var r=e.merge({offset:new u(0,0),transforms:[n]});for(var i=0,s=this.layers.length;i<s;i++)this.layers[i].draw(t,r);t.restore();if(this._selectedItemCount>0){t.save(),t.strokeWidth=1;for(var o in this._selectedItems){var a=this._selectedItems[o];if(a._drawCount===this._drawCount&&(a._drawSelected||a._boundsSelected)){var f=a.getSelectedColor()||a.getLayer().getSelectedColor();t.strokeStyle=t.fillStyle=f?f.toCanvasStyle(t):"#009dec";var l=a._globalMatrix;a._drawSelected&&a._drawSelected(t,l);if(a._boundsSelected){var c=l._transformCorners(a._getBounds("getBounds"));t.beginPath();for(var i=0;i<8;i++)t[i===0?"moveTo":"lineTo"](c[i],c[++i]);t.closePath(),t.stroke();for(var i=0;i<8;i++)t.beginPath(),t.rect(c[i]-2,c[++i]-2,4,4),t.fill()}}}t.restore()}}}),g=e.extend({_class:"Symbol",initialize:function ot(e,t){this._id=ot._id=(ot._id||0)+1,this.project=paper.project,this.project.symbols.push(this),e&&this.setDefinition(e,t),this._instances={}},_serialize:function(t,n){return n.add(this,function(){return e.serialize([this._class,this._definition],t,!1,n)})},_changed:function(t){e.each(this._instances,function(e){e._changed(t)})},getDefinition:function(){return this._definition},setDefinition:function(e){e._parentSymbol&&(e=e.clone()),this._definition&&delete this._definition._parentSymbol,this._definition=e,e.remove(),e.setSelected(!1),arguments[1]||e.setPosition(new u),e._parentSymbol=this,this._changed(5)},place:function(e){return new x(this,e)},clone:function(){return new g(this._definition.clone(!1))}}),y=e.extend(t,{statics:{extend:function ut(t){t._serializeFields&&(t._serializeFields=e.merge(this.prototype._serializeFields,t._serializeFields));var n=ut.base.apply(this,arguments),r=n.prototype,i=r._class;return i&&(r._type=e.hyphenate(i)),n}},_class:"Item",_transformContent:!0,_boundsSelected:!1,_serializeFields:{name:null,matrix:new d,locked:!1,visible:!0,blendMode:"normal",opacity:1,guide:!1,clipMask:!1,data:{}},initialize:function(){},_initialize:function(e,t){this._id=y._id=(y._id||0)+1;if(!this._project){var n=paper.project,r=n.activeLayer;r&&(!e||e.insert!==!1)?r.addChild(this):this._setProject(n)}return this._style=new I(this._project._currentStyle,this),this._matrix=new d,t&&this._matrix.translate(t),e?this._set(e,{insert:!0}):!0},_events:new function(){var t={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}},n={install:function(e){var n=this._project.view._eventCounters;if(n)for(var r in t)n[r]=(n[r]||0)+(t[r][e]||0)},uninstall:function(e){var n=this._project.view._eventCounters;if(n)for(var r in t)n[r]-=t[r][e]||0}};return e.each(["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"],function(e){this[e]=n},{onFrame:{install:function(){this._project.view._animateItem(this,!0)},uninstall:function(){this._project.view._animateItem(this,!1)}},onLoad:{}})},_serialize:function(t,n){function s(s){for(var o in s){var u=i[o];e.equals(u,s[o])||(r[o]=e.serialize(u,t,o!=="data",n))}}var r={},i=this;return s(this._serializeFields),this instanceof b||s(this._style._defaults),[this._class,r]},_changed:function(e){var t=this._parent,n=this._project,r=this._parentSymbol;e&4&&(delete this._bounds,delete this._position),t&&e&12&&t._clearBoundsCache(),e&2&&this._clearBoundsCache();if(n){e&1&&(n._needsRedraw=!0);if(n._changes){var i=n._changesById[this._id];i?i.flags|=e:(i={item:this,flags:e},n._changesById[this._id]=i,n._changes.push(i))}}r&&r._changed(e)},set:function(e){return e&&this._set(e),this},getId:function(){return this._id},getType:function(){return this._type},getName:function(){return this._name},setName:function(e,t){this._name&&this._removeFromNamed();if(e&&this._parent){var n=this._parent._children,r=this._parent._namedChildren,i=e,s=1;while(t&&n[e])e=i+" "+s++;(r[e]=r[e]||[]).push(this),n[e]=this}this._name=e||undefined,this._changed(32)},getStyle:function(){return this._style},setStyle:function(e){this.getStyle().set(e)},hasFill:function(){return!!this.getStyle().getFillColor()},hasStroke:function(){var e=this.getStyle();return!!e.getStrokeColor()&&e.getStrokeWidth()>0}},e.each(["locked","visible","blendMode","opacity","guide"],function(t){var n=e.capitalize(t),t="_"+t;this["get"+n]=function(){return this[t]},this["set"+n]=function(e){e!=this[t]&&(this[t]=e,this._changed(t==="_locked"?32:33))}},{}),{_locked:!1,_visible:!0,_blendMode:"normal",_opacity:1,_guide:!1,isSelected:function(){if(this._children)for(var e=0,t=this._children.length;e<t;e++)if(this._children[e].isSelected())return!0;return this._selected},setSelected:function(e){if(this._children&&!arguments[1])for(var t=0,n=this._children.length;t<n;t++)this._children[t].setSelected(e);(e=!!e)!=this._selected&&(this._selected=e,this._project._updateSelection(this),this._changed(33))},_selected:!1,isFullySelected:function(){if(this._children&&this._selected){for(var e=0,t=this._children.length;e<t;e++)if(!this._children[e].isFullySelected())return!1;return!0}return this._selected},setFullySelected:function(e){if(this._children)for(var t=0,n=this._children.length;t<n;t++)this._children[t].setFullySelected(e);this.setSelected(e,!0)},isClipMask:function(){return this._clipMask},setClipMask:function(e){this._clipMask!=(e=!!e)&&(this._clipMask=e,e&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(33),this._parent&&this._parent._changed(256))},_clipMask:!1,getData:function(){return this._data||(this._data={}),this._data},setData:function(e){this._data=e},getPosition:function(){var e=this._position||(this._position=this.getBounds().getCenter(!0));return new(arguments[0]?u:a)(e.x,e.y,this,"setPosition")},setPosition:function(){this.translate(u.read(arguments).subtract(this.getPosition(!0)))},getMatrix:function(){return this._matrix},setMatrix:function(e){this._matrix.initialize(e),this._changed(5)},isEmpty:function(){return this._children.length==0}},e.each(["getBounds","getStrokeBounds","getHandleBounds","getRoughBounds"],function(e){this[e]=function(){var t=this._boundsGetter,n=this._getCachedBounds(typeof t=="string"?t:t&&t[e]||e,arguments[0]);return e==="getBounds"?new p(n.x,n.y,n.width,n.height,this,"setBounds"):n}},{_getCachedBounds:function(e,t,n){var r=(!t||t.equals(this._matrix))&&e;if(n&&this._parent){var i=n._id,s=this._parent._boundsCache=this._parent._boundsCache||{ids:{},list:[]};s.ids[i]||(s.list.push(n),s.ids[i]=n)}if(r&&this._bounds&&this._bounds[r])return this._bounds[r].clone();var o=this._matrix.isIdentity();t=!t||t.isIdentity()?o?null:this._matrix:o?t:t.clone().concatenate(this._matrix);var u=this._getBounds(e,t,r?this:n);return r&&(this._bounds||(this._bounds={}),this._bounds[r]=u.clone()),u},_clearBoundsCache:function(){if(this._boundsCache){for(var e=0,t=this._boundsCache.list,n=t.length;e<n;e++){var r=t[e];delete r._bounds,r!=this&&r._boundsCache&&r._clearBoundsCache()}delete this._boundsCache}},_getBounds:function(e,t,n){var r=this._children;if(!r||r.length==0)return new h;var i=Infinity,s=-i,o=i,u=s;for(var a=0,f=r.length;a<f;a++){var l=r[a];if(l._visible&&!l.isEmpty()){var c=l._getCachedBounds(e,t,n);i=Math.min(c.x,i),o=Math.min(c.y,o),s=Math.max(c.x+c.width,s),u=Math.max(c.y+c.height,u)}}return isFinite(i)?new h(i,o,s-i,u-o):new h},setBounds:function(e){e=h.read(arguments);var t=this.getBounds(),n=new d,r=e.getCenter();n.translate(r),(e.width!=t.width||e.height!=t.height)&&n.scale(t.width!=0?e.width/t.width:1,t.height!=0?e.height/t.height:1),r=t.getCenter(),n.translate(-r.x,-r.y),this.transform(n)}}),{getProject:function(){return this._project},_setProject:function(e){if(this._project!=e){this._project=e;if(this._children)for(var t=0,n=this._children.length;t<n;t++)this._children[t]._setProject(e)}},getLayer:function(){var e=this;while(e=e._parent)if(e instanceof w)return e;return null},getParent:function(){return this._parent},setParent:function(e){return e.addChild(this)},getChildren:function(){return this._children},setChildren:function(e){this.removeChildren(),this.addChildren(e)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){return this._parent&&this._parent._children[this._index+1]||null},getPreviousSibling:function(){return this._parent&&this._parent._children[this._index-1]||null},getIndex:function(){return this._index},isInserted:function(){return this._parent?this._parent.isInserted():!1},clone:function(e){return this._clone(new this.constructor({insert:!1}),e)},_clone:function(e,t){e.setStyle(this._style);if(this._children)for(var n=0,r=this._children.length;n<r;n++)e.addChild(this._children[n].clone(!1),!0);(t||t===undefined)&&e.insertAbove(this);var i=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"];for(var n=0,r=i.length;n<r;n++){var s=i[n];this.hasOwnProperty(s)&&(e[s]=this[s])}return e._matrix.initialize(this._matrix),e.setSelected(this._selected),this._name&&e.setName(this._name,!0),e},copyTo:function(e){var t=this.clone();return e.layers?e.activeLayer.addChild(t):e.addChild(t),t},rasterize:function(t){var n=this.getStrokeBounds(),r=(t||72)/72,i=n.getTopLeft().floor(),s=n.getBottomRight().ceil();size=new f(s.subtract(i)),canvas=G.getCanvas(size),ctx=canvas.getContext("2d"),matrix=(new d).scale(r).translate(i.negate()),ctx.save(),matrix.applyToContext(ctx),this.draw(ctx,e.merge({transforms:[matrix]}));var o=new S(canvas);return o.setPosition(i.add(size.divide(2))),ctx.restore(),o},contains:function(){return!!this._contains(this._matrix._inverseTransform(u.read(arguments)))},_contains:function(e){if(this._children){for(var t=this._children.length-1;t>=0;t--)if(this._children[t].contains(e))return!0;return!1}return e.isInside(this._getBounds("getBounds"))},hitTest:function(t,n){function s(i,s){var u=o["get"+s]();if(t.getDistance(u)<n.tolerance)return new T(i,r,{name:e.hyphenate(s),point:u})}t=u.read(arguments),n=T.getOptions(e.read(arguments));if(this._locked||!this._visible||this._guide&&!n.guides)return null;if(!this._children&&!this.getRoughBounds().expand(n.tolerance)._containsPoint(t))return null;t=this._matrix._inverseTransform(t);var r=this,i;if((n.center||n.bounds)&&!(this instanceof w&&!this._parent)){var o=this._getBounds("getBounds");n.center&&(i=s("center","Center"));if(!i&&n.bounds){var a=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"];for(var f=0;f<8&&!i;f++)i=s("bounds",a[f])}}return(i||(i=this._children||!(n.guides&&!this._guide||n.selected&&!this._selected)?this._hitTest(t,n):null))&&i.point&&(i.point=r._matrix.transform(i.point)),i},_hitTest:function(e,t){if(this._children){for(var n=this._children.length-1,r;n>=0;n--)if(r=this._children[n].hitTest(e,t))return r}else if(t.fill&&this.hasFill()&&this._contains(e))return new T("fill",this)},importJSON:function(t){return this.addChild(e.importJSON(t))},addChild:function(e,t){return this.insertChild(undefined,e,t)},insertChild:function(e,t,n){var r=this.insertChildren(e,[t],n);return r&&r[0]},addChildren:function(e,t){return this.insertChildren(this._children.length,e,t)},insertChildren:function(t,n,r,i){var s=this._children;if(s&&n&&n.length>0){n=Array.prototype.slice.apply(n);for(var o=n.length-1;o>=0;o--){var u=n[o];i&&u._type!==i?n.splice(o,1):u._remove(!0)}e.splice(s,n,t,0);for(var o=0,a=n.length;o<a;o++){var u=n[o];u._parent=this,u._setProject(this._project),u._name&&u.setName(u._name)}this._changed(7)}else n=null;return n},_insert:function(e,t,n){if(!t._parent)return null;var r=t._index+(e?1:0);return t._parent===this._parent&&r>this._index&&r--,t._parent.insertChild(r,this,n)},insertAbove:function(e,t){return this._insert(!0,e,t)},insertBelow:function(e,t){return this._insert(!1,e,t)},sendToBack:function(){return this._parent.insertChild(0,this)},bringToFront:function(){return this._parent.addChild(this)},appendTop:"#addChild",appendBottom:function(e){return this.insertChild(0,e)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",_removeFromNamed:function(){var e=this._parent._children,t=this._parent._namedChildren,n=this._name,r=t[n],i=r?r.indexOf(this):-1;if(i==-1)return;e[n]==this&&delete e[n],r.splice(i,1),r.length?e[n]=r[r.length-1]:delete t[n]},_remove:function(t){return this._parent?(this._name&&this._removeFromNamed(),this._index!=null&&e.splice(this._parent._children,null,this._index,1),t&&this._parent._changed(7),this._parent=null,!0):!1},remove:function(){return this._remove(!0)},removeChildren:function(t,n){if(!this._children)return null;t=t||0,n=e.pick(n,this._children.length);var r=e.splice(this._children,null,t,n-t);for(var i=r.length-1;i>=0;i--)r[i]._remove(!1);return r.length>0&&this._changed(7),r},reverseChildren:function(){if(this._children){this._children.reverse();for(var e=0,t=this._children.length;e<t;e++)this._children[e]._index=e;this._changed(7)}},isEditable:function(){var e=this;while(e){if(!e._visible||e._locked)return!1;e=e._parent}return!0},_getOrder:function(e){function t(e){var t=[];do t.unshift(e);while(e=e._parent);return t}var n=t(this),r=t(e);for(var i=0,s=Math.min(n.length,r.length);i<s;i++)if(n[i]!=r[i])return n[i]._index<r[i]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isAbove:function(e){return this._getOrder(e)===-1},isBelow:function(e){return this._getOrder(e)===1},isParent:function(e){return this._parent===e},isChild:function(e){return e&&e._parent===this},isDescendant:function(e){var t=this;while(t=t._parent)if(t==e)return!0;return!1},isAncestor:function(e){return e?e.isDescendant(this):!1},isGroupedWith:function(e){var t=this._parent;while(t){if(t._parent&&/^(group|layer|compound-path)$/.test(t._type)&&e.isDescendant(t))return!0;t=t._parent}return!1},scale:function(e,t,n){if(arguments.length<2||typeof t=="object")n=t,t=e;return this.transform((new d).scale(e,t,n||this.getPosition(!0)))},translate:function(){var e=new d;return this.transform(e.translate.apply(e,arguments))},rotate:function(e,t){return this.transform((new d).rotate(e,t||this.getPosition(!0)))},shear:function(e,t,n){if(arguments.length<2||typeof t=="object")n=t,t=e;return this.transform((new d).shear(e,t,n||this.getPosition(!0)))},transform:function(e){var t=this._bounds,n=this._position;this._matrix.preConcatenate(e),(this._transformContent||arguments[1])&&this.applyMatrix(!0),this._changed(5);if(t&&e.getRotation()%90===0){for(var r in t){var i=t[r];e._transformBounds(i,i)}var s=this._boundsGetter,i=t[s&&s.getBounds||s||"getBounds"];i&&(this._position=i.getCenter(!0)),this._bounds=t}else n&&(this._position=e._transformPoint(n,n));return this},_applyMatrix:function(e,t){var n=this._children;if(n&&n.length>0){for(var r=0,i=n.length;r<i;r++)n[r].transform(e,t);return!0}},applyMatrix:function(e){var t=this._matrix;if(this._applyMatrix(t,!0)){var n=this._style,r=n.getFillColor(!0),i=n.getStrokeColor(!0);r&&r.transform(t),i&&i.transform(t),t.reset()}e||this._changed(5)},fitBounds:function(e,t){e=h.read(arguments);var n=this.getBounds(),r=n.height/n.width,i=e.height/e.width,s=(t?r>i:r<i)?e.width/n.width:e.height/n.height,o=new h(new u,new f(n.width*s,n.height*s));o.setCenter(e.getCenter()),this.setBounds(o)},_setStyles:function(e){var t=this._style,n=t.getStrokeWidth(),r=t.getStrokeJoin(),i=t.getStrokeCap(),s=t.getMiterLimit(),o=t.getFillColor(),u=t.getStrokeColor(),a=t.getShadowColor();n!=null&&(e.lineWidth=n),r&&(e.lineJoin=r),i&&(e.lineCap=i),s&&(e.miterLimit=s),o&&(e.fillStyle=o.toCanvasStyle(e));if(u){e.strokeStyle=u.toCanvasStyle(e);var f=t.getDashArray(),l=t.getDashOffset();paper.support.nativeDash&&f&&f.length&&("setLineDash"in e?(e.setLineDash(f),e.lineDashOffset=l):(e.mozDash=f,e.mozDashOffset=l))}if(a){e.shadowColor=a.toCanvasStyle(e),e.shadowBlur=t.getShadowBlur();var c=this.getShadowOffset();e.shadowOffsetX=c.x,e.shadowOffsetY=c.y}},draw:function(e,t){if(!this._visible||this._opacity===0)return;this._drawCount=this._project._drawCount;var n=t.transforms,r=n[n.length-1],i=r.clone().concatenate(this._matrix);n.push(this._globalMatrix=i);var s=this._blendMode,o=this._opacity,u=s==="normal",a=Y.nativeModes[s],l=u&&o===1||(a||u&&o<1)&&this._canComposite(),c,h,p;if(!l){var d=this.getStrokeBounds(r);if(!d.width||!d.height)return;p=t.offset,h=t.offset=d.getTopLeft().floor(),c=e,e=G.getContext(d.getSize().ceil().add(new f(1,1)))}e.save(),l?(e.globalAlpha=o,a&&(e.globalCompositeOperation=s)):e.translate(-h.x,-h.y),(l?this._matrix:i).applyToContext(e),!l&&t.clipItem&&t.clipItem.draw(e,t.extend({clip:!0})),this._draw(e,t),e.restore(),n.pop(),t.clip&&e.clip(),l||(Y.process(s,e,c,o,h.subtract(p)),G.release(e),t.offset=p)},_canComposite:function(){return!1}},e.each(["down","drag","up","move"],function(t){this["removeOn"+e.capitalize(t)]=function(){var e={};return e[t]=!0,this.removeOn(e)}},{removeOn:function(e){for(var t in e)if(e[t]){var n="mouse"+t,r=this._project,i=r._removeSets=r._removeSets||{};i[n]=i[n]||{},i[n][this._id]=this}return this}})),b=y.extend({_class:"Group",_serializeFields:{children:[]},initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||this.addChildren(Array.isArray(t)?t:arguments)},_changed:function at(e){at.base.call(this,e),e&2&&this._transformContent&&!this._matrix.isIdentity()&&this.applyMatrix(),e&258&&delete this._clipItem},_getClipItem:function(){if(this._clipItem!==undefined)return this._clipItem;for(var e=0,t=this._children.length;e<t;e++){var n=this._children[e];if(n._clipMask)return this._clipItem=n}return this._clipItem=null},getTransformContent:function(){return this._transformContent},setTransformContent:function(e){this._transformContent=e,e&&this.applyMatrix()},isClipped:function(){return!!this._getClipItem()},setClipped:function(e){var t=this.getFirstChild();t&&t.setClipMask(e)},_draw:function(e,t){var n=t.clipItem=this._getClipItem();n&&n.draw(e,t.extend({clip:!0}));for(var r=0,i=this._children.length;r<i;r++){var s=this._children[r];s!==n&&s.draw(e,t)}t.clipItem=null}}),w=b.extend({_class:"Layer",initialize:function(){this._project=paper.project,this._index=this._project.layers.push(this)-1,b.apply(this,arguments),this.activate()},_remove:function ft(t){return this._parent?ft.base.call(this,t):this._index!=null?(this._project.activeLayer===this&&(this._project.activeLayer=this.getNextSibling()||this.getPreviousSibling()),e.splice(this._project.layers,null,this._index,1),this._project._needsRedraw=!0,!0):!1},getNextSibling:function lt(){return this._parent?lt.base.call(this):this._project.layers[this._index+1]||null},getPreviousSibling:function ct(){return this._parent?ct.base.call(this):this._project.layers[this._index-1]||null},isInserted:function ht(){return this._parent?ht.base.call(this):this._index!=null},activate:function(){this._project.activeLayer=this},_insert:function pt(t,n,r){return n instanceof w&&!n._parent&&this._remove(!0)?(e.splice(n._project.layers,[this],n._index+(t?1:0),0),this._setProject(n._project),this):pt.base.call(this,t,n,r)}}),E=y.extend({_class:"Shape",_transformContent:!1,initialize:function(t,n,r,i){this._initialize(i,n),this._type=t,this._size=r},getSize:function(){var e=this._size;return new c(e.width,e.height,this,"setSize")},setSize:function(){var e=f.read(arguments);this._size.equals(e)||(this._size.set(e.width,e.height),this._changed(5))},getRadius:function(){var e=this._size;return(e.width+e.height)/4},setRadius:function(e){var t=e*2;this.setSize(t,t)},_draw:function(e,t){var n=this._style,r=this._size,i=r.width,s=r.height,u=n.getFillColor(),a=n.getStrokeColor();if(u||a||t.clip){e.beginPath();switch(this._type){case"rect":e.rect(-i/2,-s/2,i,s);break;case"circle":e.arc(0,0,(i+s)/4,0,Math.PI*2,!0);break;case"ellipse":var f=i/2,l=s/2,c=o.KAPPA,h=f*c,p=l*c;e.moveTo(-f,0),e.bezierCurveTo(-f,-p,-h,-l,0,-l),e.bezierCurveTo(h,-l,f,-p,f,0),e.bezierCurveTo(f,p,h,l,0,l),e.bezierCurveTo(-h,l,-f,p,-f,0)}}!t.clip&&(u||a)&&(this._setStyles(e),u&&e.fill(),a&&e.stroke())},_canComposite:function(){return!this.hasFill()||!this.hasStroke()},_getBounds:function(e,t){var n=(new h(this._size)).setCenter(0,0);return e!=="getBounds"&&this.hasStroke()&&(n=n.expand(this.getStrokeWidth())),t?t._transformBounds(n):n},_contains:function dt(e){switch(this._type){case"rect":return dt.base.call(this,e);case"circle":case"ellipse":return e.divide(this._size).getLength()<=.5}},_hitTest:function vt(e){if(this.hasStroke()){var t=this._type,n=this.getStrokeWidth();switch(t){case"rect":var r=(new h(this._size)).setCenter(0,0),i=r.expand(n),s=r.expand(-n);if(i._containsPoint(e)&&!s._containsPoint(e))return new T("stroke",this);break;case"circle":case"ellipse":var o=this._size,u=o.width,a=o.height,f;if(t==="ellipse"){var l=e.getAngleInRadians(),c=u*Math.sin(l),p=a*Math.cos(l);f=u*a/(2*Math.sqrt(c*c+p*p))}else f=(u+a)/4;if(2*Math.abs(e.getLength()-f)<=n)return new T("stroke",this)}}return vt.base.apply(this,arguments)},statics:new function(){function t(t,n,r,i){return new E(t,n,r,e.getNamed(i))}return{Circle:function(){var n=u.readNamed(arguments,"center"),r=e.readNamed(arguments,"radius");return t("circle",n,new f(r*2),arguments)},Rectangle:function(){var e=h.readNamed(arguments,"rectangle");return t("rect",e.getCenter(!0),e.getSize(!0),arguments)},Ellipse:function(){var e=h.readNamed(arguments,"rectangle");return t("ellipse",e.getCenter(!0),e.getSize(!0),arguments)}}}}),S=y.extend({_class:"Raster",_transformContent:!1,_boundsGetter:"getBounds",_boundsSelected:!0,_serializeFields:{source:null},initialize:function(t,n){this._initialize(t,n!==undefined&&u.read(arguments,1))||(t.getContext?this.setCanvas(t):typeof t=="string"?this.setSource(t):this.setImage(t)),this._size||(this._size=new f)},clone:function(e){var t={insert:!1},n=this._image;if(n)t.image=n;else if(this._canvas){var r=t.canvas=G.getCanvas(this._size);r.getContext("2d").drawImage(this._canvas,0,0)}return this._clone(new S(t),e)},getSize:function(){var e=this._size;return new c(e.width,e.height,this,"setSize")},setSize:function(){var e=f.read(arguments);if(!this._size.equals(e)){var t=this.getElement();this.setCanvas(G.getCanvas(e)),t&&this.getContext(!0).drawImage(t,0,0,e.width,e.height)}},getWidth:function(){return this._size.width},getHeight:function(){return this._size.height},isEmpty:function(){return this._size.width==0&&this._size.height==0},getPpi:function(){var e=this._matrix,t=(new u(0,0)).transform(e),n=(new u(1,0)).transform(e).subtract(t),r=(new u(0,1)).transform(e).subtract(t);return new f(72/n.getLength(),72/r.getLength())},getContext:function(){return this._context||(this._context=this.getCanvas().getContext("2d")),arguments[0]&&(this._image=null,this._changed(129)),this._context},setContext:function(e){this._context=e},getCanvas:function(){if(!this._canvas){var e=G.getContext(this._size);try{this._image&&e.drawImage(this._image,0,0),this._canvas=e.canvas}catch(t){G.release(e)}}return this._canvas},setCanvas:function(e){this._canvas&&G.release(this._canvas),this._canvas=e,this._size=new f(e.width,e.height),this._image=null,this._context=null,this._changed(133)},getImage:function(){return this._image},setImage:function(e){this._canvas&&G.release(this._canvas),this._image=e,this._size=new f(e.width,e.height),this._canvas=null,this._context=null,this._changed(5)},getSource:function(){return this._image&&this._image.src||this.toDataURL()},setSource:function(e){function r(){t.fire("load"),t._project.view&&t._project.view.draw(!0)}var t=this,n=document.getElementById(e)||new Image;n.width&&n.height?setTimeout(r,0):n.src||(R.add(n,{load:function(){t.setImage(n),r()}}),n.src=e),this.setImage(n)},getElement:function(){return this._canvas||this._image},getSubImage:function(e){e=h.read(arguments);var t=G.getContext(e.getSize());return t.drawImage(this.getCanvas(),e.x,e.y,e.width,e.height,0,0,e.width,e.height),t.canvas},toDataURL:function(){var e=this._image&&this._image.src;if(/^data:/.test(e))return e;var t=this.getCanvas();return t?t.toDataURL():null},drawImage:function(e,t){t=u.read(arguments,1),this.getContext(!0).drawImage(e,t.x,t.y)},getAverageColor:function(t){var n,r;t?t instanceof A?(r=t,n=t.getBounds()):t.width?n=new h(t):t.x&&(n=new h(t.x-.5,t.y-.5,1,1)):n=this.getBounds();var i=32,s=Math.min(n.width,i),o=Math.min(n.height,i),u=S._sampleContext;u?u.clearRect(0,0,i+1,i+1):u=S._sampleContext=G.getContext(new f(i)),u.save();var a=(new d).scale(s/n.width,o/n.height).translate(-n.x,-n.y);a.applyToContext(u),r&&r.draw(u,e.merge({clip:!0,transforms:[a]})),this._matrix.applyToContext(u),u.drawImage(this.getElement(),-this._size.width/2,-this._size.height/2),u.restore();var l=u.getImageData(.5,.5,Math.ceil(s),Math.ceil(o)).data,c=[0,0,0],p=0;for(var v=0,m=l.length;v<m;v+=4){var g=l[v+3];p+=g,g/=255,c[0]+=l[v]*g,c[1]+=l[v+1]*g,c[2]+=l[v+2]*g}for(var v=0;v<3;v++)c[v]/=p;return p?B.read(c):null},getPixel:function(e){e=u.read(arguments);var t=this.getContext().getImageData(e.x,e.y,1,1).data;return new B("rgb",[t[0]/255,t[1]/255,t[2]/255],t[3]/255)},setPixel:function(){var e=u.read(arguments),t=B.read(arguments),n=t._convert("rgb"),r=t._alpha,i=this.getContext(!0),s=i.createImageData(1,1),o=s.data;o[0]=n[0]*255,o[1]=n[1]*255,o[2]=n[2]*255,o[3]=r!=null?r*255:255,i.putImageData(s,e.x,e.y)},createImageData:function(e){return e=f.read(arguments),this.getContext().createImageData(e.width,e.height)},getImageData:function(e){return e=h.read(arguments),e.isEmpty()&&(e=new h(this._size)),this.getContext().getImageData(e.x,e.y,e.width,e.height)},setImageData:function(e,t){t=u.read(arguments,1),this.getContext(!0).putImageData(e,t.x,t.y)},_getBounds:function(e,t){var n=(new h(this._size)).setCenter(0,0);return t?t._transformBounds(n):n},_hitTest:function(e){if(this._contains(e)){var t=this;return new T("pixel",t,{offset:e.add(t._size.divide(2)).round(),color:{get:function(){return t.getPixel(this.offset)}}})}},_draw:function(e){var t=this.getElement();t&&(e.globalAlpha=this._opacity,e.drawImage(t,-this._size.width/2,-this._size.height/2))},_canComposite:function(){return!0}}),x=y.extend({_class:"PlacedSymbol",_transformContent:!1,_boundsGetter:{getBounds:"getStrokeBounds"},_boundsSelected:!0,_serializeFields:{symbol:null},initialize:function(t,n){this._initialize(t,n!==undefined&&u.read(arguments,1))||this.setSymbol(t instanceof g?t:new g(t))},getSymbol:function(){return this._symbol},setSymbol:function(e){this._symbol&&delete this._symbol._instances[this._id],this._symbol=e,e._instances[this._id]=this},clone:function(e){return this._clone(new x({symbol:this.symbol,insert:!1}),e)},isEmpty:function(){return this._symbol._definition.isEmpty()},_getBounds:function(e,t){return this.symbol._definition._getCachedBounds(e,t)},_hitTest:function(e,t,n){var r=this._symbol._definition._hitTest(e,t,n);return r&&(r.item=this),r},_draw:function(e,t){this.symbol._definition.draw(e,t)}}),T=e.extend({_class:"HitResult",initialize:function(t,n,r){this.type=t,this.item=n,r&&(r.enumerable=!0,this.inject(r))},statics:{getOptions:function(t){return t&&t._merged?t:e.merge({type:null,tolerance:paper.project.options.hitTolerance||2,fill:!t,stroke:!t,segments:!t,handles:!1,ends:!1,center:!1,bounds:!1,guides:!1,selected:!1,_merged:!0},t)}}}),N=e.extend({_class:"Segment",initialize:function(t,n,r,i,s,o){var u=arguments.length,a,f,l;u!==0&&(u===1?t.point?(a=t.point,f=t.handleIn,l=t.handleOut):a=t:u<6?u==2&&n.x===undefined?a=[t,n]:(a=t,f=n,l=r):u===6&&(a=[t,n],f=[r,i],l=[s,o])),this._point=new C(a,this),this._handleIn=new C(f,this),this._handleOut=new C(l,this)},_serialize:function(t){return e.serialize(this.isLinear()?this._point:[this._point,this._handleIn,this._handleOut],t,!0)},_changed:function(e){if(!this._path)return;var t=this._path._curves&&this.getCurve(),n;t&&(t._changed(),(n=t[e==this._point||e==this._handleIn&&t._segment1==this?"getPrevious":"getNext"]())&&n._changed()),this._path._changed(5)},getPoint:function(){return this._point},setPoint:function(e){e=u.read(arguments),this._point.set(e.x,e.y)},getHandleIn:function(){return this._handleIn},setHandleIn:function(e){e=u.read(arguments),this._handleIn.set(e.x,e.y)},getHandleOut:function(){return this._handleOut},setHandleOut:function(e){e=u.read(arguments),this._handleOut.set(e.x,e.y)},isLinear:function(){return this._handleIn.isZero()&&this._handleOut.isZero()},setLinear:function(){this._handleIn.set(0,0),this._handleOut.set(0,0)},_isSelected:function(e){var t=this._selectionState;return e==this._point?!!(t&4):e==this._handleIn?!!(t&1):e==this._handleOut?!!(t&2):!1},_setSelected:function(e,t){var n=this._path,t=!!t,r=this._selectionState||0,i=[!!(r&4),!!(r&1),!!(r&2)];if(e==this._point){if(t)i[1]=i[2]=!1;else{var s=this.getPrevious(),o=this.getNext();i[1]=s&&(s._point.isSelected()||s._handleOut.isSelected()),i[2]=o&&(o._point.isSelected()||o._handleIn.isSelected())}i[0]=t}else{var u=e==this._handleIn?1:2;i[u]!=t&&(t&&(i[0]=!1),i[u]=t)}this._selectionState=(i[0]?4:0)|(i[1]?1:0)|(i[2]?2:0),n&&r!=this._selectionState&&(n._updateSelection(this,r,this._selectionState),n._changed(33))},isSelected:function(){return this._isSelected(this._point)},setSelected:function(e){this._setSelected(this._point,e)},getIndex:function(){return this._index!==undefined?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var e=this._path,t=this._index;return e?(!e._closed&&t==e._segments.length-1&&t--,e.getCurves()[t]||null):null},getLocation:function(){var e=this.getCurve();return e?new L(e,e.getNext()?0:1):null},getNext:function(){var e=this._path&&this._path._segments;return e&&(e[this._index+1]||this._path._closed&&e[0])||null},getPrevious:function(){var e=this._path&&this._path._segments;return e&&(e[this._index-1]||this._path._closed&&e[e.length-1])||null},reverse:function(){return new N(this._point,this._handleOut,this._handleIn)},remove:function(){return this._path?!!this._path.removeSegment(this._index):!1},clone:function(){return new N(this._point,this._handleIn,this._handleOut)},equals:function(e){return e===this||e&&this._point.equals(e._point)&&this._handleIn.equals(e._handleIn)&&this._handleOut.equals(e._handleOut)||!1},toString:function(){var e=["point: "+this._point];return this._handleIn.isZero()||e.push("handleIn: "+this._handleIn),this._handleOut.isZero()||e.push("handleOut: "+this._handleOut),"{ "+e.join(", ")+" }"},_transformCoordinates:function(e,t,n){var r=this._point,i=!n||!this._handleIn.isZero()?this._handleIn:null,s=!n||!this._handleOut.isZero()?this._handleOut:null,o=r._x,u=r._y,a=2;return t[0]=o,t[1]=u,i&&(t[a++]=i._x+o,t[a++]=i._y+u),s&&(t[a++]=s._x+o,t[a++]=s._y+u),e&&(e._transformCoordinates(t,0,t,0,a/2),o=t[0],u=t[1],n?(r._x=o,r._y=u,a=2,i&&(i._x=t[a++]-o,i._y=t[a++]-u),s&&(s._x=t[a++]-o,s._y=t[a++]-u)):(i||(t[a++]=o,t[a++]=u),s||(t[a++]=o,t[a++]=u))),t}}),C=u.extend({initialize:function(t,n){var r,i,s;t?(r=t[0])!==undefined?i=t[1]:((r=t.x)===undefined&&(t=u.read(arguments),r=t.x),i=t.y,s=t.selected):r=i=0,this._x=r,this._y=i,this._owner=n,s&&this.setSelected(!0)},set:function(e,t){return this._x=e,this._y=t,this._owner._changed(this),this},getX:function(){return this._x},setX:function(e){this._x=e,this._owner._changed(this)},getY:function(){return this._y},setY:function(e){this._y=e,this._owner._changed(this)},isZero:function(){return o.isZero(this._x)&&o.isZero(this._y)},setSelected:function(e){this._owner._setSelected(this,e)},isSelected:function(){return this._owner._isSelected(this)}}),k=e.extend({_class:"Curve",initialize:function(t,n,r,i,s,o,u,a){var f=arguments.length;if(f===3)this._path=t,this._segment1=n,this._segment2=r;else if(f===0)this._segment1=new N,this._segment2=new N;else if(f===1)this._segment1=new N(t.segment1),this._segment2=new N(t.segment2);else if(f===2)this._segment1=new N(t),this._segment2=new N(n);else{var l,c,h,p;f===4?(l=t,c=n,h=r,p=i):f===8&&(l=[t,n],p=[u,a],c=[r-t,i-n],h=[s-u,o-a]),this._segment1=new N(l,null,c),this._segment2=new N(p,h,null)}},_changed:function(){delete this._length,delete this._bounds},getPoint1:function(){return this._segment1._point},setPoint1:function(e){e=u.read(arguments),this._segment1._point.set(e.x,e.y)},getPoint2:function(){return this._segment2._point},setPoint2:function(e){e=u.read(arguments),this._segment2._point.set(e.x,e.y)},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(e){e=u.read(arguments),this._segment1._handleOut.set(e.x,e.y)},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(e){e=u.read(arguments),this._segment2._handleIn.set(e.x,e.y)},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index+1]||this._path._closed&&e[0])||null},getPrevious:function(){var e=this._path&&this._path._curves;return e&&(e[this._segment1._index-1]||this._path._closed&&e[e.length-1])||null},isSelected:function(){return this.getHandle1().isSelected()&&this.getHandle2().isSelected()},setSelected:function(e){this.getHandle1().setSelected(e),this.getHandle2().setSelected(e)},getValues:function(){return k.getValues(this._segment1,this._segment2)},getPoints:function(){var e=this.getValues(),t=[];for(var n=0;n<8;n+=2)t.push(new u(e[n],e[n+1]));return t},getLength:function(){var e=arguments[0],t=arguments[1],n=arguments.length===0||e===0&&t===1;if(n&&this._length!=null)return this._length;var r=k.getLength(this.getValues(),e,t);return n&&(this._length=r),r},getArea:function(){return k.getArea(this.getValues())},getPart:function(e,t){return new k(k.getPart(this.getValues(),e,t))},isLinear:function(){return this._segment1._handleOut.isZero()&&this._segment2._handleIn.isZero()},getIntersections:function(e){return k.getIntersections(this.getValues(),e.getValues(),this,e,[])},reverse:function(){return new k(this._segment2.reverse(),this._segment1.reverse())},_getParameter:function(e,t){return t?e:e&&e.curve===this?e.parameter:e===undefined&&t===undefined?.5:this.getParameterAt(e,0)},divide:function(e,t){var n=this._getParameter(e,t),r=null;if(n>0&&n<1){var i=k.subdivide(this.getValues(),n),s=this.isLinear(),o=i[0],a=i[1];s||(this._segment1._handleOut.set(o[2]-o[0],o[3]-o[1]),this._segment2._handleIn.set(a[4]-a[6],a[5]-a[7]));var f=o[6],l=o[7],c=new N(new u(f,l),!s&&new u(o[4]-f,o[5]-l),!s&&new u(a[2]-f,a[3]-l));if(this._path)this._segment1._index>0&&this._segment2._index===0?this._path.add(c):this._path.insert(this._segment2._index,c),r=this;else{var h=this._segment2;this._segment2=c,r=new k(c,h)}}return r},split:function(e,t){return this._path?this._path.split(this._segment1._index,this._getParameter(e,t)):null},clone:function(){return new k(this._segment1,this._segment2)},toString:function(){var e=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||e.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||e.push("handle2: "+this._segment2._handleIn),e.push("point2: "+this._segment2._point),"{ "+e.join(", ")+" }"},statics:{getValues:function(e,t){var n=e._point,r=e._handleOut,i=t._handleIn,s=t._point;return[n._x,n._y,n._x+r._x,n._y+r._y,s._x+i._x,s._y+i._y,s._x,s._y]},evaluate:function(e,t,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],f=e[5],l=e[6],c=e[7],h,p;if(n!==0||t!==0&&t!==1){var d=3*(s-r),v=3*(a-s)-d,m=l-r-d-v,g=3*(o-i),y=3*(f-o)-g,b=c-i-g-y;if(n===0)h=((m*t+v)*t+d)*t+r,p=((b*t+y)*t+g)*t+i;else{var w=1e-5;t<w&&s==r&&o==i||t>1-w&&a==l&&f==c?(h=a-s,p=f-o):(h=(3*m*t+2*v)*t+d,p=(3*b*t+2*y)*t+g);if(n===3){var E=6*m*t+2*v,S=6*b*t+2*y;return(h*S-p*E)/Math.pow(h*h+p*p,1.5)}}}else h=t===0?r:l,p=t===0?i:c;return n==2?new u(p,-h):new u(h,p)},subdivide:function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7];t===undefined&&(t=.5);var l=1-t,c=l*n+t*i,h=l*r+t*s,p=l*i+t*o,d=l*s+t*u,v=l*o+t*a,m=l*u+t*f,g=l*c+t*p,y=l*h+t*d,b=l*p+t*v,w=l*d+t*m,E=l*g+t*b,S=l*y+t*w;return[[n,r,c,h,g,y,E,S],[E,S,b,w,v,m,a,f]]},solveCubic:function(e,t,n,r){var i=e[t],s=e[t+2],u=e[t+4],a=e[t+6],f=3*(s-i),l=3*(u-s)-f,c=a-i-f-l;return o.solveCubic(c,l,f,i-n,r)},getParameterOf:function(e,t,n){if(Math.abs(e[0]-t)<1e-5&&Math.abs(e[1]-n)<1e-5)return 0;if(Math.abs(e[6]-t)<1e-5&&Math.abs(e[7]-n)<1e-5)return 1;var r=[],i=[],s=k.solveCubic(e,0,t,r),o=k.solveCubic(e,1,n,i),u,a;for(var f=0;s==-1||f<s;)if(s==-1||(u=r[f++])>=0&&u<=1){for(var l=0;o==-1||l<o;)if(o==-1||(a=i[l++])>=0&&a<=1){s==-1?u=a:o==-1&&(a=u);if(Math.abs(u-a)<1e-5)return(u+a)*.5}if(s==-1)break}return null},getPart:function(e,t,n){return t>0&&(e=k.subdivide(e,t)[1]),n<1&&(e=k.subdivide(e,(n-t)/(1-t))[0]),e},isLinear:function(e){return e[0]===e[2]&&e[1]===e[3]&&e[4]===e[6]&&e[5]===e[7]},isFlatEnough:function(e,t){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],u=e[5],a=e[6],f=e[7],l=3*i-2*n-a,c=3*s-2*r-f,h=3*o-2*a-n,p=3*u-2*f-r;return Math.max(l*l,h*h)+Math.max(c*c,p*p)<10*t*t},getArea:function(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7];return(3*i*t-1.5*i*s-1.5*i*u-3*n*r-1.5*n*s-.5*n*u+1.5*o*t+1.5*o*r-3*o*u+.5*a*t+1.5*a*r+3*a*s)/10},getBounds:function(e){var t=e.slice(0,2),n=t.slice(),r=[0,0];for(var i=0;i<2;i++)k._addBounds(e[i],e[i+2],e[i+4],e[i+6],i,0,t,n,r);return new h(t[0],t[1],n[0]-t[0],n[1]-t[1])},_getCrossings:function(e,t,n,r,i){function f(e){return k.evaluate(t,1,1).y*e.y>0}var s=k.solveCubic(e,1,r,i),o=0,u=1e-5,a=Math.abs;s===-1&&(i[0]=k.getParameterOf(e,n,r),s=i[0]!==null?1:0);for(var l=0;l<s;l++){var c=i[l];if(c>-u&&c<1-u){var h=k.evaluate(e,c,0);if(n<h.x+u){var p=k.evaluate(e,c,1);if(a(h.x-n)<u){var d=p.getAngle();if(d>-180&&d<0&&(c>u||f(p)))continue}else if(a(p.y)<u||c<u&&!f(p))continue;o++}}}return o},_addBounds:function(e,t,n,r,i,s,u,a,f){function l(e,t){var n=e-t,r=e+t;n<u[i]&&(u[i]=n),r>a[i]&&(a[i]=r)}var c=3*(t-n)-e+r,h=2*(e+n)-4*t,p=t-e,d=o.solveQuadratic(c,h,p,f),v=1e-5,m=1-v;l(r,0);for(var g=0;g<d;g++){var y=f[g],b=1-y;v<y&&y<m&&l(b*b*b*e+3*b*b*y*t+3*b*y*y*n+y*y*y*r,s)}}}},e.each(["getBounds","getStrokeBounds","getHandleBounds","getRoughBounds"],function(e){this[e]=function(){this._bounds||(this._bounds={});var t=this._bounds[e];return t||(t=this._bounds[e]=O[e]([this._segment1,this._segment2],!1,this._path.getStyle())),t.clone()}},{}),e.each(["getPoint","getTangent","getNormal","getCurvature"],function(e,t){this[e+"At"]=function(e,n){var r=this.getValues();return k.evaluate(r,n?e:k.getParameterAt(r,e,0),t)},this[e]=function(e){return k.evaluate(this.getValues(),e,t)}},{getParameterAt:function(e,t){return k.getParameterAt(this.getValues(),e,t!==undefined?t:e<0?1:0)},getParameterOf:function(e){return e=u.read(arguments),k.getParameterOf(this.getValues(),e.x,e.y)},getLocationAt:function(e,t){return t||(e=this.getParameterAt(e)),new L(this,e)},getLocationOf:function(e){e=u.read(arguments);var t=this.getParameterOf(e);return t!=null?new L(this,t):null},getNearestLocation:function(e){function a(n){if(n>=0&&n<=1){var r=e.getDistance(k.evaluate(t,n,0),!0);if(r<i)return i=r,s=n,!0}}e=u.read(arguments);var t=this.getValues(),n=100,r=o.TOLERANCE,i=Infinity,s=0;for(var f=0;f<=n;f++)a(f/n);var l=1/(n*2);while(l>r)!a(s-l)&&!a(s+l)&&(l/=2);var c=k.evaluate(t,s,0);return new L(this,s,c,null,null,null,e.getDistance(c))},getNearestPoint:function(e){return e=u.read(arguments),this.getNearestLocation(e).getPoint()}}),new function(){function e(e){var t=e[0],n=e[1],r=e[2],i=e[3],s=e[4],o=e[5],u=e[6],a=e[7],f=9*(r-s)+3*(u-t),l=6*(t+s)-12*r,c=3*(r-t),h=9*(i-o)+3*(a-n),p=6*(n+o)-12*i,d=3*(i-n);return function(e){var t=(f*e+l)*e+c,n=(h*e+p)*e+d;return Math.sqrt(t*t+n*n)}}function t(e,t){return Math.max(2,Math.min(16,Math.ceil(Math.abs(t-e)*32)))}return{statics:!0,getLength:function(n,r,i){r===undefined&&(r=0),i===undefined&&(i=1);if(n[0]==n[2]&&n[1]==n[3]&&n[6]==n[4]&&n[7]==n[5]){var s=n[6]-n[0],u=n[7]-n[1];return(i-r)*Math.sqrt(s*s+u*u)}var a=e(n);return o.integrate(a,r,i,t(r,i))},getParameterAt:function(n,r,i){function p(e){var n=t(i,e);return h+=i<e?o.integrate(f,i,e,n):-o.integrate(f,e,i,n),i=e,h-r}if(r===0)return i;var s=r>0,u=s?i:0,a=s?1:i,r=Math.abs(r),f=e(n),l=o.integrate(f,u,a,t(u,a));if(r>=l)return s?a:u;var c=r/l,h=0;return o.findRoot(p,f,s?u+c:a-c,u,a,16,1e-5)}}},new function(){function e(e,t,n,r,i,s,o){var u=e[0],a=e[e.length-1];(!u||!r.equals(u._point))&&(!a||!r.equals(a._point))&&e.push(new L(t,n,r,i,s,o))}function t(r,i,s,o,u,a,f,l){l=(l||0)+1;if(l>20)return;a=a||[0,1],f=f||[0,1];var c=k.getPart(r,a[0],a[1]),h=k.getPart(i,f[0],f[1]),p=0;while(p++<20){var d,v=n(c,h,d=f.slice()),m=0;if(v===0)break;if(v>0){f=d,h=k.getPart(i,f[0],f[1]),m=n(h,c,d=a.slice());if(m===0)break;v>0&&(a=d,c=k.getPart(r,a[0],a[1]))}if(v<0||m<0){if(a[1]-a[0]>f[1]-f[0]){var g=(a[0]+a[1])/2;t(r,i,s,o,u,[a[0],g],f,l),t(r,i,s,o,u,[g,a[1]],f,l);break}var g=(f[0]+f[1])/2;t(r,i,s,o,u,a,[f[0],g],l),t(r,i,s,o,u,a,[g,f[1]],l);break}if(Math.abs(a[1]-a[0])<=1e-5&&Math.abs(f[1]-f[0])<=1e-5){var y=(a[0]+a[1])/2,b=(f[0]+f[1])/2;e(u,s,y,k.evaluate(r,y,0),o,b,k.evaluate(i,b,0));break}}}function n(e,t,n){var i=e[0],s=e[1],o=e[2],u=e[3],a=e[4],f=e[5],l=e[6],c=e[7],h=t[0],p=t[1],d=t[2],m=t[3],g=t[4],y=t[5],b=t[6],w=t[7],E=v.getSignedDistance,S=E(i,s,l,c,o,u)||0,x=E(i,s,l,c,a,f)||0,T=S*x>0?.75:4/9,N=T*Math.min(0,S,x),C=T*Math.max(0,S,x),L=E(i,s,l,c,h,p),A=E(i,s,l,c,d,m),O=E(i,s,l,c,g,y),M=E(i,s,l,c,b,w);if(N>Math.max(L,A,O,M)||C<Math.min(L,A,O,M))return 0;var _=r(L,A,O,M),D;M<L&&(D=N,N=C,C=D);var P=-Infinity,H=Infinity,B=-Infinity;for(var j=0,F=_.length;j<F;j++){var I=_[j],q=_[(j+1)%F];q[1]<I[1]&&(D=q,q=I,I=D);var R=I[0],U=I[1],z=q[0],W=q[1],X=(W-U)/(z-R);if(N>=U&&N<=W){var V=R+(N-U)/X;V<H&&(H=V),V>P&&(P=V)}if(C>=U&&C<=W){var V=R+(C-U)/X;V>B&&(B=V),V<H&&(H=0)}}if(H!==Infinity&&B!==-Infinity){var $=Math.min(N,C),J=Math.max(N,C);M>$&&M<J&&(B=1),L>$&&L<J&&(H=0),P>B&&(B=1);var K=n[0],Q=n[1]-K;n[0]=K+H*Q,n[1]=K+B*Q;if((Q-(n[1]-n[0]))/Q>=.2)return 1}return k.getBounds(e).touches(k.getBounds(t))?-1:0}function r(e,t,n,r){var i=[0,e],s=[1/3,t],o=[2/3,n],u=[1,r],a=v.getSignedDistance,f=a(0,e,1,r,1/3,t),l=a(0,e,1,r,2/3,n);if(f*l<0)return[i,s,u,o];var c,h;return Math.abs(f)>Math.abs(l)?(c=s,h=(r-n-(r-e)/3)*(2*(r-n)-r+t)/3):(c=o,h=(t-e+(e-r)/3)*(-2*(e-t)+e-n)/3),h<0?[i,c,u]:[i,s,o,u]}function i(t,n,r,i,s){var o=k.isLinear(t),u=o?n:t,a=o?t:n,f=a[0],l=a[1],c=a[6],h=a[7],p=c-f,d=h-l,v=Math.atan2(-d,p),m=Math.sin(v),g=Math.cos(v),y=p*g-d*m,b=[];for(var w=0;w<8;w+=2){var E=u[w]-f,S=u[w+1]-l;b.push(E*g-S*m,S*g+E*m)}var x=[],T=k.solveCubic(b,1,0,x);for(var w=0;w<T;w++){var N=x[w];if(N>=0&&N<=1){var C=k.evaluate(b,N,0);C.x>=0&&C.x<=y&&e(s,o?i:r,N,k.evaluate(u,N,0),o?r:i)}}}function s(t,n,r,i,s){var o=v.intersect(t[0],t[1],t[6],t[7],n[0],n[1],n[6],n[7]);o&&e(s,r,null,o,i)}return{statics:{getIntersections:function(e,n,r,o,u){var a=k.isLinear(e),f=k.isLinear(n);return(a&&f?s:a||f?i:t)(e,n,r,o,u),u}}}}),L=e.extend({_class:"CurveLocation",initialize:function mt(e,t,n,r,i,s,o){this._id=mt._id=(mt._id||0)+1,this._curve=e,this._segment1=e._segment1,this._segment2=e._segment2,this._parameter=t,this._point=n,this._curve2=r,this._parameter2=i,this._point2=s,this._distance=o},getSegment:function(){if(!this._segment){var e=this.getCurve(),t=this.getParameter();if(t===1)this._segment=e._segment2;else if(t===0||arguments[0])this._segment=e._segment1;else{if(t==null)return null;this._segment=e.getLength(0,t)<e.getLength(t,1)?e._segment1:e._segment2}}return this._segment},getCurve:function(){if(!this._curve||arguments[0])this._curve=this._segment1.getCurve(),this._curve.getParameterOf(this._point)==null&&(this._curve=this._segment2.getPrevious().getCurve());return this._curve},getIntersection:function(){var e=this._intersection;if(!e&&this._curve2){var t=this._parameter2;this._intersection=e=new L(this._curve2,t,this._point2||this._point,this),e._intersection=this}return e},getPath:function(){var e=this.getCurve();return e&&e._path},getIndex:function(){var e=this.getCurve();return e&&e.getIndex()},getOffset:function(){var e=this.getPath();return e&&e._getOffset(this)},getCurveOffset:function(){var e=this.getCurve(),t=this.getParameter();return t!=null&&e&&e.getLength(0,t)},getParameter:function(){if((this._parameter==null||arguments[0])&&this._point){var e=this.getCurve(arguments[0]&&this._point);this._parameter=e&&e.getParameterOf(this._point)}return this._parameter},getPoint:function(){if((!this._point||arguments[0])&&this._parameter!=null){var e=this.getCurve();this._point=e&&e.getPointAt(this._parameter,!0)}return this._point},getTangent:function(){var e=this.getParameter(),t=this.getCurve();return e!=null&&t&&t.getTangentAt(e,!0)},getNormal:function(){var e=this.getParameter(),t=this.getCurve();return e!=null&&t&&t.getNormalAt(e,!0)},getDistance:function(){return this._distance},divide:function(){var e=this.getCurve(!0);return e&&e.divide(this.getParameter(!0),!0)},split:function(){var e=this.getCurve(!0);return e&&e.split(this.getParameter(!0),!0)},toString:function(){var e=[],t=this.getPoint(),n=s.instance;t&&e.push("point: "+t);var r=this.getIndex();r!=null&&e.push("index: "+r);var i=this.getParameter();return i!=null&&e.push("parameter: "+n.number(i)),this._distance!=null&&e.push("distance: "+n.number(this._distance)),"{ "+e.join(", ")+" }"}}),A=y.extend({_class:"PathItem",initialize:function(){},getIntersections:function(e){if(!this.getBounds().touches(e.getBounds()))return[];var t=[],n=this.getCurves(),r=e.getCurves(),i=r.length,s=[];for(var o=0;o<i;o++)s[o]=r[o].getValues();for(var o=0,u=n.length;o<u;o++){var a=n[o],f=a.getValues();for(var l=0;l<i;l++)k.getIntersections(f,s[l],a,r[l],t)}return t},setPathData:function(e){function o(e,t,i){var o=parseFloat(n[e]);return r&&(o+=s[t]),i&&(s[t]=o),o}function a(e,t){return new u(o(e,"x",t),o(e+1,"y",t))}var t=e.match(/[a-z][^a-z]*/ig),n,r=!1,i,s=new u;this._type==="path"?this.removeSegments():this.removeChildren();for(var f=0,l=t.length;f<l;f++){var c=t[f],h=c[0],p=h.toLowerCase();n=c.slice(1).trim().split(/[\s,]+|(?=[+-])/),r=h===p;var d=n.length;switch(p){case"m":case"l":for(var v=0;v<d;v+=2)this[v===0&&p==="m"?"moveTo":"lineTo"](a(v,!0));break;case"h":case"v":var m=p=="h"?"x":"y";for(var v=0;v<d;v++)o(v,m,!0),this.lineTo(s);break;case"c":for(var v=0;v<d;v+=6)this.cubicCurveTo(a(v),i=a(v+2),a(v+4,!0));break;case"s":for(var v=0;v<d;v+=4)this.cubicCurveTo(s.multiply(2).subtract(i),i=a(v),a(v+2,!0));break;case"q":for(var v=0;v<d;v+=4)this.quadraticCurveTo(i=a(v),a(v+2,!0));break;case"t":for(var v=0;v<d;v+=2)this.quadraticCurveTo(i=s.multiply(2).subtract(i),a(v,!0));break;case"a":break;case"z":this.closePath()}}},_canComposite:function(){return!this.hasFill()||!this.hasStroke()}}),O=A.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(t){this._closed=!1,this._segments=[];var n=Array.isArray(t)?typeof t[0]=="object"?t:arguments:t&&(t.point!==undefined&&t.size===undefined||t.x!==undefined)?arguments:null;this.setSegments(n||[]),this._initialize(!n&&t)},clone:function(e){var t=this._clone(new O({segments:this._segments,insert:!1}),e);return t._closed=this._closed,this._clockwise!==undefined&&(t._clockwise=this._clockwise),t},_changed:function gt(e){gt.base.call(this,e);if(e&4){delete this._length,delete this._clockwise;if(this._curves)for(var t=0,n=this._curves.length;t<n;t++)this._curves[t]._changed(5)}else e&8&&delete this._bounds},getSegments:function(){return this._segments},setSegments:function(e){this._selectedSegmentState=0,this._segments.length=0,delete this._curves,this._add(N.readAll(e))},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var e=this._curves,t=this._segments;if(!e){var n=this._countCurves();e=this._curves=new Array(n);for(var r=0;r<n;r++)e[r]=new k(this,t[r],t[r+1]||t[0])}return e},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var e=this.getCurves();return e[e.length-1]},getPathData:function(){function i(e,i,s){var o=e._point,u=i._point,a=e._handleOut,f=i._handleIn;if(a.isZero()&&f.isZero())s||r.push("L"+n.point(u,t));else{var l=u.subtract(o);r.push("c"+n.point(a,t)+" "+n.point(l.add(f),t)+" "+n.point(l,t))}}var e=this._segments,t=arguments[0],n=s.instance,r=[];if(e.length===0)return"";r.push("M"+n.point(e[0]._point));for(var o=0,u=e.length-1;o<u;o++)i(e[o],e[o+1],!1);return this._closed&&(i(e[e.length-1],e[0],!0),r.push("z")),r.join("")},isClosed:function(){return this._closed},setClosed:function(e){if(this._closed!=(e=!!e)){this._closed=e;if(this._curves){var t=this._curves.length=this._countCurves();e&&(this._curves[t-1]=new k(this,this._segments[t-1],this._segments[0]))}this._changed(5)}},isEmpty:function(){return this._segments.length===0},isPolygon:function(){for(var e=0,t=this._segments.length;e<t;e++)if(!this._segments[e].isLinear())return!1;return!0},_applyMatrix:function(e){var t=new Array(6);for(var n=0,r=this._segments.length;n<r;n++)this._segments[n]._transformCoordinates(e,t,!0);return!0},_add:function(e,t){var n=this._segments,r=this._curves,i=e.length,s=t==null,t=s?n.length:t,o=this.isFullySelected();for(var u=0;u<i;u++){var a=e[u];a._path&&(a=e[u]=a.clone()),a._path=this,a._index=t+u,o&&(a._selectionState=4),a._selectionState&&this._updateSelection(a,0,a._selectionState)}if(s)n.push.apply(n,e);else{n.splice.apply(n,[t,0].concat(e));for(var u=t+i,f=n.length;u<f;u++)n[u]._index=u}if(r||e._curves){r||(r=this._curves=[]);var l=t>0?t-1:t,c=l,h=Math.min(l+i,this._countCurves());e._curves&&(r.splice.apply(r,[l,0].concat(e._curves)),c+=e._curves.length);for(var u=c;u<h;u++)r.splice(u,0,new k(this,null,null));this._adjustCurves(l,h)}return this._changed(5),e},_adjustCurves:function(e,t){var n=this._segments,r=this._curves,i;for(var s=e;s<t;s++)i=r[s],i._path=this,i._segment1=n[s],i._segment2=n[s+1]||n[0];if(i=r[this._closed&&e===0?n.length-1:e-1])i._segment2=n[e]||n[0];if(i=r[t])i._segment1=n[t]},_countCurves:function(){var e=this._segments.length;return!this._closed&&e>0?e-1:e},add:function(e){return arguments.length>1&&typeof e!="number"?this._add(N.readAll(arguments)):this._add([N.read(arguments)])[0]},insert:function(e,t){return arguments.length>2&&typeof t!="number"?this._add(N.readAll(arguments,1),e):this._add([N.read(arguments,1)],e)[0]},addSegment:function(){return this._add([N.read(arguments)])[0]},insertSegment:function(e){return this._add([N.read(arguments,1)],e)[0]},addSegments:function(e){return this._add(N.readAll(e))},insertSegments:function(e,t){return this._add(N.readAll(t),e)},removeSegment:function(e){return this.removeSegments(e,e+1)[0]||null},removeSegments:function(t,n){t=t||0,n=e.pick(n,this._segments.length);var r=this._segments,i=this._curves,s=r.length,o=r.splice(t,n-t),u=o.length;if(!u)return o;for(var a=0;a<u;a++){var f=o[a];f._selectionState&&this._updateSelection(f,f._selectionState,0),delete f._index,delete f._path}for(var a=t,l=r.length;a<l;a++)r[a]._index=a;if(i){var c=t>0&&n===s+(this._closed?1:0)?t-1:t,i=i.splice(c,u);arguments[2]&&(o._curves=i.slice(1)),this._adjustCurves(c,c)}return this._changed(5),o},isFullySelected:function(){return this._selected&&this._selectedSegmentState==this._segments.length*4},setFullySelected:function(e){e&&this._selectSegments(!0),this.setSelected(e)},setSelected:function yt(e){e||this._selectSegments(!1),yt.base.call(this,e)},_selectSegments:function(e){var t=this._segments.length;this._selectedSegmentState=e?t*4:0;for(var n=0;n<t;n++)this._segments[n]._selectionState=e?4:0},_updateSelection:function(e,t,n){e._selectionState=n;var r=this._selectedSegmentState+=n-t;r>0&&this.setSelected(!0)},flatten:function(e){var t=new _(this),n=0,r=t.length/Math.ceil(t.length/e),i=t.length+(this._closed?-r:r)/2,s=[];while(n<=i)s.push(new N(t.evaluate(n,0))),n+=r;this.setSegments(s)},simplify:function(e){if(this._segments.length>2){var t=new D(this,e||2.5);this.setSegments(t.fit())}},split:function(e,t){if(t===null)return;if(arguments.length===1){var n=e;typeof n=="number"&&(n=this.getLocationAt(n)),e=n.index,t=n.parameter}t>=1&&(e++,t--);var r=this.getCurves();if(e>=0&&e<r.length){t>0&&r[e++].divide(t,!0);var i=this.removeSegments(e,this._segments.length,!0),s;return this._closed?(this.setClosed(!1),s=this):e>0&&(s=this._clone((new O).insertAbove(this,!0))),s._add(i,0),this.addSegment(i[0]),s}return null},isClockwise:function(){return this._clockwise!==undefined?this._clockwise:O.isClockwise(this._segments)},setClockwise:function(e){this.isClockwise()!=(e=!!e)&&this.reverse(),this._clockwise=e},reverse:function(){this._segments.reverse();for(var e=0,t=this._segments.length;e<t;e++){var n=this._segments[e],r=n._handleIn;n._handleIn=n._handleOut,n._handleOut=r,n._index=e}delete this._curves,this._clockwise!==undefined&&(this._clockwise=!this._clockwise)},join:function(e){if(e){var t=e._segments,n=this.getLastSegment(),r=e.getLastSegment();n._point.equals(r._point)&&e.reverse();var i,s=e.getFirstSegment();return n._point.equals(s._point)?(n.setHandleOut(s._handleOut),this._add(t.slice(1))):(i=this.getFirstSegment(),i._point.equals(s._point)&&e.reverse(),r=e.getLastSegment(),i._point.equals(r._point)?(i.setHandleIn(r._handleIn),this._add(t.slice(0,t.length-1),0)):this._add(t.slice())),e.closed&&this._add([t[0]]),e.remove(),i=this.getFirstSegment(),n=this.getLastSegment(),n._point.equals(i._point)&&(i.setHandleIn(n._handleIn),n.remove(),this.setClosed(!0)),this._changed(5),!0}return!1},reduce:function(){return this},getLength:function(){if(this._length==null){var e=this.getCurves();this._length=0;for(var t=0,n=e.length;t<n;t++)this._length+=e[t].getLength()}return this._length},getArea:function(){var e=this.getCurves(),t=0;for(var n=0,r=e.length;n<r;n++)t+=e[n].getArea();return t},_getOffset:function(e){var t=e&&e.getIndex();if(t!=null){var n=this.getCurves(),r=0;for(var i=0;i<t;i++)r+=n[i].getLength();var s=n[t];return r+s.getLength(0,e.getParameter())}return null},getLocationOf:function(e){e=u.read(arguments);var t=this.getCurves();for(var n=0,r=t.length;n<r;n++){var i=t[n].getLocationOf(e);if(i)return i}return null},getLocationAt:function(e,t){var n=this.getCurves(),r=0;if(t){var i=~~e;return n[i].getLocationAt(e-i,!0)}for(var s=0,o=n.length;s<o;s++){var u=r,a=n[s];r+=a.getLength();if(r>=e)return a.getLocationAt(e-u)}return e<=this.getLength()?new L(n[n.length-1],1):null},getPointAt:function(e,t){var n=this.getLocationAt(e,t);return n&&n.getPoint()},getTangentAt:function(e,t){var n=this.getLocationAt(e,t);return n&&n.getTangent()},getNormalAt:function(e,t){var n=this.getLocationAt(e,t);return n&&n.getNormal()},getNearestLocation:function(e){e=u.read(arguments);var t=this.getCurves(),n=Infinity,r=null;for(var i=0,s=t.length;i<s;i++){var o=t[i].getNearestLocation(e);o._distance<n&&(n=o._distance,r=o)}return r},getNearestPoint:function(e){return e=u.read(arguments),this.getNearestLocation(e).getPoint()},getStyle:function(){var e=this._parent;return(e&&e._type==="compound-path"?e:this)._style},_contains:function(e){var t=this._closed;if(!t&&!this.hasFill()||!this._getBounds("getRoughBounds")._containsPoint(e))return!1;var n=this.getCurves(),r=this._segments,i=0,s=new Array(3),o=(t?n[n.length-1]:new k(r[r.length-1]._point,r[0]._point)).getValues(),u=o;for(var a=0,f=n.length;a<f;a++){var l=n[a].getValues(),c=l[0],h=l[1];if(c!==l[2]||h!==l[3]||c!==l[4]||h!==l[5]||c!==l[6]||h!==l[7])i+=k._getCrossings(l,u,e.x,e.y,s),u=l}return t||(i+=k._getCrossings(o,u,e.x,e.y,s)),(i&1)===1},_hitTest:function(e,t){function d(t,n,r){if(e.getDistance(n)<s)return new T(r,l,{segment:t,point:n})}function v(e,n){var r=e._point;return(n||t.segments)&&d(e,r,"segment")||!n&&t.handles&&(d(e,r.add(e._handleIn),"handle-in")||d(e,r.add(e._handleOut),"handle-out"))}function m(e){c.push(e)}function g(e){var t=c[e],n=c[(e+1)%c.length];return[t.x,t.y,t.x,t.y,n.x,n.y,n.x,n.y]}function y(e){var t=c.length,n=g(t-1),r=new Array(3),i=0;for(var s=0;s<t;s++){var o=g(s);i+=k._getCrossings(o,n,e.x,e.y,r),n=o}return(i&1)===1}function b(t){if(u!=="round"||a!=="round"){c=[],i||t._index>0&&t._index<r.length-1?u!=="round"&&(t._handleIn.isZero()||t._handleOut.isZero())&&O._addSquareJoin(t,u,o,f,m,!0):a!=="round"&&O._addSquareCap(t,a,o,m,!0);if(c.length>0)return y(e)}return e.getDistance(t._point)<=o}var n=this.getStyle(),r=this._segments,i=this._closed,s=t.tolerance||0,o=0,u,a,f,l=this,c,h,p;t.stroke&&n.getStrokeColor()&&(u=n.getStrokeJoin(),a=n.getStrokeCap(),o=n.getStrokeWidth()/2+s,f=o*n.getMiterLimit());if(t.ends&&!t.segments&&!i){if(p=v(r[0],!0)||v(r[r.length-1],!0))return p}else if(t.segments||t.handles)for(var w=0,E=r.length;w<E;w++)if(p=v(r[w]))return p;if(o>0){h=this.getNearestLocation(e);if(h){var S=h.getParameter();S===0||S===1?b(h.getSegment())||(h=null):h._distance>o&&(h=null)}if(!h&&u==="miter")for(var w=0,E=r.length;w<E;w++){var x=r[w];if(e.getDistance(x._point)<=f&&b(x)){h=x.getLocation();break}}}return!h&&t.fill&&this.hasFill()&&this.contains(e)?new T("fill",this):h?new T("stroke",this,{location:h}):null}},new function(){function e(e,t,n,r){function s(t){var n=o[t],r=o[t+1];if(h!=n||p!=r)e.beginPath(),e.moveTo(h,p),e.lineTo(n,r),e.stroke(),e.beginPath(),e.arc(n,r,i,0,Math.PI*2,!0),e.fill()}var i=r/2,o=new Array(6);for(var u=0,a=t.length;u<a;u++){var f=t[u];f._transformCoordinates(n,o,!1);var l=f._selectionState,c=l&4,h=o[0],p=o[1];(c||l&1)&&s(2),(c||l&2)&&s(4),e.save(),e.beginPath(),e.rect(h-i,p-i,r,r),e.fill(),c||(e.beginPath(),e.rect(h-i+1,p-i+1,r-2,r-2),e.fillStyle="#ffffff",e.fill()),e.restore()}}function t(e,t,n){function v(t){var i=r[t];if(n)i._transformCoordinates(n,s,!1),u=s[0],a=s[1];else{var v=i._point;u=v._x,a=v._y}if(o)e.moveTo(u,a),o=!1;else{if(n)c=s[2],h=s[3];else{var m=i._handleIn;c=u+m._x,h=a+m._y}c==u&&h==a&&p==f&&d==l?e.lineTo(u,a):e.bezierCurveTo(p,d,c,h,u,a)}f=u,l=a;if(n)p=s[4],d=s[5];else{var m=i._handleOut;p=f+m._x,d=l+m._y}}var r=t._segments,i=r.length,s=new Array(6),o=!0,u,a,f,l,c,h,p,d;for(var m=0;m<i;m++)v(m);t._closed&&i>1&&v(0)}return{_draw:function(e,n){var r=n.clip,i=n.compound;i||e.beginPath();var s=this.getStyle(),o=s.getFillColor(),u=s.getStrokeColor(),a=s.getDashArray(),f=!paper.support.nativeDash&&u&&a&&a.length;(o||u&&!f||i||r)&&t(e,this),this._closed&&e.closePath();if(!r&&!i&&(o||u)){this._setStyles(e),o&&e.fill();if(u){if(f){e.beginPath();var l=new _(this),c=s.getDashOffset(),h,p=0;while(c<l.length)h=c+a[p++%a.length],l.drawPart(e,c,h),c=h+a[p++%a.length]}e.stroke()}}},_drawSelected:function(n,r){n.beginPath(),t(n,this,r),n.stroke(),e(n,this._segments,r,this._project.options.handleSize||4)}}},new function(){function e(e){var t=e.length,n=[],r=[],i=2;n[0]=e[0]/i;for(var s=1;s<t;s++)r[s]=1/i,i=(s<t-1?4:2)-r[s],n[s]=(e[s]-n[s-1])/i;for(var s=1;s<t;s++)n[t-s-1]-=r[t-s]*n[t-s];return n}return{smooth:function(){var t=this._segments,n=t.length,r=n,i;if(n<=2)return;this._closed?(i=Math.min(n,4),r+=Math.min(n,i)*2):i=0;var s=[];for(var o=0;o<n;o++)s[o+i]=t[o]._point;if(this._closed)for(var o=0;o<i;o++)s[o]=t[o+n-i]._point,s[o+n+i]=t[o]._point;else r--;var a=[];for(var o=1;o<r-1;o++)a[o]=4*s[o]._x+2*s[o+1]._x;a[0]=s[0]._x+2*s[1]._x,a[r-1]=3*s[r-1]._x;var f=e(a);for(var o=1;o<r-1;o++)a[o]=4*s[o]._y+2*s[o+1]._y;a[0]=s[0]._y+2*s[1]._y,a[r-1]=3*s[r-1]._y;var l=e(a);if(this._closed){for(var o=0,c=n;o<i;o++,c++){var h=o/i,p=1-h,d=o+i,v=c+i;f[c]=f[o]*h+f[c]*p,l[c]=l[o]*h+l[c]*p,f[v]=f[d]*p+f[v]*h,l[v]=l[d]*p+l[v]*h}r--}var m=null;for(var o=i;o<=r-i;o++){var g=t[o-i];m&&g.setHandleIn(m.subtract(g._point)),o<r&&(g.setHandleOut((new u(f[o],l[o])).subtract(g._point)),o<r-1?m=new u(2*s[o+1]._x-f[o+1],2*s[o+1]._y-l[o+1]):m=new u((s[r]._x+f[r-1])/2,(s[r]._y+l[r-1])/2))}if(this._closed&&m){var g=this._segments[0];g.setHandleIn(m.subtract(g._point))}}}},new function(){function t(e){var t=e._segments;if(t.length==0)throw new Error("Use a moveTo() command first");return t[t.length-1]}return{moveTo:function(){this._segments.length===1&&this.removeSegment(0),this._segments.length||this._add([new N(u.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new N(u.read(arguments))])},cubicCurveTo:function(){var e=u.read(arguments),n=u.read(arguments),r=u.read(arguments),i=t(this);i.setHandleOut(e.subtract(i._point)),this._add([new N(r,n.subtract(r))])},quadraticCurveTo:function(){var e=u.read(arguments),n=u.read(arguments),r=t(this)._point;this.cubicCurveTo(e.add(r.subtract(e).multiply(1/3)),e.add(n.subtract(e).multiply(1/3)),n)},curveTo:function(){var n=u.read(arguments),r=u.read(arguments),i=e.pick(e.read(arguments),.5),s=1-i,o=t(this)._point,a=n.subtract(o.multiply(s*s)).subtract(r.multiply(i*i)).divide(2*i*s);if(a.isNaN())throw new Error("Cannot put a curve through points with parameter = "+i);this.quadraticCurveTo(a,r)},arcTo:function(n,r){var i=t(this),s=i._point,o,a=u.read(arguments),f=e.pick(e.peek(arguments),!0);if(typeof f=="boolean"){n=a,r=f;var l=s.add(n).divide(2),o=l.add(l.subtract(s).rotate(r?-90:90))}else o=a,n=u.read(arguments);var c=new v(s.add(o).divide(2),o.subtract(s).rotate(90),!0),h=new v(o.add(n).divide(2),n.subtract(o).rotate(90),!0),p=c.intersect(h,!0),d=new v(s,n),m=d.getSide(o);if(!p){if(!m)return this.lineTo(n);throw new Error("Cannot put an arc through the given points: "+[s,o,n])}var g=s.subtract(p),y=g.getDirectedAngle(n.subtract(p)),b=d.getSide(p);b==0?y=m*Math.abs(y):m==b&&(y-=360*(y<0?-1:1));var w=Math.abs(y),E=w>=360?4:Math.ceil(w/90),S=y/E,x=S*Math.PI/360,T=4/3*Math.sin(x)/(1+Math.cos(x)),C=[];for(var k=0;k<=E;k++){var L=k<E?p.add(g):n,A=k<E?g.rotate(90).multiply(T):null;k==0?i.setHandleOut(A):C.push(new N(L,g.rotate(-90).multiply(T),A)),g=g.rotate(S)}this._add(C)},lineBy:function(e){e=u.read(arguments);var n=t(this);this.lineTo(n._point.add(e))},curveBy:function(e,n,r){e=u.read(e),n=u.read(n);var i=t(this)._point;this.curveTo(i.add(e),i.add(n),r)},arcBy:function(e,n){e=u.read(e),n=u.read(n);var r=t(this)._point;this.arcTo(r.add(e),r.add(n))},closePath:function(){var e=this.getFirstSegment(),t=this.getLastSegment();e._point.equals(t._point)&&(e.setHandleIn(t._handleIn),t.remove()),this.setClosed(!0)}}},{_getBounds:function(e,t){return O[e](this._segments,this._closed,this.getStyle(),t)},statics:{isClockwise:function(e){function s(e,s){i&&(t+=(n-e)*(s+r)),n=e,r=s,i=!0}var t=0,n,r,i=!1;for(var o=0,u=e.length;o<u;o++){var a=e[o],f=e[o+1<u?o+1:0],l=a._point,c=a._handleOut,h=f._handleIn,p=f._point;s(l._x,l._y),s(l._x+c._x,l._y+c._y),s(p._x+h._x,p._y+h._y),s(p._x,p._y)}return t>0},getBounds:function(e,t,n,r,i){function c(e){e._transformCoordinates(r,o,!1);for(var t=0;t<2;t++)k._addBounds(u[t],u[t+4],o[t+2],o[t],t,i?i[t]:0,a,f,l);var n=u;u=o,o=n}var s=e[0];if(!s)return new h;var o=new Array(6),u=s._transformCoordinates(r,new Array(6),!1),a=u.slice(0,2),f=a.slice(),l=new Array(2);for(var p=1,d=e.length;p<d;p++)c(e[p]);return t&&c(s),new h(a[0],a[1],f[0]-a[0],f[1]-a[1])},getStrokeBounds:function(e,t,n,r){function i(e,t){if(!t)return[e,e];var n=t.shiftless(),r=n.transform(new u(e,0)),i=n.transform(new u(0,e)),s=r.getAngleInRadians(),o=r.getLength(),a=i.getLength(),f=Math.sin(s),l=Math.cos(s),c=Math.tan(s),h=-Math.atan(a*c/o),p=Math.atan(a/(c*o));return[Math.abs(o*Math.cos(h)*l-a*Math.sin(h)*f),Math.abs(a*Math.sin(p)*l+o*Math.cos(p)*f)]}function m(e){l=l.include(r?r._transformPoint(e,e):e)}function g(e,t){t==="round"||!e._handleIn.isZero()&&!e._handleOut.isZero()?l=l.unite(v.setCenter(r?r._transformPoint(e._point):e._point)):O._addSquareJoin(e,t,o,d,m)}function y(e,t){switch(t){case"round":g(e,t);break;case"butt":case"square":O._addSquareCap(e,t,o,m)}}if(!n.getStrokeColor()||!n.getStrokeWidth())return O.getBounds(e,t,n,r);var s=e.length-(t?0:1),o=n.getStrokeWidth()/2,a=i(o,r),l=O.getBounds(e,t,n,r,a),c=n.getStrokeJoin(),p=n.getStrokeCap(),d=o*n.getMiterLimit(),v=new h((new f(a)).multiply(2));for(var b=1;b<s;b++)g(e[b],c);return t?g(e[0],c):(y(e[0],p),y(e[e.length-1],p)),l},_addSquareJoin:function(e,t,n,r,i,s){var o=e.getCurve(),a=o.getPrevious(),f=o.getPointAt(0,!0),l=a.getNormalAt(1,!0),c=o.getNormalAt(0,!0),h=l.getDirectedAngle(c)<0?-n:n;l.setLength(h),c.setLength(h),s&&(i(f),i(f.add(l)));if(t==="miter"){var p=(new v(f.add(l),new u(-l.y,l.x),!0)).intersect(new v(f.add(c),new u(-c.y,c.x),!0),!0);if(p&&f.getDistance(p)<=r){i(p);if(!s)return}}s||i(f.add(l)),i(f.add(c))},_addSquareCap:function(e,t,n,r,i){var s=e._point,o=e.getLocation(),u=o.getNormal().normalize(n);i&&(r(s.subtract(u)),r(s.add(u))),t==="square"&&(s=s.add(u.rotate(o.getParameter()==0?-90:90))),r(s.add(u)),r(s.subtract(u))},getHandleBounds:function(e,t,n,r,i,s){var o=new Array(6),u=Infinity,a=-u,f=u,l=a;i=i/2||0,s=s/2||0;for(var c=0,p=e.length;c<p;c++){var d=e[c];d._transformCoordinates(r,o,!1);for(var v=0;v<6;v+=2){var m=v==0?s:i,g=o[v],y=o[v+1],b=g-m,w=g+m,E=y-m,S=y+m;b<u&&(u=b),w>a&&(a=w),E<f&&(f=E),S>l&&(l=S)}}return new h(u,f,a-u,l-f)},getRoughBounds:function(e,t,n,r){var i=n.getStrokeColor()?n.getStrokeWidth():0,s=i;return i>0&&(n.getStrokeJoin()==="miter"&&(s=i*n.getMiterLimit()),n.getStrokeCap()==="square"&&(s=Math.max(s,i*Math.sqrt(2)))),O.getHandleBounds(e,t,n,r,i,s)}}});O.inject({statics:new function(){function t(t){return new O(e.getNamed(t))}function n(){var e=h.readNamed(arguments,"rectangle"),n=f.readNamed(arguments,"radius",0,0,{readNull:!0}),i=e.getBottomLeft(!0),s=e.getTopLeft(!0),o=e.getTopRight(!0),u=e.getBottomRight(!0),a=t(arguments);if(!n||n.isZero())a._add([new N(i),new N(s),new N(o),new N(u)]);else{n=f.min(n,e.getSize(!0).divide(2));var l=n.multiply(r*2);a._add([new N(i.add(n.width,0),null,[-l.width,0]),new N(i.subtract(0,n.height),[0,l.height],null),new N(s.add(0,n.height),null,[0,-l.height]),new N(s.add(n.width,0),[-l.width,0],null),new N(o.subtract(n.width,0),null,[l.width,0]),new N(o.add(0,n.height),[0,-l.height],null),new N(u.subtract(0,n.height),null,[0,l.height]),new N(u.subtract(n.width,0),[l.width,0],null)])}return a._closed=!0,a}function s(){var e=h.readNamed(arguments,"rectangle"),n=t(arguments),r=e.getPoint(!0),s=e.getSize(!0),o=new Array(4);for(var u=0;u<4;u++){var a=i[u];o[u]=new N(a._point.multiply(s).add(r),a._handleIn.multiply(s),a._handleOut.multiply(s))}return n._add(o),n._closed=!0,n}var r=o.KAPPA/2,i=[new N([0,.5],[0,r],[0,-r]),new N([.5,0],[-r,0],[r,0]),new N([1,.5],[0,-r],[0,r]),new N([.5,1],[r,0],[-r,0])];return{Line:function(){return(new O(u.readNamed(arguments,"from"),u.readNamed(arguments,"to"))).set(e.getNamed(arguments))},Circle:function(){var t=u.readNamed(arguments,"center"),n=e.readNamed(arguments,"radius");return s(new h(t.subtract(n),new f(n*2,n*2))).set(e.getNamed(arguments))},Rectangle:n,RoundRectangle:n,Ellipse:s,Oval:s,Arc:function(){var e=u.readNamed(arguments,"from"),n=u.readNamed(arguments,"through"),r=u.readNamed(arguments,"to"),i=t(arguments);return i.moveTo(e),i.arcTo(n,r),i},RegularPolygon:function(){var n=u.readNamed(arguments,"center"),r=e.readNamed(arguments,"sides"),i=e.readNamed(arguments,"radius"),s=t(arguments),o=360/r,a=!(r%3),f=new u(0,a?-i:i),l=a?-1:.5,c=new Array(r);for(var h=0;h<r;h++)c[h]=new N(n.add(f.rotate((h+l)*o)));return s._add(c),s._closed=!0,s},Star:function(){var n=u.readNamed(arguments,"center"),r=e.readNamed(arguments,"points")*2,i=e.readNamed(arguments,"radius1"),s=e.readNamed(arguments,"radius2"),o=t(arguments),a=360/r,f=new u(0,-1),l=new Array(r);for(var c=0;c<r;c++)l[c]=new N(n.add(f.rotate(a*c).multiply(c%2?s:i)));return o._add(l),o._closed=!0,o}}}});var M=A.extend({_class:"CompoundPath",_serializeFields:{children:[]},initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||this.addChildren(Array.isArray(t)?t:arguments)},insertChildren:function bt(e,t,n){t=bt.base.call(this,e,t,n,"path");for(var r=0,i=!n&&t&&t.length;r<i;r++){var s=t[r];s._clockwise===undefined&&s.setClockwise(s._index===0)}return t},reduce:function(){if(this._children.length==1){var e=this._children[0];return e.insertAbove(this),this.remove(),e}return this},reverse:function(){var e=this._children;for(var t=0,n=e.length;t<n;t++)e[t].reverse()},smooth:function(){for(var e=0,t=this._children.length;e<t;e++)this._children[e].smooth()},isClockwise:function(){var e=this.getFirstChild();return e&&e.isClockwise()},setClockwise:function(e){this.isClockwise()!=!!e&&this.reverse()},getFirstSegment:function(){var e=this.getFirstChild();return e&&e.getFirstSegment()},getLastSegment:function(){var e=this.getLastChild();return e&&e.getLastSegment()},getCurves:function(){var e=this._children,t=[];for(var n=0,r=e.length;n<r;n++)t=t.concat(e[n].getCurves());return t},getFirstCurve:function(){var e=this.getFirstChild();return e&&e.getFirstCurve()},getLastCurve:function(){var e=this.getLastChild();return e&&e.getFirstCurve()},getArea:function(){var e=this._children,t=0;for(var n=0,r=e.length;n<r;n++)t+=e[n].getArea();return t},getPathData:function(){var e=this._children,t=[];for(var n=0,r=e.length;n<r;n++)t.push(e[n].getPathData(arguments[0]));return t.join(" ")},_contains:function(e){var t=[];for(var n=0,r=this._children.length;n<r;n++){var i=this._children[n];i.contains(e)&&t.push(i)}return(t.length&1)==1&&t},_hitTest:function wt(t,n){var r=wt.base.call(this,t,e.merge(n,{fill:!1}));return!r&&n.fill&&this.hasFill()&&(r=this._contains(t),r=r?new T("fill",r[0]):null),r},_draw:function(e,t){var n=this._children,r=this._style;if(n.length===0)return;e.beginPath(),t=t.extend({compound:!0});for(var i=0,s=n.length;i<s;i++)n[i].draw(e,t);t.clip||(this._setStyles(e),r.getFillColor()&&e.fill(),r.getStrokeColor()&&e.stroke())}},new function(){function t(e){if(!e._children.length)throw new Error("Use a moveTo() command first");return e._children[e._children.length-1]}var n={moveTo:function(){var e=new O;this.addChild(e),e.moveTo.apply(e,arguments)},moveBy:function(){this.moveTo(t(this).getLastSegment()._point.add(u.read(arguments)))},closePath:function(){t(this).closePath()}};return e.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","curveBy","arcBy"],function(e){n[e]=function(){var n=t(this);n[e].apply(n,arguments)}}),n}),_=e.extend({initialize:function(e){function s(e,t){var n=k.getValues(e,t);i.curves.push(n),i._computeParts(n,e._index,0,1)}this.curves=[],this.parts=[],this.length=0,this.index=0;var t=e._segments,n=t[0],r,i=this;for(var o=1,u=t.length;o<u;o++)r=t[o],s(n,r),n=r;e._closed&&s(r,t[0])},_computeParts:function(e,t,n,r){if(r-n>1/32&&!k.isFlatEnough(e,.25)){var i=k.subdivide(e),s=(n+r)/2;this._computeParts(i[0],t,n,s),this._computeParts(i[1],t,s,r)}else{var o=e[6]-e[0],u=e[7]-e[1],a=Math.sqrt(o*o+u*u);a>1e-5&&(this.length+=a,this.parts.push({offset:this.length,value:r,index:t}))}},getParameterAt:function(e){var t,n=this.index;for(;;){t=n;if(n==0||this.parts[--n].offset<e)break}for(var r=this.parts.length;t<r;t++){var i=this.parts[t];if(i.offset>=e){this.index=t;var s=this.parts[t-1],o=s&&s.index==i.index?s.value:0,u=s?s.offset:0;return{value:o+(i.value-o)*(e-u)/(i.offset-u),index:i.index}}}var i=this.parts[this.parts.length-1];return{value:1,index:i.index}},evaluate:function(e,t){var n=this.getParameterAt(e);return k.evaluate(this.curves[n.index],n.value,t)},drawPart:function(e,t,n){t=this.getParameterAt(t),n=this.getParameterAt(n);for(var r=t.index;r<=n.index;r++){var i=k.getPart(this.curves[r],r==t.index?t.value:0,r==n.index?n.value:1);r==t.index&&e.moveTo(i[0],i[1]),e.bezierCurveTo.apply(e,i.slice(2))}}}),D=e.extend({initialize:function(e,t){this.points=[];var n=e._segments,r;for(var i=0,s=n.length;i<s;i++){var o=n[i].point.clone();if(!r||!r.equals(o))this.points.push(o),r=o}this.error=t},fit:function(){var e=this.points,t=e.length;return this.segments=t>0?[new N(e[0])]:[],t>1&&this.fitCubic(0,t-1,e[1].subtract(e[0]).normalize(),e[t-2].subtract(e[t-1]).normalize()),this.segments},fitCubic:function(e,t,n,r){if(t-e==1){var i=this.points[e],s=this.points[t],o=i.getDistance(s)/3;this.addCurve([i,i.add(n.normalize(o)),s.add(r.normalize(o)),s]);return}var u=this.chordLengthParameterize(e,t),a=Math.max(this.error,this.error*this.error),f;for(var l=0;l<=4;l++){var c=this.generateBezier(e,t,u,n,r),h=this.findMaxError(e,t,c,u);if(h.error<this.error){this.addCurve(c);return}f=h.index;if(h.error>=a)break;this.reparameterize(e,t,u,c),a=h.error}var p=this.points[f-1].subtract(this.points[f]),d=this.points[f].subtract(this.points[f+1]),v=p.add(d).divide(2).normalize();this.fitCubic(e,f,n,v),this.fitCubic(f,t,v.negate(),r)},addCurve:function(e){var t=this.segments[this.segments.length-1];t.setHandleOut(e[1].subtract(e[0])),this.segments.push(new N(e[3],e[2].subtract(e[3])))},generateBezier:function(e,t,n,r,i){var s=1e-11,o=this.points[e],u=this.points[t],a=[[0,0],[0,0]],f=[0,0];for(var l=0,c=t-e+1;l<c;l++){var h=n[l],p=1-h,d=3*h*p,v=p*p*p,m=d*p,g=d*h,y=h*h*h,b=r.normalize(m),w=i.normalize(g),E=this.points[e+l].subtract(o.multiply(v+m)).subtract(u.multiply(g+y));a[0][0]+=b.dot(b),a[0][1]+=b.dot(w),a[1][0]=a[0][1],a[1][1]+=w.dot(w),f[0]+=b.dot(E),f[1]+=w.dot(E)}var S=a[0][0]*a[1][1]-a[1][0]*a[0][1],x,T;if(Math.abs(S)>s){var N=a[0][0]*f[1]-a[1][0]*f[0],C=f[0]*a[1][1]-f[1]*a[0][1];x=C/S,T=N/S}else{var k=a[0][0]+a[0][1],L=a[1][0]+a[1][1];Math.abs(k)>s?x=T=f[0]/k:Math.abs(L)>s?x=T=f[1]/L:x=T=0}var A=u.getDistance(o);s*=A;if(x<s||T<s)x=T=A/3;return[o,o.add(r.normalize(x)),u.add(i.normalize(T)),u]},reparameterize:function(e,t,n,r){for(var i=e;i<=t;i++)n[i-e]=this.findRoot(r,this.points[i],n[i-e])},findRoot:function(e,t,n){var r=[],i=[];for(var s=0;s<=2;s++)r[s]=e[s+1].subtract(e[s]).multiply(3);for(var s=0;s<=1;s++)i[s]=r[s+1].subtract(r[s]).multiply(2);var o=this.evaluate(3,e,n),u=this.evaluate(2,r,n),a=this.evaluate(1,i,n),f=o.subtract(t),l=u.dot(u)+f.dot(a);return Math.abs(l)<1e-5?n:n-f.dot(u)/l},evaluate:function(e,t,n){var r=t.slice();for(var i=1;i<=e;i++)for(var s=0;s<=e-i;s++)r[s]=r[s].multiply(1-n).add(r[s+1].multiply(n));return r[0]},chordLengthParameterize:function(e,t){var n=[0];for(var r=e+1;r<=t;r++)n[r-e]=n[r-e-1]+this.points[r].getDistance(this.points[r-1]);for(var r=1,i=t-e;r<=i;r++)n[r]/=n[i];return n},findMaxError:function(e,t,n,r){var i=Math.floor((t-e+1)/2),s=0;for(var o=e+1;o<t;o++){var u=this.evaluate(3,n,r[o-e]),a=u.subtract(this.points[o]),f=a.x*a.x+a.y*a.y;f>=s&&(s=f,i=o)}return{error:s,index:i}}});A.inject(new function(){function e(e,t){e.sort(function(e,t){var n=e.getPath(),r=t.getPath();return n===r?e.getIndex()+e.getParameter()-(t.getIndex()+t.getParameter()):n._id-r._id});var n=t&&[];for(var r=e.length-1;r>=0;r--){var i=e[r],s=i.getIntersection(),o=i.divide(),u=o&&o.getSegment1()||i.getSegment();n&&n.push(s),u._intersection=s}return n}function t(e){if(e instanceof M){var t=e._children,n=t.length,r=new Array(n),i=new Array(n),s=t[0].isClockwise();for(var o=0;o<n;o++)r[o]=t[o].getBounds(),i[o]=0;for(var o=0;o<n;o++){for(var u=1;u<n;u++)o!==u&&r[o].contains(r[u])&&i[u]++;o>0&&i[o]%2===0&&t[o].setClockwise(s)}}return e}function n(n,i,s,o){n=t(n.clone(!1)),i=t(i.clone(!1));var a=n.isClockwise(),f=i.isClockwise(),l=n.getIntersections(i);e(e(l,!0)),o&&(i.reverse(),f=!f);var c=[].concat(n._children||[n]).concat(i._children||[i]),h=[],p=new M;for(var d=0,v=c.length;d<v;d++){var m=c[d],g=m._parent,y=m.isClockwise(),b=m._segments;m=g instanceof M?g:m;for(var w=b.length-1;w>=0;w--){var E=b[w],S=E.getCurve().getPoint(.5),x=m!==n&&n.contains(S)&&(y===a||o||!r(n,S)),T=m!==i&&i.contains(S)&&(y===f||!r(i,S));s(m===n,x,T)?E._invalid=!0:h.push(E)}}for(var d=0,v=h.length;d<v;d++){var E=h[d];if(E._visited)continue;var m=new O,C=E._intersection,k=C&&C.getSegment(!0);E.getPrevious()._invalid&&E.setHandleIn(k?k._handleIn:new u(0,0));do{E._visited=!0;if(E._invalid&&E._intersection){var L=E._intersection.getSegment(!0);m.add(new N(E._point,E._handleIn,L._handleOut)),L._visited=!0,E=L}else m.add(E.clone());E=E.getNext()}while(E&&!E._visited&&E!==k);var A=m._segments.length;A>1&&(A>2||!m.isPolygon())?(m.setClosed(!0),p.addChild(m,!0)):m.remove()}return n.remove(),i.remove(),p.reduce()}function r(e,t){var n=e.getCurves(),r=e.getBounds();if(r.contains(t))for(var i=0,s=n.length;i<s;i++){var o=n[i];if(o.getBounds().contains(t)&&o.getParameterOf(t))return!0}return!1}return{unite:function(e){return n(this,e,function(e,t,n){return t||n})},intersect:function(e){return n(this,e,function(e,t,n){return!t&&!n})},subtract:function(e){return n(this,e,function(e,t,n){return e&&n||!e&&!t},!0)},exclude:function(e){return new b([this.subtract(e),e.subtract(this)])},divide:function(e){return new b([this.subtract(e),this.intersect(e)])}}});var P=y.extend({_class:"TextItem",_boundsSelected:!0,_serializeFields:{content:null},_boundsGetter:"getBounds",initialize:function(n){this._content="",this._lines=[];var r=n&&e.isPlainObject(n)&&n.x===undefined&&n.y===undefined;this._initialize(r&&n,!r&&u.read(arguments))},_clone:function Et(e){return e.setContent(this._content),Et.base.call(this,e)},getContent:function(){return this._content},setContent:function(e){this._content=""+e,this._lines=this._content.split(/\r\n|\n|\r/mg),this._changed(69)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),H=P.extend({_class:"PointText",initialize:function(){P.apply(this,arguments)},clone:function(e){return this._clone(new H({insert:!1}),e)},getPoint:function(){var e=this._matrix.getTranslation();return new a(e.x,e.y,this,"setPoint")},setPoint:function(e){e=u.read(arguments),this.translate(e.subtract(this._matrix.getTranslation()))},_draw:function(e){if(!this._content)return;this._setStyles(e);var t=this._style,n=this._lines,r=t.getLeading();e.font=t.getFontStyle(),e.textAlign=t.getJustification();for(var i=0,s=n.length;i<s;i++){var o=n[i];t.getFillColor()&&e.fillText(o,0,0),t.getStrokeColor()&&e.strokeText(o,0,0),e.translate(0,r)}}},new function(){var e=null;return{_getBounds:function(t,n){e||(e=G.getContext(1,1));var r=this._style,i=this._lines,s=i.length,o=r.getJustification(),u=r.getLeading(),a=0;e.font=r.getFontStyle();var f=0;for(var l=0;l<s;l++)f=Math.max(f,e.measureText(i[l]).width);o!=="left"&&(a-=f/(o==="center"?2:1));var c=new h(a,s?-0.75*u:0,f,s*u);return n?n._transformBounds(c,c):c}}}),B=e.extend(new function(){function o(e){var t=r[e];if(!t){i||(i=G.getContext(1,1),i.globalCompositeOperation="copy"),i.fillStyle="rgba(0,0,0,0)",i.fillStyle=e,i.fillRect(0,0,1,1);var n=i.getImageData(0,0,1,1).data;t=r[e]=[n[0]/255,n[1]/255,n[2]/255]}return t.slice()}function a(e){var t=e.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);if(t.length>=4){var n=[0,0,0];for(var r=0;r<3;r++){var i=t[r+1];n[r]=parseInt(i.length==1?i+i:i,16)/255}return n}}var t={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},n={},r={},i,f=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],l={"rgb-hsb":function(e,t,n){var r=Math.max(e,t,n),i=Math.min(e,t,n),s=r-i,o=s===0?0:(r==e?(t-n)/s+(t<n?6:0):r==t?(n-e)/s+2:(e-t)/s+4)*60;return[o,r===0?0:s/r,r]},"hsb-rgb":function(e,t,n){var e=e/60%6,r=Math.floor(e),i=e-r,r=f[r],s=[n,n*(1-t),n*(1-t*i),n*(1-t*(1-i))];return[s[r[0]],s[r[1]],s[r[2]]]},"rgb-hsl":function(e,t,n){var r=Math.max(e,t,n),i=Math.min(e,t,n),s=r-i,o=s===0,u=o?0:(r==e?(t-n)/s+(t<n?6:0):r==t?(n-e)/s+2:(e-t)/s+4)*60,a=(r+i)/2,f=o?0:a<.5?s/(r+i):s/(2-r-i);return[u,f,a]},"hsl-rgb":function(e,t,n){e/=360;if(t===0)return[n,n,n];var r=[e+1/3,e,e-1/3],i=n<.5?n*(1+t):n+t-n*t,s=2*n-i,o=[];for(var u=0;u<3;u++){var a=r[u];a<0&&(a+=1),a>1&&(a-=1),o[u]=6*a<1?s+(i-s)*6*a:2*a<1?i:3*a<2?s+(i-s)*(2/3-a)*6:s}return o},"rgb-gray":function(e,t,n){return[e*.2989+t*.587+n*.114]},"gray-rgb":function(e){return[e,e,e]},"gray-hsb":function(e){return[0,0,e]},"gray-hsl":function(e){return[0,0,e]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return e.each(t,function(r,i){n[i]=[],e.each(r,function(r,s){var o=e.capitalize(r),a=/^(hue|saturation)$/.test(r),f=n[i][s]=r==="gradient"?function(e){var t=this._components[0];return e=j.read(Array.isArray(e)?e:arguments,0,0,{readNull:!0}),t!==e&&(t&&t._removeOwner(this),e&&e._addOwner(this)),e}:r==="hue"?function(e){return isNaN(e)?0:(e%360+360)%360}:i==="gradient"?function(){return u.read(arguments,0,0,{readNull:r==="highlight",clone:!0})}:function(e){return isNaN(e)?0:Math.min(Math.max(e,0),1)};this["get"+o]=function(){return this._type===i||a&&/^hs[bl]$/.test(this._type)?this._components[s]:this._convert(i)[s]},this["set"+o]=function(e){this._type!==i&&(!a||!/^hs[bl]$/.test(this._type))&&(this._components=this._convert(i),this._properties=t[i],this._type=i),e=f.call(this,e),e!=null&&(this._components[s]=e,this._changed())}},this)},{_class:"Color",_readIndex:!0,initialize:function c(e){var r=Array.prototype.slice,i=arguments,s=0,u=!0,f,l,h,p;Array.isArray(e)&&(i=e,e=i[0]);var d=e!=null&&typeof e;d==="string"&&e in t&&(f=e,e=i[1],Array.isArray(e)?(l=e,h=i[2]):(this.__read&&(s=1),i=r.call(i,1),d=typeof e));if(!l){u=!this.__options||!this.__options.dontParse,p=d==="number"?i:d==="object"&&e.length!=null?e:null;if(p){f||(f=p.length>=3?"rgb":"gray");var v=t[f].length;h=p[v],this.__read&&(s+=p===arguments?v+(h!=null?1:0):1),p.length>v&&(p=r.call(p,0,v))}else if(d==="string")l=e.match(/^#[0-9a-f]{3,6}$/i)?a(e):o(e),f="rgb";else if(d==="object")if(e.constructor===c){f=e._type,l=e._components.slice(),h=e._alpha;if(f==="gradient")for(var m=1,g=l.length;m<g;m++){var y=l[m];y&&(l[m]=y.clone())}}else if(e.constructor===j)f="gradient",p=i;else{f="hue"in e?"lightness"in e?"hsl":"hsb":"gradient"in e||"stops"in e||"radial"in e?"gradient":"gray"in e?"gray":"rgb";var b=t[f];E=u&&n[f],this._components=l=[];for(var m=0,g=b.length;m<g;m++){var w=e[b[m]];w==null&&m===0&&f==="gradient"&&"stops"in e&&(w={stops:e.stops,radial:e.radial}),u&&(w=E[m].call(this,w)),w!=null&&(l[m]=w)}h=e.alpha}this.__read&&f&&(s=1)}this._type=f||"rgb",f==="gradient"&&(this._id=c._id=(c._id||0)+1);if(!l){this._components=l=[];var E=n[this._type];for(var m=0,g=E.length;m<g;m++){var w=p&&p[m];u&&(w=E[m].call(this,w)),w!=null&&(l[m]=w)}}this._components=l,this._properties=t[this._type],this._alpha=h,this.__read&&(this.__read=s)},_serialize:function(t,n){var r=this.getComponents();return e.serialize(/^(gray|rgb)$/.test(this._type)?r:[this._type].concat(r),t,!0,n)},_changed:function(){this._canvasStyle=null,this._owner&&this._owner._changed(17)},clone:function(){return new B(this._type,this._components.slice(),this._alpha)},_convert:function(e){var t;return this._type===e?this._components.slice():(t=l[this._type+"-"+e])?t.apply(this,this._components):l["rgb-"+e].apply(this,l[this._type+"-rgb"].apply(this,this._components))},convert:function(e){return new B(e,this._convert(e),this._alpha)},getType:function(){return this._type},setType:function(e){this._components=this._convert(e),this._properties=t[e],this._type=e},getComponents:function(){var e=this._components.slice();return this._alpha!=null&&e.push(this._alpha),e},getAlpha:function(){return this._alpha!=null?this._alpha:1},setAlpha:function(e){this._alpha=e==null?null:Math.min(Math.max(e,0),1),this._changed()},hasAlpha:function(){return this._alpha!=null},equals:function(t){return e.isPlainValue(t)&&(t=B.read(arguments)),t===this||t&&this._type===t._type&&this._alpha===t._alpha&&e.equals(this._components,t._components)||!1},toString:function(){var e=this._properties,t=[],n=this._type==="gradient",r=s.instance;for(var i=0,o=e.length;i<o;i++){var u=this._components[i];u!=null&&t.push(e[i]+": "+(n?u:r.number(u)))}return this._alpha!=null&&t.push("alpha: "+r.number(this._alpha)),"{ "+t.join(", ")+" }"},toCSS:function(e){var t=this._convert("rgb"),n=e||this._alpha==null?1:this._alpha;return t=[Math.round(t[0]*255),Math.round(t[1]*255),Math.round(t[2]*255)],n<1&&t.push(n),(t.length==4?"rgba(":"rgb(")+t.join(",")+")"},toCanvasStyle:function(e){if(this._canvasStyle)return this._canvasStyle;if(this._type!=="gradient")return this._canvasStyle=this.toCSS();var t=this._components,n=t[0],r=n._stops,i=t[1],s=t[2],o;if(n._radial){var u=s.getDistance(i),a=t[3];if(a){var f=a.subtract(i);f.getLength()>u&&(a=i.add(f.normalize(u-.1)))}var l=a||i;o=e.createRadialGradient(l.x,l.y,0,i.x,i.y,u)}else o=e.createLinearGradient(i.x,i.y,s.x,s.y);for(var c=0,h=r.length;c<h;c++){var p=r[c];o.addColorStop(p._rampPoint,p._color.toCanvasStyle())}return this._canvasStyle=o},transform:function(e){if(this._type==="gradient"){var t=this._components;for(var n=1,r=t.length;n<r;n++){var i=t[n];e._transformPoint(i,i,!0)}this._changed()}},statics:{_types:t,random:function(){var e=Math.random;return new B(e(),e(),e())}}})},new function(){function t(e,t){return e<0?0:t&&e>360?360:!t&&e>1?1:e}var n={add:function(e,n,r){return t(e+n,r)},subtract:function(e,n,r){return t(e-n,r)},multiply:function(e,n,r){return t(e*n,r)},divide:function(e,n,r){return t(e/n,r)}};return e.each(n,function(e,t){var n={dontParse:/^(multiply|divide)$/.test(t)};this[t]=function(t){t=B.read(arguments,0,0,n);var r=this._type,i=this._properties,s=this._components,o=t._convert(r);for(var u=0,a=s.length;u<a;u++)o[u]=e(s[u],o[u],i[u]==="hue");return new B(r,o,this._alpha!=null?e(this._alpha,t.getAlpha()):null)}},{})});e.each(B._types,function(t,n){var r=this[e.capitalize(n)+"Color"]=function(e){var t=e!=null&&typeof e,r=t==="object"&&e.length!=null?e:t==="string"?null:arguments;return r?new B(n,r):new B(e)};if(n.length==3){var i=n.toUpperCase();B[i]=this[i+"Color"]=r}},e.exports);var j=e.extend({_class:"Gradient",initialize:function St(e,t){this._id=St._id=(St._id||0)+1,e&&this._set(e)&&(e=t=null),this._stops||this.setStops(e||["white","black"]),this._radial==null&&this.setRadial(typeof t=="string"&&t==="radial"||t||!1)},_serialize:function(t,n){return n.add(this,function(){return e.serialize([this._stops,this._radial],t,!0,n)})},_changed:function(){for(var e=0,t=this._owners&&this._owners.length;e<t;e++)this._owners[e]._changed()},_addOwner:function(e){this._owners||(this._owners=[]),this._owners.push(e)},_removeOwner:function(e){var t=this._owners?this._owners.indexOf(e):-1;t!=-1&&(this._owners.splice(t,1),this._owners.length===0&&delete this._owners)},clone:function(){var e=[];for(var t=0,n=this._stops.length;t<n;t++)e[t]=this._stops[t].clone();return new this.constructor(e)},getStops:function(){return this._stops},setStops:function(e){if(this.stops)for(var t=0,n=this._stops.length;t<n;t++)delete this._stops[t]._owner;if(e.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");this._stops=F.readAll(e,0,!1,!0);for(var t=0,n=this._stops.length;t<n;t++){var r=this._stops[t];r._owner=this,r._defaultRamp&&r.setRampPoint(t/(n-1))}this._changed()},getRadial:function(){return this._radial},setRadial:function(e){this._radial=e,this._changed()},equals:function(e){if(e&&e.constructor==this.constructor&&this._stops.length==e._stops.length){for(var t=0,n=this._stops.length;t<n;t++)if(!this._stops[t].equals(e._stops[t]))return!1;return!0}return!1}}),F=e.extend({_class:"GradientStop",initialize:function(t,n){if(t){var r,i;n===undefined&&Array.isArray(t)?(r=t[0],i=t[1]):t.color?(r=t.color,i=t.rampPoint):(r=t,i=n),this.setColor(r),this.setRampPoint(i)}},clone:function(){return new F(this._color.clone(),this._rampPoint)},_serialize:function(t,n){return e.serialize([this._color,this._rampPoint],t,!0,n)},_changed:function(){this._owner&&this._owner._changed(17)},getRampPoint:function(){return this._rampPoint},setRampPoint:function(e){this._defaultRamp=e==null,this._rampPoint=e||0,this._changed()},getColor:function(){return this._color},setColor:function(e){this._color=B.read(arguments),this._color===e&&(this._color=e.clone()),this._color._owner=this,this._changed()},equals:function(e){return e===this||e instanceof F&&this._color.equals(e._color)&&this._rampPoint==e._rampPoint||!1}}),I=e.extend(new function(){var t={fillColor:undefined,strokeColor:undefined,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",miterLimit:10,dashOffset:0,dashArray:[],shadowColor:undefined,shadowBlur:0,shadowOffset:new u,selectedColor:undefined,font:"sans-serif",fontSize:12,leading:null,justification:"left"},n={strokeWidth:25,strokeCap:25,strokeJoin:25,miterLimit:25,font:5,fontSize:5,leading:5,justification:5},r={},i={_defaults:t,_textDefaults:e.merge(t,{fillColor:new B})};return e.each(t,function(t,s){var o=/Color$/.test(s),u=e.capitalize(s),a=n[s],f="set"+u,l="get"+u;i[f]=function(e){var t=this._item&&this._item._children;if(t&&t.length>0&&this._item._type!=="compound-path")for(var n=0,r=t.length;n<r;n++)t[n]._style[f](e);else{var i=this._values[s];i!=e&&(o&&(i&&delete i._owner,e&&e.constructor===B&&(e._owner=this._item)),this._values[s]=e,this._item&&this._item._changed(a||17))}},i[l]=function(){var t,n=this._item&&this._item._children;if(!n||n.length===0||arguments[0]||this._item._type==="compound-path"){var t=this._values[s];return t===undefined?(t=this._defaults[s],t&&t.clone&&(t=t.clone()),this._values[s]=t):o&&(!t||t.constructor!==B)&&(this._values[s]=t=B.read([t],0,0,{readNull:!0,clone:!0}),t&&(t._owner=this._item)),t}for(var r=0,i=n.length;r<i;r++){var u=n[r]._style[l]();if(r===0)t=u;else if(!e.equals(t,u))return undefined}return t},r[l]=function(){return this._style[l]()},r[f]=function(e){this._style[f](e)}}),y.inject(r),i},{_class:"Style",initialize:function(t,n){this._values={},this._item=n,n instanceof P&&(this._defaults=this._textDefaults),t&&this.set(t)},set:function(e){var t=e instanceof I,n=t?e._values:e;if(n)for(var r in n)if(r in this._defaults){var i=n[r];this[r]=i&&t&&i.clone?i.clone():i}},getLeading:function xt(){var e=xt.base.call(this);return e!=null?e:this.getFontSize()*1.2},getFontStyle:function(){var e=this.getFontSize();return(/[a-z]/i.test(e)?e+" ":e+"px ")+this.getFont()}}),q=new function(){function i(t,n){var r=[];for(var s=0,o=t&&t.length;s<o;){var u=t[s++];if(typeof u=="string")u=document.createElement(u);else if(!u||!u.nodeType)continue;e.isPlainObject(t[s])&&q.set(u,t[s++]),Array.isArray(t[s])&&i(t[s++],u),n&&n.appendChild(u),r.push(u)}return r}var t=/^(checked|value|selected|disabled)$/i,n={text:"textContent",html:"innerHTML"},r={lineHeight:1,zoom:1,zIndex:1,opacity:1};return{create:function(e,t){var n=Array.isArray(e),r=i(n?e:arguments,n?t:null);return r.length==1?r[0]:r},find:function(e,t){return(t||document).querySelector(e)},findAll:function(e,t){return(t||document).querySelectorAll(e)},get:function(e,r){return e?t.test(r)?r==="value"||typeof e[r]!="string"?e[r]:!0:r in n?e[n[r]]:e.getAttribute(r):null},set:function(e,r,i){if(typeof r!="string")for(var s in r)r.hasOwnProperty(s)&&this.set(e,s,r[s]);else{if(!e||i===undefined)return e;t.test(r)?e[r]=i:r in n?e[n[r]]=i:r==="style"?this.setStyle(e,i):r==="events"?R.add(e,i):e.setAttribute(r,i)}return e},getStyles:function(e){var t=e&&e.ownerDocument.defaultView;return t&&t.getComputedStyle(e,"")},getStyle:function(e,t){return e&&e.style[t]||this.getStyles(e)[t]||null},setStyle:function(e,t,n){if(typeof t!="string")for(var i in t)t.hasOwnProperty(i)&&this.setStyle(e,i,t[i]);else/^-?[\d\.]+$/.test(n)&&!(t in r)&&(n+="px"),e.style[t]=n;return e},hasClass:function(e,t){return(new RegExp("\\s*"+t+"\\s*")).test(e.className)},addClass:function(e,t){e.className=(e.className+" "+t).trim()},removeClass:function(e,t){e.className=e.className.replace(new RegExp("\\s*"+t+"\\s*")," ").trim()},remove:function(e){e.parentNode&&e.parentNode.removeChild(e)},removeChildren:function(e){while(e.firstChild)e.removeChild(e.firstChild)},getBounds:function(e,t){var n=e.ownerDocument,r=n.body,i=n.documentElement,s;try{s=e.getBoundingClientRect()}catch(o){s={left:0,top:0,width:0,height:0}}var u=s.left-(i.clientLeft||r.clientLeft||0),a=s.top-(i.clientTop||r.clientTop||0);if(!t){var f=n.defaultView;u+=f.pageXOffset||i.scrollLeft||r.scrollLeft,a+=f.pageYOffset||i.scrollTop||r.scrollTop}return new h(u,a,s.width,s.height)},getViewportBounds:function(e){var t=e.ownerDocument,n=t.defaultView,r=t.documentElement;return new h(0,0,n.innerWidth||r.clientWidth,n.innerHeight||r.clientHeight)},getOffset:function(e,t){return this.getBounds(e,t).getPoint()},getSize:function(e){return this.getBounds(e,!0).getSize()},isInvisible:function(e){return this.getSize(e).equals(new f(0,0))},isInView:function(e){return!this.isInvisible(e)&&this.getViewportBounds(e).intersects(this.getBounds(e,!0))}}},R={add:function(e,t){for(var n in t){var r=t[n];e.addEventListener?e.addEventListener(n,r,!1):e.attachEvent&&e.attachEvent("on"+n,r.bound=function(){r.call(e,window.event)})}},remove:function(e,t){for(var n in t){var r=t[n];e.removeEventListener?e.removeEventListener(n,r,!1):e.detachEvent&&e.detachEvent("on"+n,r.bound)}},getPoint:function(e){var t=e.targetTouches?e.targetTouches.length?e.targetTouches[0]:e.changedTouches[0]:e;return new u(t.pageX||t.clientX+document.documentElement.scrollLeft,t.pageY||t.clientY+document.documentElement.scrollTop)},getTarget:function(e){return e.target||e.srcElement},getOffset:function(e,t){return R.getPoint(e).subtract(q.getOffset(t||R.getTarget(e)))},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},stop:function(e){R.stopPropagation(e),R.preventDefault(e)}};R.requestAnimationFrame=new function(){var e="equestAnimationFrame",t=window["r"+e]||window["webkitR"+e]||window["mozR"+e]||window["oR"+e]||window["msR"+e];t&&t(function(e){e==null&&(t=null)});var r=[],i=!0,s;return R.add(window,{focus:function(){i=!0},blur:function(){i=!1}}),function(e,o){if(t)return t(e,o);r.push([e,o]);if(s)return;s=setInterval(function(){for(var e=r.length-1;e>=0;e--){var t=r[e],s=t[0],o=t[1];if(!o||(n.getAttribute(o,"keepalive")=="true"||i)&&q.isInView(o))r.splice(e,1),s(Date.now())}},1e3/60)}};var U=e.extend(t,{_class:"View",initialize:function Tt(e){this._scope=paper,this._project=paper.project,this._element=e;var t;this._id=e.getAttribute("id"),this._id==null&&e.setAttribute("id",this._id="view-"+Tt._id++),R.add(e,this._viewHandlers);if(n.hasAttribute(e,"resize")){var r=q.getOffset(e,!0),i=this;t=q.getViewportBounds(e).getSize().subtract(r),this._windowHandlers={resize:function(){q.isInvisible(e)||(r=q.getOffset(e,!0)),i.setViewSize(q.getViewportBounds(e).getSize().subtract(r))}},R.add(window,this._windowHandlers)}else t=new f(parseInt(e.getAttribute("width"),10),parseInt(e.getAttribute("height"),10)),t.isNaN()&&(t=q.getSize(e));e.width=t.width,e.height=t.height;if(n.hasAttribute(e,"stats")&&typeof Stats!="undefined"){this._stats=new Stats;var s=this._stats.domElement,o=s.style,r=q.getOffset(e);o.position="absolute",o.left=r.x+"px",o.top=r.y+"px",document.body.appendChild(s)}Tt._views.push(this),Tt._viewsById[this._id]=this,this._viewSize=new c(t.width,t.height,this,"setViewSize"),this._matrix=new d,this._zoom=1,Tt._focused||(Tt._focused=this),this._frameItems={},this._frameItemCount=0},remove:function(){return this._project?(U._focused==this&&(U._focused=null),U._views.splice(U._views.indexOf(this),1),delete U._viewsById[this._id],this._project.view==this&&(this._project.view=null),R.remove(this._element,this._viewHandlers),R.remove(window,this._windowHandlers),this._element=this._project=null,this.detach("frame"),this._frameItems={},!0):!1},_events:{onFrame:{install:function(){this._requested||(this._animate=!0,this._requestFrame())},uninstall:function(){this._animate=!1}},onResize:{}},_animate:!1,_time:0,_count:0,_requestFrame:function(){var e=this;R.requestAnimationFrame(function(){e._requested=!1;if(!e._animate)return;e._requestFrame(),e._handleFrame()},this._element),this._requested=!0},_handleFrame:function(){paper=this._scope;var t=Date.now()/1e3,n=this._before?t-this._before:0;this._before=t,this._handlingFrame=!0,this.fire("frame",e.merge({delta:n,time:this._time+=n,count:this._count++})),this._stats&&this._stats.update(),this._handlingFrame=!1,this.draw(!0)},_animateItem:function(e,t){var n=this._frameItems;t?(n[e._id]={item:e,time:0,count:0},++this._frameItemCount===1&&this.attach("frame",this._handleFrameItems)):(delete n[e._id],--this._frameItemCount===0&&this.detach("frame",this._handleFrameItems))},_handleFrameItems:function(t){for(var n in this._frameItems){var r=this._frameItems[n];r.item.fire("frame",e.merge(t,{time:r.time+=t.delta,count:r.count++}))}},_redraw:function(){this._project._needsRedraw=!0;if(this._handlingFrame)return;this._animate?this._handleFrame():this.draw()},_transform:function(e){this._matrix.concatenate(e),this._bounds=null,this._inverse=null,this._redraw()},getElement:function(){return this._element},getViewSize:function(){return this._viewSize},setViewSize:function(e){e=f.read(arguments);var t=e.subtract(this._viewSize);if(t.isZero())return;this._element.width=e.width,this._element.height=e.height,this._viewSize.set(e.width,e.height,!0),this._bounds=null,this.fire("resize",{size:e,delta:t}),this._redraw()},getBounds:function(){return this._bounds||(this._bounds=this._getInverse()._transformBounds(new h(new u,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize(arguments[0])},getCenter:function(){return this.getBounds().getCenter(arguments[0])},setCenter:function(e){e=u.read(arguments),this.scrollBy(e.subtract(this.getCenter()))},getZoom:function(){return this._zoom},setZoom:function(e){this._transform((new d).scale(e/this._zoom,this.getCenter())),this._zoom=e},isVisible:function(){return q.isInView(this._element)},scrollBy:function(){this._transform((new d).translate(u.read(arguments).negate()))},projectToView:function(){return this._matrix._transformPoint(u.read(arguments))},viewToProject:function(){return this._getInverse()._transformPoint(u.read(arguments))},_getInverse:function(){return this._inverse||(this._inverse=this._matrix.inverted()),this._inverse}},{statics:{_views:[],_viewsById:{},_id:0,create:function(e){return typeof e=="string"&&(e=document.getElementById(e)),new z(e)}}},new function(){function i(e){var t=R.getTarget(e);return t.getAttribute&&U._viewsById[t.getAttribute("id")]}function s(e,t){return e.viewToProject(R.getOffset(t,e._element))}function o(){if(!U._focused||!U._focused.isVisible())for(var e=0,t=U._views.length;e<t;e++){var r=U._views[e];if(r&&r.isVisible()){U._focused=n=r;break}}}function u(t){var n=U._focused=i(t),o=s(n,t);r=!0,n._onMouseDown&&n._onMouseDown(t,o),(e=n._scope._tool)&&e._onHandleEvent("mousedown",o,t),n.draw(!0)}function a(u){var a;r||(a=i(u),a?(t=U._focused,U._focused=n=a):n&&n==U._focused&&(U._focused=t,o()));if(!(a=a||U._focused))return;var f=u&&s(a,u);a._onMouseMove&&a._onMouseMove(u,f),(e=a._scope._tool)&&e._onHandleEvent(r&&e.responds("mousedrag")?"mousedrag":"mousemove",f,u)&&R.stop(u),a.draw(!0)}function f(t){var n=U._focused;if(!n||!r)return;var i=s(n,t);curPoint=null,r=!1,n._onMouseUp&&n._onMouseUp(t,i),e&&e._onHandleEvent("mouseup",i,t)&&R.stop(t),n.draw(!0)}function l(e){r&&R.stop(e)}var e,t,n,r=!1;return R.add(document,{mousemove:a,mouseup:f,touchmove:a,touchend:f,selectstart:l,scroll:o}),R.add(window,{load:o}),{_viewHandlers:{mousedown:u,touchstart:u,selectstart:l},statics:{updateFocus:o}}}),z=U.extend({_class:"CanvasView",initialize:function(t){if(!(t instanceof HTMLCanvasElement)){var n=f.read(arguments,1);n.isZero()&&(n=new f(1024,768)),t=G.getCanvas(n)}this._context=t.getContext("2d"),this._eventCounters={},U.call(this,t)},draw:function(e){if(e&&!this._project._needsRedraw)return!1;var t=this._context,n=this._viewSize;return t.clearRect(0,0,n._width+1,n._height+1),this._project.draw(t,this._matrix),this._project._needsRedraw=!1,!0}},new function(){function f(e,t,n,r,i,s){var o=r,u;while(o){if(o.responds(e)){u||(u=new $(e,t,n,r,i?n.subtract(i):null));if(o.fire(e,u)&&(!s||u._stopped))return!1}o=o.getParent()}return!0}function l(e,t,n,r,i){if(e._eventCounters[t]){var u=e._project,a=u.hitTest(r,{tolerance:u.options.hitTolerance||0,fill:!0,stroke:!0}),l=a&&a.item;if(l)return t==="mousemove"&&l!=s&&(i=r),(t!=="mousemove"||!o)&&f(t,n,r,l,i),l}}var e,t,n,r,i,s,o,u,a;return{_onMouseDown:function(s,f){var c=l(this,"mousedown",s,f);u=i==c&&Date.now()-a<300,r=i=c,e=t=n=f,o=r&&r.responds("mousedrag")},_onMouseUp:function(i,s){var c=l(this,"mouseup",i,s);o&&(t&&!t.equals(s)&&f("mousedrag",i,s,r,t),c!=r&&(n=s,f("mousemove",i,s,c,n))),c===r&&(a=Date.now(),(!u||f("doubleclick",i,e,c))&&f("click",i,e,c),u=!1),r=null,o=!1},_onMouseMove:function(e,i){r&&f("mousedrag",e,i,r,t);var o=l(this,"mousemove",e,i,n);t=n=i,o!==s&&(f("mouseleave",e,i,s),s=o,f("mouseenter",e,i,o))}}}),W=e.extend({_class:"Event",initialize:function(t){this.event=t},preventDefault:function(){this._prevented=!0,R.preventDefault(this.event)},stopPropagation:function(){this._stopped=!0,R.stopPropagation(this.event)},stop:function(){this.stopPropagation(),this.preventDefault()},getModifiers:function(){return V.modifiers}}),X=W.extend({_class:"KeyEvent",initialize:function(t,n,r,i){W.call(this,i),this.type=t?"keydown":"keyup",this.key=n,this.character=r},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),V=new function(){function o(e,n,r,s){var o=String.fromCharCode(r),u=t[n]||o.toLowerCase(),a=e?"keydown":"keyup",f=U._focused,l=f&&f.isVisible()&&f._scope,c=l&&l._tool;i[u]=e,c&&c.responds(a)&&(c.fire(a,new X(e,u,o,s)),f&&f.draw(!0))}var t={8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"option",19:"pause",20:"caps-lock",27:"escape",32:"space",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",46:"delete",91:"command",93:"command",224:"command"},n=e.merge({shift:!1,control:!1,option:!1,command:!1,capsLock:!1,space:!1}),r={},i={},s;return R.add(document,{keydown:function(i){var u=i.which||i.keyCode,a=t[u],f;a?((f=e.camelize(a))in n&&(n[f]=!0),r[u]=0,o(!0,u,null,i)):s=u},keypress:function(e){if(s!=null){var t=e.which||e.keyCode;r[s]=t,o(!0,s,t,e),s=null}},keyup:function(i){var s=i.which||i.keyCode,u=t[s],a;u&&(a=e.camelize(u))in n&&(n[a]=!1),r[s]!=null&&(o(!1,s,r[s],i),delete r[s])}}),{modifiers:n,isDown:function(e){return!!i[e]}}},$=W.extend({_class:"MouseEvent",initialize:function(t,n,r,i,s){W.call(this,n),this.type=t,this.point=r,this.target=i,this.delta=s},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}});e.extend(t,{_class:"Palette",_events:["onChange"],initialize:function(n,r,i){var s=q.find(".palettejs-panel")||q.find("body").appendChild(q.create("div",{"class":"palettejs-panel"}));this._element=s.appendChild(q.create("table",{"class":"palettejs-pane"})),this._title=n,i||(i={});for(var o in this._components=r){var u=r[o];u instanceof J||(u.value==null&&(u.value=i[o]),u.name=o,u=r[o]=new J(u)),this._element.appendChild(u._element),u._palette=this,i[o]===undefined&&(i[o]=u.value)}this._values=e.each(i,function(t,n){var s=r[n];s&&e.define(i,n,{enumerable:!0,configurable:!0,get:function(){return s._value},set:function(e){s.setValue(e)}})}),window.paper&&paper.palettes.push(this)},reset:function(){for(var e in this._components)this._components[e].reset()},remove:function(){q.remove(this._element)}});var J=e.extend(t,{_class:"Component",_events:["onChange","onClick"],_types:{"boolean":{type:"checkbox",value:"checked"},string:{type:"text"},number:{type:"number",number:!0},button:{type:"button"},text:{tag:"div",value:"text"},slider:{type:"range",number:!0},list:{tag:"select",options:function(){q.removeChildren(this._inputItem),q.create(e.each(this._options,function(e){this.push("option",{value:e,text:e})},[]),this._inputItem)}}},initialize:function(n){this._type=n.type in this._types?n.type:"options"in n?"list":"onClick"in n?"button":typeof n.value,this._info=this._types[this._type]||{type:this._type};var r=this,i=!1;this._inputItem=q.create(this._info.tag||"input",{type:this._info.type,events:{change:function(){r.setValue(q.get(this,r._info.value||"value")),i&&(r._palette.fire("change",r,r.name,r._value),r.fire("change",r._value))},click:function(){r.fire("click")}}}),this._element=q.create("tr",[this._labelItem=q.create("td"),"td",[this._inputItem]]),e.each(n,function(e,t){this[t]=e},this),this._defaultValue=this._value,i=!0},getType:function(){return this._type},getLabel:function(){return this._label},setLabel:function(e){this._label=e,q.set(this._labelItem,"text",e+":")},getOptions:function(){return this._options},setOptions:function(e){this._options=e,this._info.options&&this._info.options.call(this)},getValue:function(){return this._value},setValue:function(e){var t=this._info.value||"value";q.set(this._inputItem,t,e),e=q.get(this._inputItem,t),this._value=this._info.number?parseFloat(e,10):e},getRange:function(){return[parseFloat(q.get(this._inputItem,"min")),parseFloat(q.get(this._inputItem,"max"))]},setRange:function(e,t){var n=Array.isArray(e)?e:[e,t];q.set(this._inputItem,{min:n[0],max:n[1]})},getMin:function(){return this.getRange()[0]},setMin:function(e){this.setRange(e,this.getMax())},getMax:function(){return this.getRange()[1]},setMax:function(e){this.setRange(this.getMin(),e)},getStep:function(){return parseFloat(q.get(this._inputItem,"step"))},setStep:function(e){q.set(this._inputItem,"step",e)},reset:function(){this.setValue(this._defaultValue)}}),K=W.extend({_class:"ToolEvent",_item:null,initialize:function(t,n,r){this.tool=t,this.type=n,this.event=r},_choosePoint:function(e,t){return e?e:t?t.clone():null},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(e){this._point=e},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(e){this._lastPoint=e},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(e){this._downPoint=e},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(e){this._middlePoint=e},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(e){this._delta=e},getCount:function(){return/^mouse(down|up)$/.test(this.type)?this.tool._downCount:this.tool._count},setCount:function(e){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=e},getItem:function(){if(!this._item){var e=this.tool._scope.project.hitTest(this.getPoint());if(e){var t=e.item,n=t._parent;while(/^(group|compound-path)$/.test(n._type))t=n,n=n._parent;this._item=t}}return this._item},setItem:function(e){this._item=e},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),Q=r.extend({_class:"Tool",_list:"tools",_reference:"_tool",_events:["onActivate","onDeactivate","onEditOptions","onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onKeyDown","onKeyUp"],initialize:function(t){r.call(this),this._firstMove=!0,this._count=0,this._downCount=0,this._set(t)},getMinDistance:function(){return this._minDistance},setMinDistance:function(e){this._minDistance=e,this._minDistance!=null&&this._maxDistance!=null&&this._minDistance>this._maxDistance&&(this._maxDistance=this._minDistance)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(e){this._maxDistance=e,this._minDistance!=null&&this._maxDistance!=null&&this._maxDistance<this._minDistance&&(this._minDistance=e)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(e){this._minDistance=e,this._maxDistance=e},_updateEvent:function(e,t,n,r,i,s,o){if(!i){if(n!=null||r!=null){var u=n!=null?n:0,a=t.subtract(this._point),f=a.getLength();if(f<u)return!1;var l=r!=null?r:0;if(l!=0)if(f>l)t=this._point.add(a.normalize(l));else if(o)return!1}if(s&&t.equals(this._point))return!1}this._lastPoint=i&&e=="mousemove"?t:this._point,this._point=t;switch(e){case"mousedown":this._lastPoint=this._downPoint,this._downPoint=this._point,this._downCount++;break;case"mouseup":this._lastPoint=this._downPoint}return this._count=i?0:this._count+1,!0},_fireEvent:function(e,t){var n=paper.project._removeSets;if(n){e==="mouseup"&&(n.mousedrag=null);var r=n[e];if(r){for(var i in r){var s=r[i];for(var o in n){var u=n[o];u&&u!=r&&delete u[s._id]}s.remove()}n[e]=null}}return this.responds(e)&&this.fire(e,new K(this,e,t))},_onHandleEvent:function(e,t,n){paper=this._scope;var r=!1;switch(e){case"mousedown":this._updateEvent(e,t,null,null,!0,!1,!1),r=this._fireEvent(e,n);break;case"mousedrag":var i=!1,s=!1;while(this._updateEvent(e,t,this.minDistance,this.maxDistance,!1,i,s))r=this._fireEvent(e,n)||r,i=!0,s=!0;break;case"mouseup":!t.equals(this._point)&&this._updateEvent("mousedrag",t,this.minDistance,this.maxDistance,!1,!1,!1)&&(r=this._fireEvent("mousedrag",n)),this._updateEvent(e,t,null,this.maxDistance,!1,!1,!1),r=this._fireEvent(e,n)||r,this._updateEvent(e,t,null,null,!0,!1,!1),this._firstMove=!0;break;case"mousemove":while(this._updateEvent(e,t,this.minDistance,this.maxDistance,this._firstMove,!0,!1))r=this._fireEvent(e,n)||r,this._firstMove=!1}return r}}),G={canvases:[],getCanvas:function(e,t){var n=t===undefined?e:new f(e,t),r,i=!0;this.canvases.length?r=this.canvases.pop():r=document.createElement("canvas");var s=r.getContext("2d");return s.save(),r.width===n.width&&r.height===n.height?i&&s.clearRect(0,0,n.width+1,n.height+1):(r.width=n.width,r.height=n.height),r},getContext:function(e,t){return this.getCanvas(e,t).getContext("2d")},release:function(e){var t=e.canvas?e.canvas:e;t.getContext("2d").restore(),this.canvases.push(t)}},Y=new function(){function v(e,t,n){return.2989*e+.587*t+.114*n}function m(e,r,i,s){var o=s-v(e,r,i);h=e+o,p=r+o,d=i+o;var s=v(h,p,d),u=t(h,p,d),a=n(h,p,d);if(u<0){var f=s-u;h=s+(h-s)*s/f,p=s+(p-s)*s/f,d=s+(d-s)*s/f}if(a>255){var l=255-s,c=a-s;h=s+(h-s)*l/c,p=s+(p-s)*l/c,d=s+(d-s)*l/c}}function g(e,r,i){return n(e,r,i)-t(e,r,i)}function y(e,r,i,s){var o=[e,r,i],u=n(e,r,i),a=t(e,r,i),f;a=a===e?0:a===r?1:2,u=u===e?0:u===r?1:2,f=t(a,u)===0?n(a,u)===1?2:1:0,o[u]>o[a]?(o[f]=(o[f]-o[a])*s/(o[u]-o[a]),o[u]=s):o[f]=o[u]=0,o[a]=0,h=o[0],p=o[1],d=o[2]}var t=Math.min,n=Math.max,r=Math.abs,i,s,o,u,a,f,l,c,h,p,d,b={multiply:function(){h=a*i/255,p=f*s/255,d=l*o/255},screen:function(){h=a+i-a*i/255,p=f+s-f*s/255,d=l+o-l*o/255},overlay:function(){h=a<128?2*a*i/255:255-2*(255-a)*(255-i)/255,p=f<128?2*f*s/255:255-2*(255-f)*(255-s)/255,d=l<128?2*l*o/255:255-2*(255-l)*(255-o)/255},"soft-light":function(){var e=i*a/255;h=e+a*(255-(255-a)*(255-i)/255-e)/255,e=s*f/255,p=e+f*(255-(255-f)*(255-s)/255-e)/255,e=o*l/255,d=e+l*(255-(255-l)*(255-o)/255-e)/255},"hard-light":function(){h=i<128?2*i*a/255:255-2*(255-i)*(255-a)/255,p=s<128?2*s*f/255:255-2*(255-s)*(255-f)/255,d=o<128?2*o*l/255:255-2*(255-o)*(255-l)/255},"color-dodge":function(){h=a===0?0:i===255?255:t(255,255*a/(255-i)),p=f===0?0:s===255?255:t(255,255*f/(255-s)),d=l===0?0:o===255?255:t(255,255*l/(255-o))},"color-burn":function(){h=a===255?255:i===0?0:n(0,255-(255-a)*255/i),p=f===255?255:s===0?0:n(0,255-(255-f)*255/s),d=l===255?255:o===0?0:n(0,255-(255-l)*255/o)},darken:function(){h=a<i?a:i,p=f<s?f:s,d=l<o?l:o},lighten:function(){h=a>i?a:i,p=f>s?f:s,d=l>o?l:o},difference:function(){h=a-i,h<0&&(h=-h),p=f-s,p<0&&(p=-p),d=l-o,d<0&&(d=-d)},exclusion:function(){h=a+i*(255-a-a)/255,p=f+s*(255-f-f)/255,d=l+o*(255-l-l)/255},hue:function(){y(i,s,o,g(a,f,l)),m(h,p,d,v(a,f,l))},saturation:function(){y(a,f,l,g(i,s,o)),m(h,p,d,v(a,f,l))},luminosity:function(){m(a,f,l,v(i,s,o))},color:function(){m(i,s,o,v(a,f,l))},add:function(){h=t(a+i,255),p=t(f+s,255),d=t(l+o,255)},subtract:function(){h=n(a-i,0),p=n(f-s,0),d=n(l-o,0)},average:function(){h=(a+i)/2,p=(f+s)/2,d=(l+o)/2},negation:function(){h=255-r(255-i-a),p=255-r(255-s-f),d=255-r(255-o-l)}},w=this.nativeModes=e.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],function(e){this[e]=!0},{}),E=G.getContext(1,1);e.each(b,function(e,t){E.save();var n=t==="darken",r=!1;E.fillStyle=n?"#300":"#a00",E.fillRect(0,0,1,1),E.globalCompositeOperation=t,E.globalCompositeOperation===t&&(E.fillStyle=n?"#a00":"#300",E.fillRect(0,0,1,1),r=E.getImageData(0,0,1,1).data[0]!==(n?170:51)),w[t]=r,E.restore()}),G.release(E),this.process=function(e,t,n,r,v){var m=t.canvas,g=e==="normal";if(g||w[e])n.save(),n.setTransform(1,0,0,1,0,0),n.globalAlpha=r,g||(n.globalCompositeOperation=e),n.drawImage(m,v.x,v.y),n.restore();else{var y=b[e];if(!y)return;var E=n.getImageData(v.x,v.y,m.width,m.height),S=E.data,x=t.getImageData(0,0,m.width,m.height).data;for(var T=0,N=S.length;T<N;T+=4){i=x[T],a=S[T],s=x[T+1],f=S[T+1],o=x[T+2],l=S[T+2],u=x[T+3],c=S[T+3],y();var C=u*r/255,k=1-C;S[T]=C*h+k*a,S[T+1]=C*p+k*f,S[T+2]=C*d+k*l,S[T+3]=u*r+k*c}n.putImageData(E,v.x,v.y)}}},Z=e.each({fillColor:["fill","color"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],font:["font-family","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","string"]},function(t,n){var r=e.capitalize(n),i=t[2];this[n]={type:t[1],property:n,attribute:t[0],toSVG:i,fromSVG:i&&e.each(i,function(e,t){this[e]=t},{}),get:"get"+r,set:"set"+r}},{}),et={href:"http://www.w3.org/1999/xlink",xlink:"http://www.w3.org/2000/xmlns"};return new function(){function n(e,n){for(var r in n){var i=n[r],s=et[r];typeof i=="number"&&(i=t.number(i)),s?e.setAttributeNS(s,r,i):e.setAttribute(r,i)}return e}function r(e,t){return n(document.createElementNS("http://www.w3.org/2000/svg",e),t)}function u(e,t,n){return e[t]._point.getDistance(e[n]._point)}function a(e,n){var r=e._matrix,i=r.getTranslation(),s={};if(n){r=r.shiftless();var u=r._inverseTransform(i);s.x=u.x,s.y=u.y,i=null}if(r.isIdentity())return s;var a=r.decompose();if(a&&!a.shearing){var f=[],l=a.rotation,c=a.scaling;i&&!i.isZero()&&f.push("translate("+t.point(i)+")"),(!o.isZero(c.x-1)||!o.isZero(c.y-1))&&f.push("scale("+t.point(c)+")"),l&&f.push("rotate("+t.number(l)+")"),s.transform=f.join(" ")}else s.transform="matrix("+r.getValues().join(",")+")";return s}function f(e,t,n,r){var i=n==="rect"?t[1]._point.add(t[2]._point).divide(2):n==="roundrect"?t[3]._point.add(t[4]._point).divide(2):n==="circle"||n==="ellipse"?t[1]._point:null,s=i&&i.subtract(r).getAngle()+90;return o.isZero(s||0)?0:s}function c(e,t){function n(e,n){var r=t[e],i=r.getNext(),s=t[n],o=s.getNext();return r._handleOut.isZero()&&i._handleIn.isZero()&&s._handleOut.isZero()&&o._handleIn.isZero()&&i._point.subtract(r._point).isColinear(o._point.subtract(s._point))}function r(e){var n=t[e],r=n.getNext(),i=n._handleOut,s=r._handleIn,u=o.KAPPA;if(i.isOrthogonal(s)){var a=n._point,f=r._point,l=(new v(a,i,!0)).intersect(new v(f,s,!0),!0);return l&&o.isZero(i.getLength()/l.subtract(a).getLength()-u)&&o.isZero(s.getLength()/l.subtract(f).getLength()-u)}}if(e.isPolygon())return t.length===4&&e._closed&&n(0,2)&&n(1,3)?"rect":t.length===0?"empty":t.length>=3?e._closed?"polygon":"polyline":"line";if(e._closed){if(t.length===8&&r(0)&&r(2)&&r(4)&&r(6)&&n(1,5)&&n(3,7))return"roundrect";if(t.length===4&&r(0)&&r(1)&&r(2)&&r(3))return o.isZero(u(t,0,2)-u(t,1,3))?"circle":"ellipse"}return"path"}function h(e){var t=a(e),i=e._children,s=r("g",t);for(var o=0,u=i.length;o<u;o++){var f=i[o],l=A(f);if(l)if(f.isClipMask()){var c=r("clipPath");c.appendChild(l),k(f,c,"clip"),n(s,{"clip-path":"url(#"+c.id+")"})}else s.appendChild(l)}return s}function p(e){var t=a(e,!0),n=e.getSize();return t.x-=n.width/2,t.y-=n.height/2,t.width=n.width,t.height=n.height,t.href=e.toDataURL(),r("image",t)}function g(e){var n=e._segments,s=e.getPosition(!0),o=c(e,n),a=f(e,n,o,s),h;switch(o){case"empty":return null;case"path":var p=e.getPathData();h=p&&{d:p};break;case"polyline":case"polygon":var v=[];for(i=0,l=n.length;i<l;i++)v.push(t.point(n[i]._point));h={points:v.join(" ")};break;case"rect":var m=u(n,0,3),g=u(n,0,1),y=n[1]._point.rotate(-a,s);h={x:y.x,y:y.y,width:m,height:g};break;case"roundrect":o="rect";var m=u(n,1,6),g=u(n,0,3),b=(m-u(n,0,7))/2,w=(g-u(n,1,2))/2,E=n[3]._point,S=n[4]._point,y=E.subtract(S.subtract(E).normalize(b)).rotate(-a,s);h={x:y.x,y:y.y,width:m,height:g,rx:b,ry:w};break;case"line":var x=n[0]._point,T=n[n.length-1]._point;h={x1:x.x,y1:x.y,x2:T.x,y2:T.y};break;case"circle":var N=u(n,0,2)/2;h={cx:s.x,cy:s.y,r:N};break;case"ellipse":var b=u(n,2,0)/2,w=u(n,3,1)/2;h={cx:s.x,cy:s.y,rx:b,ry:w}}return a&&(h.transform="rotate("+t.number(a)+","+t.point(s)+")",e._gradientMatrix=(new d).rotate(-a,s)),r(o,h)}function b(e){var t=a(e,!0),n=e.getPathData();return n&&(t.d=n),r("path",t)}function w(e){var n=a(e,!0),i=e.getSymbol(),s=C(i,"symbol");return definition=i.getDefinition(),bounds=definition.getBounds(),s||(s=r("symbol",{viewBox:t.rectangle(bounds)}),s.appendChild(A(definition)),k(i,s,"symbol")),n.href="#"+s.id,n.x+=bounds.x,n.y+=bounds.y,n.width=t.number(bounds.width),n.height=t.number(bounds.height),r("use",n)}function E(e,t){var n=C(e,"color");if(!n){var i=e.getGradient(),s=i._radial,o=t._gradientMatrix,u=e.getOrigin().transform(o),a=e.getDestination().transform(o),f;if(s){f={cx:u.x,cy:u.y,r:u.getDistance(a)};var l=e.getHighlight();l&&(l=l.transform(o),f.fx=l.x,f.fy=l.y)}else f={x1:u.x,y1:u.y,x2:a.x,y2:a.y};f.gradientUnits="userSpaceOnUse",n=r((s?"radial":"linear")+"Gradient",f);var c=i._stops;for(var h=0,p=c.length;h<p;h++){var d=c[h],v=d._color,m=v.getAlpha();f={offset:d._rampPoint,"stop-color":v.toCSS(!0)},m<1&&(f["stop-opacity"]=m),n.appendChild(r("stop",f))}k(e,n,"color")}return"url(#"+n.id+")"}function S(e){var t=r("text",a(e,!0));return t.textContent=e._content,t}function T(r,i){var s={},o=r.getParent();return r._name!=null&&(s.id=r._name),e.each(Z,function(n){var i=n.get,u=n.type,a=r[i]();if(!o||!e.equals(o[i](),a)){if(u==="color"&&a!=null){var f=a.getAlpha();f<1&&(s[n.attribute+"-opacity"]=f)}s[n.attribute]=a==null?"none":u==="number"?t.number(a):u==="color"?a.gradient?E(a,r):a.toCSS(!0):u==="array"?a.join(","):u==="lookup"?n.toSVG[a]:a}}),s.opacity===1&&delete s.opacity,r._visibility!=null&&!r._visibility&&(s.visibility="hidden"),delete r._gradientMatrix,n(i,s)}function C(e,t){return N||(N={ids:{},svgs:{}}),e&&N.svgs[t+"-"+e._id]}function k(e,t,n){N||C();var r=N.ids[n]=(N.ids[n]||0)+1;t.id=n+"-"+r,N.svgs[n+"-"+e._id]=t}function L(e,t){if(!N)return e;var n=e.nodeName.toLowerCase()==="svg"&&e,i=null;for(var s in N.svgs)i||(n||(n=r("svg"),n.appendChild(e)),i=n.insertBefore(r("defs"),n.firstChild)),i.appendChild(N.svgs[s]);return N=null,t&&t.asString?(new XMLSerializer).serializeToString(n):n}function A(e){var t=x[e._type],n=t&&t(e,e._type);return n&&e._data&&n.setAttribute("data-paper-data",JSON.stringify(e._data)),n&&T(e,n)}function O(e){t=e&&e.precision?new s(e.precision):s.instance}var t,x={group:h,layer:h,raster:p,path:g,"compound-path":b,"placed-symbol":w,"point-text":S},N;y.inject({exportSVG:function(e){return O(e),L(A(this),e)}}),m.inject({exportSVG:function(e){O(e);var t=this.layers,n=this.view.getSize(),i=r("svg",{x:0,y:0,width:n.width,height:n.height,version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"});for(var s=0,o=t.length;s<o;s++)i.appendChild(A(t[s]));return L(i,e)}})},new function(){function t(e,t,n,r){var i=et[t],s=i?e.getAttributeNS(i,t):e.getAttribute(t);return s==="null"&&(s=null),s==null?r?null:n?"":0:n?s:parseFloat(s)}function n(e,n,r,i){return n=t(e,n,!1,i),r=t(e,r,!1,i),i&&n==null&&r==null?null:new u(n||0,r||0)}function r(e,n,r,i){return n=t(e,n,!1,i),r=t(e,r,!1,i),i&&n==null&&r==null?null:new f(n||0,r||0)}function i(e,t,n){return e==="none"?null:t==="number"?parseFloat(e):t==="array"?e?e.split(/[\s,]+/g).map(parseFloat):[]:t==="color"?N(e)||e:t==="lookup"?n[e]:e}function s(e,t){var n=e.childNodes,r=t==="clippath",i=r?new M:new b,s=i._project,o=s._currentStyle,u=[];r||(i._transformContent=!1,i=x(i,e),s._currentStyle=i._style.clone());for(var a=0,f=n.length;a<f;a++){var l=n[a],c;l.nodeType==1&&(c=C(l))&&(r&&c instanceof M?(u.push.apply(u,c.removeChildren()),c.remove()):c instanceof g||u.push(c))}i.addChildren(u),r&&(i=x(i.reduce(),e)),s._currentStyle=o;if(r||t==="defs")i.remove(),i=null;return i}function o(e,t){var n=new O,r=e.points;n.moveTo(r.getItem(0));for(var i=1,s=r.numberOfItems;i<s;i++)n.lineTo(r.getItem(i));return t==="polygon"&&n.closePath(),n}function a(e){var t=e.getAttribute("d"),n=t.match(/m/gi).length>1?new M:new O;return n.setPathData(t),n}function l(e,r){var i=e.childNodes,s=[];for(var o=0,u=i.length;o<u;o++){var a=i[o];a.nodeType==1&&s.push(x(new F,a))}var f=r==="radialgradient",l=new j(s,f),c,h,p;return f?(c=n(e,"cx","cy"),h=c.add(t(e,"r"),0),p=n(e,"fx","fy",!0)):(c=n(e,"x1","y1"),h=n(e,"x2","y2")),x(new B(l,c,h,p),e),null}function p(e,t,n,r){var i=(r.getAttribute(n)||"").split(/\)\s*/g),s=new d;for(var o=0,u=i.length;o<u;o++){var a=i[o];if(!a)break;var f=a.split("("),l=f[0],c=f[1].split(/[\s,]+/g);for(var h=0,p=c.length;h<p;h++)c[h]=parseFloat(c[h]);switch(l){case"matrix":s.concatenate(new d(c[0],c[2],c[1],c[3],c[4],c[5]));break;case"rotate":s.rotate(c[0],c[1],c[2]);break;case"translate":s.translate(c[0],c[1]);break;case"scale":s.scale(c);break;case"skewX":case"skewY":var t=Math.tan(c[0]*Math.PI/180),v=l=="skewX";s.shear(v?t:0,v?0:t)}}e.transform(s)}function v(e,t,n){var r=e[n==="fill-opacity"?"getFillColor":"getStrokeColor"]();r&&r.setAlpha(parseFloat(t))}function E(t,n,r){var i=t.attributes[n],s=i&&i.value;if(!s){var o=e.camelize(n);s=t.style[o],!s&&r.node[o]!==r.parent[o]&&(s=r.node[o])}return s?s==="none"?null:s:undefined}function x(t,n){var r={node:q.getStyles(n)||{},parent:q.getStyles(n.parentNode)||{}};return e.each(w,function(i,s){var o=E(n,s,r);o!==undefined&&(t=e.pick(i(t,o,s,n,r),t))}),t}function N(e){var t=e&&e.match(/\((?:#|)([^)']+)/);return t&&T[t[1]]}function C(e,t){typeof e=="string"&&(e=(new DOMParser).parseFromString(e,"image/svg+xml"));var n=e.nodeName.toLowerCase(),r=c[n],i=r&&r(e,n),s=e.getAttribute("data-paper-data");return i&&!(i instanceof b)&&(i=x(i,e)),i&&s&&(i._data=JSON.parse(s)),t&&(T={}),i}var c={g:s,svg:s,clippath:s,polygon:o,polyline:o,path:a,lineargradient:l,radialgradient:l,image:function(e){var i=new S(t(e,"href",!0));return i.attach("load",function(){var t=r(e,"width","height");this.setSize(t),this.translate(n(e,"x","y").add(t.divide(2)))}),i},symbol:function(e,t){return new g(s(e,t),!0)},defs:s,use:function(e){var r=(t(e,"href",!0)||"").substring(1),i=T[r],s=n(e,"x","y");return i?i instanceof g?i.place(s):i.clone().translate(s):null},circle:function(e){return new O.Circle(n(e,"cx","cy"),t(e,"r"))},ellipse:function(e){var t=n(e,"cx","cy"),i=r(e,"rx","ry");return new O.Ellipse(new h(t.subtract(i),t.add(i)))},rect:function(e){var t=n(e,"x","y"),i=r(e,"width","height"),s=r(e,"rx","ry");return new O.Rectangle(new h(t,i),s)},line:function(e){return new O.Line(n(e,"x1","y1"),n(e,"x2","y2"))},text:function(e){var t=new H(n(e,"x","y",!1).add(n(e,"dx","dy",!1)));return t.setContent(e.textContent.trim()||""),t}},w=e.merge(e.each(Z,function(e){this[e.attribute]=function(t,n){t[e.set](i(n,e.type,e.fromSVG))}},{}),{id:function(e,t){T[t]=e,e.setName&&e.setName(t)},"clip-path":function(e,t){var n=N(t);if(n){n=n.clone(),n.setClipMask(!0);if(!(e instanceof b))return new b(n,e);e.insertChild(0,n)}},gradientTransform:p,transform:p,"fill-opacity":v,"stroke-opacity":v,visibility:function(e,t){e.setVisible(t==="visible")},"stop-color":function(e,t){e.setColor&&e.setColor(t)},"stop-opacity":function(e,t){e._color&&e._color.setAlpha(parseFloat(t))},offset:function(e,t){var n=t.match(/(.*)%$/);e.setRampPoint(n?n[1]/100:parseFloat(t))},viewBox:function(e,t,n,s,o){var u=new h(i(t,"array")),a=r(s,"width","height",!0);if(e instanceof b){var f=a?u.getSize().divide(a):1,l=(new d).translate(u.getPoint()).scale(f);e.transform(l.inverted())}else if(e instanceof g){a&&u.setSize(a);var c=E(s,"overflow",o)!="visible",p=e._definition;c&&!u.contains(p.getBounds())&&(c=(new O.Rectangle(u)).transform(p._matrix),c.setClipMask(!0),p.addChild(c))}}}),T={};y.inject({importSVG:function(e){return this.addChild(C(e,!0))}}),m.inject({importSVG:function(e){return this.activate(),C(e,!0)}})},paper=new(n.inject(e.merge(e.exports,{enumerable:!0,Base:e,Numerical:o,DomElement:q,DomEvent:R,Key:V}))),typeof define=="function"&&define.amd&&define(paper),paper};paper.PaperScope.prototype.PaperScript=function(root){function _$_(e,t,n){var r=binaryOperators[t];if(e&&e[r]){var i=e[r](n);return t==="!="?!i:i}switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;case"%":return e%n;case"==":return e==n;case"!=":return e!=n}}function $_(e,t){var n=unaryOperators[e];if(n&&t&&t[n])return t[n]();switch(e){case"+":return+t;case"-":return-t}}function compile(e){function n(e){for(var n=0,r=t.length;n<r;n++){var i=t[n];if(i[0]>=e)break;e+=i[1]}return e}function r(t){return e.substring(n(t.range[0]),n(t.range[1]))}function i(r,i){var s=n(r.range[0]),o=n(r.range[1]),u=0;for(var a=t.length-1;a>=0;a--)if(s>t[a][0]){u=a+1;break}t.splice(u,0,[s,i.length-o+s]),e=e.substring(0,s)+i+e.substring(o)}function s(e){if(!e||e.type==="MemberExpression"&&e.computed)return;for(var t in e){if(t==="range")continue;var n=e[t];if(Array.isArray(n))for(var o=0,u=n.length;o<u;o++)s(n[o]);else n&&typeof n=="object"&&s(n)}switch(e&&e.type){case"BinaryExpression":if(e.operator in binaryOperators&&e.left.type!=="Literal"){var a=r(e.left),f=r(e.right);i(e,"_$_("+a+', "'+e.operator+'", '+f+")")}break;case"AssignmentExpression":if(/^.=$/.test(e.operator)&&e.left.type!=="Literal"){var a=r(e.left),f=r(e.right);i(e,a+" = _$_("+a+', "'+e.operator[0]+'", '+f+")")}break;case"UpdateExpression":if(!e.prefix){var l=r(e.argument);i(e,l+" = _$_("+l+', "'+e.operator[0]+'", 1)')}break;case"UnaryExpression":if(e.operator in unaryOperators&&e.argument.type!=="Literal"){var l=r(e.argument);i(e,'$_("'+e.operator+'", '+l+")")}}}var t=[];return s(scope.acorn.parse(e,{ranges:!0})),e}function evaluate(code,scope){paper=scope;var view=scope.project&&scope.project.view,res;with(scope)(function(){var onActivate,onDeactivate,onEditOptions,onMouseDown,onMouseUp,onMouseDrag,onMouseMove,onKeyDown,onKeyUp,onFrame,onResize;res=eval(compile(code)),/on(?:Key|Mouse)(?:Up|Down|Move|Drag)/.test(code)&&Base.each(paper.Tool.prototype._events,function(key){var value=eval(key);value&&(scope.getTool()[key]=value)}),view&&(view.setOnResize(onResize),view.fire("resize",{size:view.size,delta:new Point}),view.setOnFrame(onFrame),view.draw())}).call(scope);return res}function request(e,t){var n=new(window.ActiveXObject||XMLHttpRequest)("Microsoft.XMLHTTP");return n.open("GET",e,!0),n.overrideMimeType&&n.overrideMimeType("text/plain"),n.onreadystatechange=function(){if(n.readyState===4)return evaluate(n.responseText,t)},n.send(null)}function load(){var e=document.getElementsByTagName("script");for(var t=0,n=e.length;t<n;t++){var r=e[t];if(/^text\/(?:x-|)paperscript$/.test(r.type)&&!r.getAttribute("data-paper-ignore")){var i=PaperScope.getAttribute(r,"canvas"),s=PaperScope.get(i)||(new PaperScope(r)).setup(i);r.src?request(r.src,s):evaluate(r.innerHTML,s),r.setAttribute("data-paper-ignore",!0)}}}var Base=paper.Base,PaperScope=paper.PaperScope,exports,define,scope=this;!function(e,t){return"object"==typeof exports&&"object"==typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):(t(e.acorn||(e.acorn={})),void 0)}(this,function(e){"use strict";function t(e){ct=e||{};for(var t in vt)Object.prototype.hasOwnProperty.call(ct,t)||(ct[t]=vt[t]);dt=ct.sourceFile||null}function n(e,t){var n=mt(ht,e);t+=" ("+n.line+":"+n.column+")";var r=new SyntaxError(t);throw r.pos=e,r.loc=n,r.raisedAt=gt,r}function r(e){function t(e){if(1==e.length)return n+="return str === "+JSON.stringify(e[0])+";";n+="switch(str){";for(var t=0;t<e.length;++t)n+="case "+JSON.stringify(e[t])+":";n+="return true}return false;"}e=e.split(" ");var n="",r=[];e:for(var i=0;i<e.length;++i){for(var s=0;s<r.length;++s)if(r[s][0].length==e[i].length){r[s].push(e[i]);continue e}r.push([e[i]])}if(r.length>3){r.sort(function(e,t){return t.length-e.length}),n+="switch(str.length){";for(var i=0;i<r.length;++i){var o=r[i];n+="case "+o[0].length+":",t(o)}n+="}"}else t(e);return new Function("str",n)}function i(){this.line=Nt,this.column=gt-Ct}function s(){Nt=1,gt=Ct=0,Tt=!0,f()}function o(e,t){bt=gt,ct.locations&&(Et=new i),St=e,f(),xt=t,Tt=e.beforeExpr}function u(){var e=ct.onComment&&ct.locations&&new i,t=gt,r=ht.indexOf("*/",gt+=2);if(-1===r&&n(gt-2,"Unterminated comment"),gt=r+2,ct.locations){Gn.lastIndex=t;for(var s;(s=Gn.exec(ht))&&s.index<gt;)++Nt,Ct=s.index+s[0].length}ct.onComment&&ct.onComment(!0,ht.slice(t+2,r),t,gt,e,ct.locations&&new i)}function a(){for(var e=gt,t=ct.onComment&&ct.locations&&new i,n=ht.charCodeAt(gt+=2);pt>gt&&10!==n&&13!==n&&8232!==n&&8329!==n;)++gt,n=ht.charCodeAt(gt);ct.onComment&&ct.onComment(!1,ht.slice(e+2,gt),e,gt,t,ct.locations&&new i)}function f(){for(;pt>gt;){var e=ht.charCodeAt(gt);if(32===e)++gt;else if(13===e){++gt;var t=ht.charCodeAt(gt);10===t&&++gt,ct.locations&&(++Nt,Ct=gt)}else if(10===e)++gt,++Nt,Ct=gt;else if(14>e&&e>8)++gt;else if(47===e){var t=ht.charCodeAt(gt+1);if(42===t)u();else{if(47!==t)break;a()}}else if(160===e)++gt;else{if(!(e>=5760&&Xn.test(String.fromCharCode(e))))break;++gt}}}function l(){var e=ht.charCodeAt(gt+1);return e>=48&&57>=e?T(!0):(++gt,o(En))}function c(){var e=ht.charCodeAt(gt+1);return Tt?(++gt,E()):61===e?w(Nn,2):w(xn,1)}function h(){var e=ht.charCodeAt(gt+1);return 61===e?w(Nn,2):w(jn,1)}function p(e){var t=ht.charCodeAt(gt+1);return t===e?w(124===e?An:On,2):61===t?w(Nn,2):w(124===e?Mn:Dn,1)}function d(){var e=ht.charCodeAt(gt+1);return 61===e?w(Nn,2):w(_n,1)}function v(e){var t=ht.charCodeAt(gt+1);return t===e?w(kn,2):61===t?w(Nn,2):w(Cn,1)}function m(e){var t=ht.charCodeAt(gt+1),n=1;return t===e?(n=62===e&&62===ht.charCodeAt(gt+2)?3:2,61===ht.charCodeAt(gt+n)?w(Nn,n+1):w(Bn,n)):(61===t&&(n=61===ht.charCodeAt(gt+2)?3:2),w(Hn,n))}function g(e){var t=ht.charCodeAt(gt+1);return 61===t?w(Pn,61===ht.charCodeAt(gt+2)?3:2):w(61===e?Tn:Ln,1)}function y(e){switch(e){case 46:return l();case 40:return++gt,o(mn);case 41:return++gt,o(gn);case 59:return++gt,o(bn);case 44:return++gt,o(yn);case 91:return++gt,o(hn);case 93:return++gt,o(pn);case 123:return++gt,o(dn);case 125:return++gt,o(vn);case 58:return++gt,o(wn);case 63:return++gt,o(Sn);case 48:var t=ht.charCodeAt(gt+1);if(120===t||88===t)return x();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return T(!1);case 34:case 39:return N(e);case 47:return c(e);case 37:case 42:return h();case 124:case 38:return p(e);case 94:return d();case 43:case 45:return v(e);case 60:case 62:return m(e);case 61:case 33:return g(e);case 126:return w(Ln,1)}return!1}function b(e){if(e?gt=yt+1:yt=gt,ct.locations&&(wt=new i),e)return E();if(gt>=pt)return o(Ft);var t=ht.charCodeAt(gt);if(Yn(t)||92===t)return L();var r=y(t);if(r===!1){var s=String.fromCharCode(t);if("\\"===s||Jn.test(s))return L();n(gt,"Unexpected character '"+s+"'")}return r}function w(e,t){var n=ht.slice(gt,gt+t);gt+=t,o(e,n)}function E(){for(var e,t,r="",i=gt;;){gt>=pt&&n(i,"Unterminated regular expression");var s=ht.charAt(gt);if(Qn.test(s)&&n(i,"Unterminated regular expression"),e)e=!1;else{if("["===s)t=!0;else if("]"===s&&t)t=!1;else if("/"===s&&!t)break;e="\\"===s}++gt}var r=ht.slice(i,gt);++gt;var u=k();return u&&!/^[gmsiy]*$/.test(u)&&n(i,"Invalid regexp flag"),o(Ht,new RegExp(r,u))}function S(e,t){for(var n=gt,r=0,i=0,s=null==t?1/0:t;s>i;++i){var o,u=ht.charCodeAt(gt);if(o=u>=97?u-97+10:u>=65?u-65+10:u>=48&&57>=u?u-48:1/0,o>=e)break;++gt,r=r*e+o}return gt===n||null!=t&&gt-n!==t?null:r}function x(){gt+=2;var e=S(16);return null==e&&n(yt+2,"Expected hexadecimal number"),Yn(ht.charCodeAt(gt))&&n(gt,"Identifier directly after number"),o(Pt,e)}function T(e){var t=gt,r=!1,i=48===ht.charCodeAt(gt);e||null!==S(10)||n(t,"Invalid number"),46===ht.charCodeAt(gt)&&(++gt,S(10),r=!0);var s=ht.charCodeAt(gt);(69===s||101===s)&&(s=ht.charCodeAt(++gt),(43===s||45===s)&&++gt,null===S(10)&&n(t,"Invalid number"),r=!0),Yn(ht.charCodeAt(gt))&&n(gt,"Identifier directly after number");var u,a=ht.slice(t,gt);return r?u=parseFloat(a):i&&1!==a.length?/[89]/.test(a)||_t?n(t,"Invalid number"):u=parseInt(a,8):u=parseInt(a,10),o(Pt,u)}function N(e){gt++;for(var t="";;){gt>=pt&&n(yt,"Unterminated string constant");var r=ht.charCodeAt(gt);if(r===e)return++gt,o(Bt,t);if(92===r){r=ht.charCodeAt(++gt);var i=/^[0-7]+/.exec(ht.slice(gt,gt+3));for(i&&(i=i[0]);i&&parseInt(i,8)>255;)i=i.slice(0,i.length-1);if("0"===i&&(i=null),++gt,i)_t&&n(gt-2,"Octal literal in strict mode"),t+=String.fromCharCode(parseInt(i,8)),gt+=i.length-1;else switch(r){case 110:t+="\n";break;case 114:t+="\r";break;case 120:t+=String.fromCharCode(C(2));break;case 117:t+=String.fromCharCode(C(4));break;case 85:t+=String.fromCharCode(C(8));break;case 116:t+="	";break;case 98:t+="\b";break;case 118:t+="";break;case 102:t+="\f";break;case 48:t+="\0";break;case 13:10===ht.charCodeAt(gt)&&++gt;case 10:ct.locations&&(Ct=gt,++Nt);break;default:t+=String.fromCharCode(r)}}else(13===r||10===r||8232===r||8329===r)&&n(yt,"Unterminated string constant"),t+=String.fromCharCode(r),++gt}}function C(e){var t=S(16,e);return null===t&&n(yt,"Bad character escape sequence"),t}function k(){In=!1;for(var e,t=!0,r=gt;;){var i=ht.charCodeAt(gt);if(Zn(i))In&&(e+=ht.charAt(gt)),++gt;else{if(92!==i)break;In||(e=ht.slice(r,gt)),In=!0,117!=ht.charCodeAt(++gt)&&n(gt,"Expecting Unicode escape sequence \\uXXXX"),++gt;var s=C(4),o=String.fromCharCode(s);o||n(gt-1,"Invalid Unicode escape"),(t?Yn(s):Zn(s))||n(gt-4,"Invalid Unicode escape"),e+=o}t=!1}return In?e:ht.slice(r,gt)}function L(){var e=k(),t=jt;return In||(Wn(e)?t=cn[e]:(ct.forbidReserved&&(3===ct.ecmaVersion?qn:Rn)(e)||_t&&Un(e))&&n(yt,"The keyword '"+e+"' is reserved")),o(t,e)}function A(){kt=yt,Lt=bt,At=Et,b()}function O(e){for(_t=e,gt=Lt;Ct>gt;)Ct=ht.lastIndexOf("\n",Ct-2)+1,--Nt;f(),b()}function M(){this.type=null,this.start=yt,this.end=null}function _(){this.start=wt,this.end=null,null!==dt&&(this.source=dt)}function D(){var e=new M;return ct.locations&&(e.loc=new _),ct.ranges&&(e.range=[yt,0]),e}function P(e){var t=new M;return t.start=e.start,ct.locations&&(t.loc=new _,t.loc.start=e.loc.start),ct.ranges&&(t.range=[e.range[0],0]),t}function H(e,t){return e.type=t,e.end=Lt,ct.locations&&(e.loc.end=At),ct.ranges&&(e.range[1]=Lt),e}function B(e){return ct.ecmaVersion>=5&&"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"use strict"===e.expression.value}function j(e){return St===e?(A(),!0):void 0}function F(){return!ct.strictSemicolons&&(St===Ft||St===vn||Qn.test(ht.slice(Lt,yt)))}function I(){j(bn)||F()||R()}function q(e){St===e?A():R()}function R(){n(yt,"Unexpected token")}function U(e){"Identifier"!==e.type&&"MemberExpression"!==e.type&&n(e.start,"Assigning to rvalue"),_t&&"Identifier"===e.type&&zn(e.name)&&n(e.start,"Assigning to "+e.name+" in strict mode")}function z(e){kt=Lt=gt,ct.locations&&(At=new i),Ot=_t=null,Mt=[],b();var t=e||D(),n=!0;for(e||(t.body=[]);St!==Ft;){var r=W();t.body.push(r),n&&B(r)&&O(!0),n=!1}return H(t,"Program")}function W(){St===xn&&b(!0);var e=St,t=D();switch(e){case It:case Ut:A();var r=e===It;j(bn)||F()?t.label=null:St!==jt?R():(t.label=lt(),I());for(var i=0;i<Mt.length;++i){var s=Mt[i];if(null==t.label||s.name===t.label.name){if(!(null==s.kind||!r&&"loop"!==s.kind))break;if(t.label&&r)break}}return i===Mt.length&&n(t.start,"Unsyntactic "+e.keyword),H(t,r?"BreakStatement":"ContinueStatement");case zt:return A(),I(),H(t,"DebuggerStatement");case Xt:return A(),Mt.push(er),t.body=W(),Mt.pop(),q(nn),t.test=X(),I(),H(t,"DoWhileStatement");case Jt:if(A(),Mt.push(er),q(mn),St===bn)return $(t,null);if(St===tn){var o=D();return A(),K(o,!0),1===o.declarations.length&&j(ln)?J(t,o):$(t,o)}var o=Q(!1,!0);return j(ln)?(U(o),J(t,o)):$(t,o);case Kt:return A(),at(t,!0);case Qt:return A(),t.test=X(),t.consequent=W(),t.alternate=j(Vt)?W():null,H(t,"IfStatement");case Gt:return Ot||n(yt,"'return' outside of function"),A(),j(bn)||F()?t.argument=null:(t.argument=Q(),I()),H(t,"ReturnStatement");case Yt:A(),t.discriminant=X(),t.cases=[],q(dn),Mt.push(tr);for(var u,a;St!=vn;)if(St===qt||St===Wt){var f=St===qt;u&&H(u,"SwitchCase"),t.cases.push(u=D()),u.consequent=[],A(),f?u.test=Q():(a&&n(kt,"Multiple default clauses"),a=!0,u.test=null),q(wn)}else u||R(),u.consequent.push(W());return u&&H(u,"SwitchCase"),A(),Mt.pop(),H(t,"SwitchStatement");case Zt:return A(),Qn.test(ht.slice(Lt,yt))&&n(Lt,"Illegal newline after throw"),t.argument=Q(),I(),H(t,"ThrowStatement");case en:if(A(),t.block=V(),t.handler=null,St===Rt){var l=D();A(),q(mn),l.param=lt(),_t&&zn(l.param.name)&&n(l.param.start,"Binding "+l.param.name+" in strict mode"),q(gn),l.guard=null,l.body=V(),t.handler=H(l,"CatchClause")}return t.guardedHandlers=Dt,t.finalizer=j($t)?V():null,t.handler||t.finalizer||n(t.start,"Missing catch or finally clause"),H(t,"TryStatement");case tn:return A(),t=K(t),I(),t;case nn:return A(),t.test=X(),Mt.push(er),t.body=W(),Mt.pop(),H(t,"WhileStatement");case rn:return _t&&n(yt,"'with' in strict mode"),A(),t.object=X(),t.body=W(),H(t,"WithStatement");case dn:return V();case bn:return A(),H(t,"EmptyStatement");default:var c=xt,h=Q();if(e===jt&&"Identifier"===h.type&&j(wn)){for(var i=0;i<Mt.length;++i)Mt[i].name===c&&n(h.start,"Label '"+c+"' is already declared");var p=St.isLoop?"loop":St===Yt?"switch":null;return Mt.push({name:c,kind:p}),t.body=W(),Mt.pop(),t.label=h,H(t,"LabeledStatement")}return t.expression=h,I(),H(t,"ExpressionStatement")}}function X(){q(mn);var e=Q();return q(gn),e}function V(e){var t,n=D(),r=!0,i=!1;for(n.body=[],q(dn);!j(vn);){var s=W();n.body.push(s),r&&e&&B(s)&&(t=i,O(i=!0)),r=!1}return i&&!t&&O(!1),H(n,"BlockStatement")}function $(e,t){return e.init=t,q(bn),e.test=St===bn?null:Q(),q(bn),e.update=St===gn?null:Q(),q(gn),e.body=W(),Mt.pop(),H(e,"ForStatement")}function J(e,t){return e.left=t,e.right=Q(),q(gn),e.body=W(),Mt.pop(),H(e,"ForInStatement")}function K(e,t){for(e.declarations=[],e.kind="var";;){var r=D();if(r.id=lt(),_t&&zn(r.id.name)&&n(r.id.start,"Binding "+r.id.name+" in strict mode"),r.init=j(Tn)?Q(!0,t):null,e.declarations.push(H(r,"VariableDeclarator")),!j(yn))break}return H(e,"VariableDeclaration")}function Q(e,t){var n=G(t);if(!e&&St===yn){var r=P(n);for(r.expressions=[n];j(yn);)r.expressions.push(G(t));return H(r,"SequenceExpression")}return n}function G(e){var t=Y(e);if(St.isAssign){var n=P(t);return n.operator=xt,n.left=t,A(),n.right=G(e),U(t),H(n,"AssignmentExpression")}return t}function Y(e){var t=Z(e);if(j(Sn)){var n=P(t);return n.test=t,n.consequent=Q(!0),q(wn),n.alternate=Q(!0,e),H(n,"ConditionalExpression")}return t}function Z(e){return et(tt(),-1,e)}function et(e,t,n){var r=St.binop;if(null!=r&&(!n||St!==ln)&&r>t){var i=P(e);i.left=e,i.operator=xt,A(),i.right=et(tt(),r,n);var i=H(i,/&&|\|\|/.test(i.operator)?"LogicalExpression":"BinaryExpression");return et(i,t,n)}return e}function tt(){if(St.prefix){var e=D(),t=St.isUpdate;return e.operator=xt,e.prefix=!0,A(),e.argument=tt(),t?U(e.argument):_t&&"delete"===e.operator&&"Identifier"===e.argument.type&&n(e.start,"Deleting local variable in strict mode"),H(e,t?"UpdateExpression":"UnaryExpression")}for(var r=nt();St.postfix&&!F();){var e=P(r);e.operator=xt,e.prefix=!1,e.argument=r,U(r),A(),r=H(e,"UpdateExpression")}return r}function nt(){return rt(it())}function rt(e,t){if(j(En)){var n=P(e);return n.object=e,n.property=lt(!0),n.computed=!1,rt(H(n,"MemberExpression"),t)}if(j(hn)){var n=P(e);return n.object=e,n.property=Q(),n.computed=!0,q(pn),rt(H(n,"MemberExpression"),t)}if(!t&&j(mn)){var n=P(e);return n.callee=e,n.arguments=ft(gn,!1),rt(H(n,"CallExpression"),t)}return e}function it(){switch(St){case on:var e=D();return A(),H(e,"ThisExpression");case jt:return lt();case Pt:case Bt:case Ht:var e=D();return e.value=xt,e.raw=ht.slice(yt,bt),A(),H(e,"Literal");case un:case an:case fn:var e=D();return e.value=St.atomValue,e.raw=St.keyword,A(),H(e,"Literal");case mn:var t=wt,n=yt;A();var r=Q();return r.start=n,r.end=bt,ct.locations&&(r.loc.start=t,r.loc.end=Et),ct.ranges&&(r.range=[n,bt]),q(gn),r;case hn:var e=D();return A(),e.elements=ft(pn,!0,!0),H(e,"ArrayExpression");case dn:return ot();case Kt:var e=D();return A(),at(e,!1);case sn:return st();default:R()}}function st(){var e=D();return A(),e.callee=rt(it(),!0),e.arguments=j(mn)?ft(gn,!1):Dt,H(e,"NewExpression")}function ot(){var e=D(),t=!0,r=!1;for(e.properties=[],A();!j(vn);){if(t)t=!1;else if(q(yn),ct.allowTrailingCommas&&j(vn))break;var i,s={key:ut()},o=!1;if(j(wn)?(s.value=Q(!0),i=s.kind="init"):ct.ecmaVersion>=5&&"Identifier"===s.key.type&&("get"===s.key.name||"set"===s.key.name)?(o=r=!0,i=s.kind=s.key.name,s.key=ut(),St!==mn&&R(),s.value=at(D(),!1)):R(),"Identifier"===s.key.type&&(_t||r))for(var u=0;u<e.properties.length;++u){var a=e.properties[u];if(a.key.name===s.key.name){var f=i==a.kind||o&&"init"===a.kind||"init"===i&&("get"===a.kind||"set"===a.kind);f&&!_t&&"init"===i&&"init"===a.kind&&(f=!1),f&&n(s.key.start,"Redefinition of property")}}e.properties.push(s)}return H(e,"ObjectExpression")}function ut(){return St===Pt||St===Bt?it():lt(!0)}function at(e,t){St===jt?e.id=lt():t?R():e.id=null,e.params=[];var r=!0;for(q(mn);!j(gn);)r?r=!1:q(yn),e.params.push(lt());var i=Ot,s=Mt;if(Ot=!0,Mt=[],e.body=V(!0),Ot=i,Mt=s,_t||e.body.body.length&&B(e.body.body[0]))for(var o=e.id?-1:0;o<e.params.length;++o){var u=0>o?e.id:e.params[o];if((Un(u.name)||zn(u.name))&&n(u.start,"Defining '"+u.name+"' in strict mode"),o>=0)for(var a=0;o>a;++a)u.name===e.params[a].name&&n(u.start,"Argument name clash in strict mode")}return H(e,t?"FunctionDeclaration":"FunctionExpression")}function ft(e,t,n){for(var r=[],i=!0;!j(e);){if(i)i=!1;else if(q(yn),t&&ct.allowTrailingCommas&&j(e))break;n&&St===yn?r.push(null):r.push(Q(!0))}return r}function lt(e){var t=D();return t.name=St===jt?xt:e&&!ct.forbidReserved&&St.keyword||R(),A(),H(t,"Identifier")}e.version="0.3.2";var ct,ht,pt,dt;e.parse=function(e,n){return ht=String(e),pt=ht.length,t(n),s(),z(ct.program)};var vt=e.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null},mt=e.getLineInfo=function(e,t){for(var n=1,r=0;;){Gn.lastIndex=r;var i=Gn.exec(e);if(!(i&&i.index<t))break;++n,r=i.index+i[0].length}return{line:n,column:t-r}};e.tokenize=function(e,n){function r(e){return b(e),i.start=yt,i.end=bt,i.startLoc=wt,i.endLoc=Et,i.type=St,i.value=xt,i}ht=String(e),pt=ht.length,t(n),s();var i={};return r.jumpTo=function(e,t){if(gt=e,ct.locations){Nt=1,Ct=Gn.lastIndex=0;for(var n;(n=Gn.exec(ht))&&n.index<e;)++Nt,Ct=n.index+n[0].length}Tt=t,f()},r};var gt,yt,bt,wt,Et,St,xt,Tt,Nt,Ct,kt,Lt,At,Ot,Mt,_t,Dt=[],Pt={type:"num"},Ht={type:"regexp"},Bt={type:"string"},jt={type:"name"},Ft={type:"eof"},It={keyword:"break"},qt={keyword:"case",beforeExpr:!0},Rt={keyword:"catch"},Ut={keyword:"continue"},zt={keyword:"debugger"},Wt={keyword:"default"},Xt={keyword:"do",isLoop:!0},Vt={keyword:"else",beforeExpr:!0},$t={keyword:"finally"},Jt={keyword:"for",isLoop:!0},Kt={keyword:"function"},Qt={keyword:"if"},Gt={keyword:"return",beforeExpr:!0},Yt={keyword:"switch"},Zt={keyword:"throw",beforeExpr:!0},en={keyword:"try"},tn={keyword:"var"},nn={keyword:"while",isLoop:!0},rn={keyword:"with"},sn={keyword:"new",beforeExpr:!0},on={keyword:"this"},un={keyword:"null",atomValue:null},an={keyword:"true",atomValue:!0},fn={keyword:"false",atomValue:!1},ln={keyword:"in",binop:7,beforeExpr:!0},cn={"break":It,"case":qt,"catch":Rt,"continue":Ut,"debugger":zt,"default":Wt,"do":Xt,"else":Vt,"finally":$t,"for":Jt,"function":Kt,"if":Qt,"return":Gt,"switch":Yt,"throw":Zt,"try":en,"var":tn,"while":nn,"with":rn,"null":un,"true":an,"false":fn,"new":sn,"in":ln,"instanceof":{keyword:"instanceof",binop:7,beforeExpr:!0},"this":on,"typeof":{keyword:"typeof",prefix:!0,beforeExpr:!0},"void":{keyword:"void",prefix:!0,beforeExpr:!0},"delete":{keyword:"delete",prefix:!0,beforeExpr:!0}},hn={type:"[",beforeExpr:!0},pn={type:"]"},dn={type:"{",beforeExpr:!0},vn={type:"}"},mn={type:"(",beforeExpr:!0},gn={type:")"},yn={type:",",beforeExpr:!0},bn={type:";",beforeExpr:!0},wn={type:":",beforeExpr:!0},En={type:"."},Sn={type:"?",beforeExpr:!0},xn={binop:10,beforeExpr:!0},Tn={isAssign:!0,beforeExpr:!0},Nn={isAssign:!0,beforeExpr:!0},Cn={binop:9,prefix:!0,beforeExpr:!0},kn={postfix:!0,prefix:!0,isUpdate:!0},Ln={prefix:!0,beforeExpr:!0},An={binop:1,beforeExpr:!0},On={binop:2,beforeExpr:!0},Mn={binop:3,beforeExpr:!0},_n={binop:4,beforeExpr:!0},Dn={binop:5,beforeExpr:!0},Pn={binop:6,beforeExpr:!0},Hn={binop:7,beforeExpr:!0},Bn={binop:8,beforeExpr:!0},jn={binop:10,beforeExpr:!0};e.tokTypes={bracketL:hn,bracketR:pn,braceL:dn,braceR:vn,parenL:mn,parenR:gn,comma:yn,semi:bn,colon:wn,dot:En,question:Sn,slash:xn,eq:Tn,name:jt,eof:Ft,num:Pt,regexp:Ht,string:Bt};for(var Fn in cn)e.tokTypes["_"+Fn]=cn[Fn];var In,qn=r("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),Rn=r("class enum extends super const export import"),Un=r("implements interface let package private protected public static yield"),zn=r("eval arguments"),Wn=r("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Xn=/[\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]/,Vn="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",$n="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",Jn=new RegExp("["+Vn+"]"),Kn=new RegExp("["+Vn+$n+"]"),Qn=/[\n\r\u2028\u2029]/,Gn=/\r\n|[\n\r\u2028\u2029]/g,Yn=e.isIdentifierStart=function(e){return 65>e?36===e:91>e?!0:97>e?95===e:123>e?!0:e>=170&&Jn.test(String.fromCharCode(e))},Zn=e.isIdentifierChar=function(e){return 48>e?36===e:58>e?!0:65>e?!1:91>e?!0:97>e?95===e:123>e?!0:e>=170&&Kn.test(String.fromCharCode(e))},er={kind:"loop"},tr={kind:"switch"}});var binaryOperators={"+":"_add","-":"_subtract","*":"_multiply","/":"_divide","%":"_modulo","==":"equals","!=":"equals"},unaryOperators={"-":"_negate","+":null},fields=Base.each("add,subtract,multiply,divide,modulo,negate".split(","),function(e){this["_"+e]="#"+e},{});return paper.Point.inject(fields),paper.Size.inject(fields),paper.Color.inject(fields),document.readyState==="complete"?setTimeout(load):paper.DomEvent.add(window,{load:load}),{compile:compile,evaluate:evaluate,load:load}}(this),function(){if(!this.require){var e={},t={},n=function(s,o){var u=r(o,s),a=r(u,"./index"),f,l;f=t[u]||t[a];if(f)return f.exports;if(!(l=e[u]||e[u=a]))throw"module '"+s+"' not found";f={id:u,exports:{}};try{return t[u]=f,l(f.exports,function(e){return n(e,i(u))},f),f.exports}catch(c){throw delete t[u],c}},r=function(e,t){var n=[],r,i;/^\.\.?(\/|$)/.test(t)?r=[e,t].join("/").split("/"):r=t.split("/");for(var s=0,o=r.length;s<o;s++)i=r[s],i==".."?n.pop():i!="."&&i!=""&&n.push(i);return n.join("/")},i=function(e){return e.split("/").slice(0,-1).join("/")};this.require=function(e){return n(e,"")},this.require.define=function(t){for(var n in t)e[n]=t[n]},this.require.modules=e,this.require.cache=t}return this.require.define}.call(this)({"es5-shimify/index":function(e,t,n){(function(e){typeof define=="function"?define(e):typeof YUI=="function"?YUI.add("es5",e):e()})(function(){function e(){}function A(e){return e=+e,e!==e?e=0:e!==0&&e!==1/0&&e!==-1/0&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e}function O(e){var t=typeof e;return e===null||t==="undefined"||t==="boolean"||t==="number"||t==="string"}function M(e){var t,n,r;if(O(e))return e;n=e.valueOf;if(typeof n=="function"){t=n.call(e);if(O(t))return t}r=e.toString;if(typeof r=="function"){t=r.call(e);if(O(t))return t}throw new TypeError}Function.prototype.bind||(Function.prototype.bind=function(n){var r=this;if(typeof r!="function")throw new TypeError("Function.prototype.bind called on incompatible "+r);var s=i.call(arguments,1),o=function(){if(this instanceof o){var e=r.apply(this,s.concat(i.call(arguments)));return Object(e)===e?e:this}return r.apply(n,s.concat(i.call(arguments)))};return r.prototype&&(e.prototype=r.prototype,o.prototype=new e,e.prototype=null),o});var t=Function.prototype.call,n=Array.prototype,r=Object.prototype,i=n.slice,s=t.bind(r.toString),o=t.bind(r.hasOwnProperty),u,a,f,l,c;if(c=o(r,"__defineGetter__"))u=t.bind(r.__defineGetter__),a=t.bind(r.__defineSetter__),f=t.bind(r.__lookupGetter__),l=t.bind(r.__lookupSetter__);if([1,2].splice(0).length!=2){var h=Array.prototype.splice;Array.prototype.splice=function(e,t){return arguments.length?h.apply(this,[e===void 0?0:e,t===void 0?this.length-e:t].concat(i.call(arguments,2))):[]}}if([].unshift(0)!=1){var p=Array.prototype.unshift;Array.prototype.unshift=function(){return p.apply(this,arguments),this.length}}Array.isArray||(Array.isArray=function(t){return s(t)=="[object Array]"});var d=Object("a"),v=d[0]!="a"||!(0 in d);Array.prototype.forEach||(Array.prototype.forEach=function(t){var n=_(this),r=v&&s(this)=="[object String]"?this.split(""):n,i=arguments[1],o=-1,u=r.length>>>0;if(s(t)!="[object Function]")throw new TypeError;while(++o<u)o in r&&t.call(i,r[o],o,n)}),Array.prototype.map||(Array.prototype.map=function(t){var n=_(this),r=v&&s(this)=="[object String]"?this.split(""):n,i=r.length>>>0,o=Array(i),u=arguments[1];if(s(t)!="[object Function]")throw new TypeError(t+" is not a function");for(var a=0;a<i;a++)a in r&&(o[a]=t.call(u,r[a],a,n));return o}),Array.prototype.filter||(Array.prototype.filter=function(t){var n=_(this),r=v&&s(this)=="[object String]"?this.split(""):n,i=r.length>>>0,o=[],u,a=arguments[1];if(s(t)!="[object Function]")throw new TypeError(t+" is not a function");for(var f=0;f<i;f++)f in r&&(u=r[f],t.call(a,u,f,n)&&o.push(u));return o}),Array.prototype.every||(Array.prototype.every=function(t){var n=_(this),r=v&&s(this)=="[object String]"?this.split(""):n,i=r.length>>>0,o=arguments[1];if(s(t)!="[object Function]")throw new TypeError(t+" is not a function");for(var u=0;u<i;u++)if(u in r&&!t.call(o,r[u],u,n))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t){var n=_(this),r=v&&s(this)=="[object String]"?this.split(""):n,i=r.length>>>0,o=arguments[1];if(s(t)!="[object Function]")throw new TypeError(t+" is not a function");for(var u=0;u<i;u++)if(u in r&&t.call(o,r[u],u,n))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var n=_(this),r=v&&s(this)=="[object String]"?this.split(""):n,i=r.length>>>0;if(s(t)!="[object Function]")throw new TypeError(t+" is not a function");if(!i&&arguments.length==1)throw new TypeError("reduce of empty array with no initial value");var o=0,u;if(arguments.length>=2)u=arguments[1];else do{if(o in r){u=r[o++];break}if(++o>=i)throw new TypeError("reduce of empty array with no initial value")}while(!0);for(;o<i;o++)o in r&&(u=t.call(void 0,u,r[o],o,n));return u}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(t){var n=_(this),r=v&&s(this)=="[object String]"?this.split(""):n,i=r.length>>>0;if(s(t)!="[object Function]")throw new TypeError(t+" is not a function");if(!i&&arguments.length==1)throw new TypeError("reduceRight of empty array with no initial value");var o,u=i-1;if(arguments.length>=2)o=arguments[1];else do{if(u in r){o=r[u--];break}if(--u<0)throw new TypeError("reduceRight of empty array with no initial value")}while(!0);do u in this&&(o=t.call(void 0,o,r[u],u,n));while(u--);return o});if(!Array.prototype.indexOf||[0,1].indexOf(1,2)!=-1)Array.prototype.indexOf=function(t){var n=v&&s(this)=="[object String]"?this.split(""):_(this),r=n.length>>>0;if(!r)return-1;var i=0;arguments.length>1&&(i=A(arguments[1])),i=i>=0?i:Math.max(0,r+i);for(;i<r;i++)if(i in n&&n[i]===t)return i;return-1};if(!Array.prototype.lastIndexOf||[0,1].lastIndexOf(0,-3)!=-1)Array.prototype.lastIndexOf=function(t){var n=v&&s(this)=="[object String]"?this.split(""):_(this),r=n.length>>>0;if(!r)return-1;var i=r-1;arguments.length>1&&(i=Math.min(i,A(arguments[1]))),i=i>=0?i:r-Math.abs(i);for(;i>=0;i--)if(i in n&&t===n[i])return i;return-1};if(!Object.keys){var m=!0,g=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],y=g.length;for(var b in{toString:null})m=!1;Object.keys=function D(e){if(typeof e!="object"&&typeof e!="function"||e===null)throw new TypeError("Object.keys called on a non-object");var D=[];for(var t in e)o(e,t)&&D.push(t);if(m)for(var n=0,r=y;n<r;n++){var i=g[n];o(e,i)&&D.push(i)}return D}}var w=-621987552e5,E="-000001";if(!Date.prototype.toISOString||(new Date(w)).toISOString().indexOf(E)===-1)Date.prototype.toISOString=function(){var t,n,r,i,s;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");i=this.getUTCFullYear(),s=this.getUTCMonth(),i+=Math.floor(s/12),s=(s%12+12)%12,t=[s+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],i=(i<0?"-":i>9999?"+":"")+("00000"+Math.abs(i)).slice(0<=i&&i<=9999?-4:-6),n=t.length;while(n--)r=t[n],r<10&&(t[n]="0"+r);return i+"-"+t.slice(0,2).join("-")+"T"+t.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"};var S=!1;try{S=Date.prototype.toJSON&&(new Date(NaN)).toJSON()===null&&(new Date(w)).toJSON().indexOf(E)!==-1&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(x){}S||(Date.prototype.toJSON=function(t){var n=Object(this),r=M(n),i;if(typeof r=="number"&&!isFinite(r))return null;i=n.toISOString;if(typeof i!="function")throw new TypeError("toISOString property is not callable");return i.call(n)});if(!Date.parse||"Date.parse is buggy")Date=function(e){function t(n,r,i,s,o,u,a){var f=arguments.length;if(this instanceof e){var l=f==1&&String(n)===n?new e(t.parse(n)):f>=7?new e(n,r,i,s,o,u,a):f>=6?new e(n,r,i,s,o,u):f>=5?new e(n,r,i,s,o):f>=4?new e(n,r,i,s):f>=3?new e(n,r,i):f>=2?new e(n,r):f>=1?new e(n):new e;return l.constructor=t,l}return e.apply(this,arguments)}function i(e,t){var n=t>1?1:0;return r[t]+Math.floor((e-1969+n)/4)-Math.floor((e-1901+n)/100)+Math.floor((e-1601+n)/400)+365*(e-1970)}var n=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),r=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(var s in e)t[s]=e[s];return t.now=e.now,t.UTC=e.UTC,t.prototype=e.prototype,t.prototype.constructor=t,t.parse=function(r){var s=n.exec(r);if(s){var o=Number(s[1]),u=Number(s[2]||1)-1,a=Number(s[3]||1)-1,f=Number(s[4]||0),l=Number(s[5]||0),c=Number(s[6]||0),h=Number(s[7]||0),p=!s[4]||s[8]?0:Number(new e(1970,0)),d=s[9]==="-"?1:-1,v=Number(s[10]||0),m=Number(s[11]||0),g;if(f<(l>0||c>0||h>0?24:25)&&l<60&&c<60&&h<1e3&&u>-1&&u<12&&v<24&&m<60&&a>-1&&a<i(o,u+1)-i(o,u)){g=((i(o,u)+a)*24+f+v*d)*60,g=((g+l+m*d)*60+c)*1e3+h+p;if(-864e13<=g&&g<=864e13)return g}return NaN}return e.parse.apply(this,arguments)},t}(Date);Date.now||(Date.now=function(){return(new Date).getTime()});if("0".split(void 0,0).length){var T=String.prototype.split;String.prototype.split=function(e,t){return e===void 0&&t===0?[]:T.apply(this,arguments)}}if("".substr&&"0b".substr(-1)!=="b"){var N=String.prototype.substr;String.prototype.substr=function(e,t){return N.call(this,e<0?(e=this.length+e)<0?0:e:e,t)}}var C="	\n\f\r   ᠎             　\u2028\u2029﻿";if(!String.prototype.trim||C.trim()){C="["+C+"]";var k=new RegExp("^"+C+C+"*"),L=new RegExp(C+C+"*$");String.prototype.trim=function(){if(this===undefined||this===null)throw new TypeError("can't convert "+this+" to object");return String(this).replace(k,"").replace(L,"")}}var _=function(e){if(e==null)throw new TypeError("can't convert "+e+" to object");return Object(e)}})},"json2ify/index":function(exports,require,module){typeof JSON!="object"&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()},"jqueryify/index":function(exports,require,module){(function(window,undefined){function isArraylike(e){var t=e.length,n=jQuery.type(e);return jQuery.isWindow(e)?!1:e.nodeType===1&&t?!0:n==="array"||n!=="function"&&(t===0||typeof t=="number"&&t>0&&t-1 in e)}function createOptions(e){var t=optionsCache[e]={};return jQuery.each(e.match(core_rnotwhite)||[],function(e,n){t[n]=!0}),t}function Data(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=jQuery.expando+Math.random()}function dataAttr(e,t,n){var r;if(n===undefined&&e.nodeType===1){r="data-"+t.replace(rmultiDash,"-$1").toLowerCase(),n=e.getAttribute(r);if(typeof n=="string"){try{n=n==="true"?!0:n==="false"?!1:n==="null"?null:+n+""===n?+n:rbrace.test(n)?JSON.parse(n):n}catch(i){}data_user.set(e,t,n)}else n=undefined}return n}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(e){}}function sibling(e,t){while((e=e[t])&&e.nodeType!==1);return e}function winnow(e,t,n){if(jQuery.isFunction(t))return jQuery.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return jQuery.grep(e,function(e){return e===t!==n});if(typeof t=="string"){if(isSimple.test(t))return jQuery.filter(t,e,n);t=jQuery.filter(t,e)}return jQuery.grep(e,function(e){return core_indexOf.call(t,e)>=0!==n})}function manipulationTarget(e,t){return jQuery.nodeName(e,"table")&&jQuery.nodeName(t.nodeType===1?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function disableScript(e){return e.type=(e.getAttribute("type")!==null)+"/"+e.type,e}function restoreScript(e){var t=rscriptTypeMasked.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function setGlobalEval(e,t){var n=e.length,r=0;for(;r<n;r++)data_priv.set(e[r],"globalEval",!t||data_priv.get(t[r],"globalEval"))}function cloneCopyEvent(e,t){var n,r,i,s,o,u,a,f;if(t.nodeType!==1)return;if(data_priv.hasData(e)){s=data_priv.access(e),o=jQuery.extend({},s),f=s.events,data_priv.set(t,o);if(f){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;n<r;n++)jQuery.event.add(t,i,f[i][n])}}data_user.hasData(e)&&(u=data_user.access(e),a=jQuery.extend({},u),data_user.set(t,a))}function getAll(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&jQuery.nodeName(e,t)?jQuery.merge([e],n):n}function fixInput(e,t){var n=t.nodeName.toLowerCase();if(n==="input"&&manipulation_rcheckableType.test(e.type))t.checked=e.checked;else if(n==="input"||n==="textarea")t.defaultValue=e.defaultValue}function vendorPropName(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=cssPrefixes.length;while(i--){t=cssPrefixes[i]+n;if(t in e)return t}return r}function isHidden(e,t){return e=t||e,jQuery.css(e,"display")==="none"||!jQuery.contains(e.ownerDocument,e)}function getStyles(e){return window.getComputedStyle(e,null)}function showHide(e,t){var n,r,i,s=[],o=0,u=e.length;for(;o<u;o++){r=e[o];if(!r.style)continue;s[o]=data_priv.get(r,"olddisplay"),n=r.style.display,t?(!s[o]&&n==="none"&&(r.style.display=""),r.style.display===""&&isHidden(r)&&(s[o]=data_priv.access(r,"olddisplay",css_defaultDisplay(r.nodeName)))):s[o]||(i=isHidden(r),(n&&n!=="none"||!i)&&data_priv.set(r,"olddisplay",i?n:jQuery.css(r,"display")))}for(o=0;o<u;o++){r=e[o];if(!r.style)continue;if(!t||r.style.display==="none"||r.style.display==="")r.style.display=t?s[o]||"":"none"}return e}function setPositiveNumber(e,t,n){var r=rnumsplit.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function augmentWidthOrHeight(e,t,n,r,i){var s=n===(r?"border":"content")?4:t==="width"?1:0,o=0;for(;s<4;s+=2)n==="margin"&&(o+=jQuery.css(e,n+cssExpand[s],!0,i)),r?(n==="content"&&(o-=jQuery.css(e,"padding"+cssExpand[s],!0,i)),n!=="margin"&&(o-=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i))):(o+=jQuery.css(e,"padding"+cssExpand[s],!0,i),n!=="padding"&&(o+=jQuery.css(e,"border"+cssExpand[s]+"Width",!0,i)));return o}function getWidthOrHeight(e,t,n){var r=!0,i=t==="width"?e.offsetWidth:e.offsetHeight,s=getStyles(e),o=jQuery.support.boxSizing&&jQuery.css(e,"boxSizing",!1,s)==="border-box";if(i<=0||i==null){i=curCSS(e,t,s);if(i<0||i==null)i=e.style[t];if(rnumnonpx.test(i))return i;r=o&&(jQuery.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+augmentWidthOrHeight(e,t,n||(o?"border":"content"),r,s)+"px"}function css_defaultDisplay(e){var t=document,n=elemdisplay[e];if(!n){n=actualDisplay(e,t);if(n==="none"||!n)iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(iframe[0].contentWindow||iframe[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=actualDisplay(e,t),iframe.detach();elemdisplay[e]=n}return n}function actualDisplay(e,t){var n=jQuery(t.createElement(e)).appendTo(t.body),r=jQuery.css(n[0],"display");return n.remove(),r}function buildParams(e,t,n,r){var i;if(jQuery.isArray(t))jQuery.each(t,function(t,i){n||rbracket.test(e)?r(e,i):buildParams(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&jQuery.type(t)==="object")for(i in t)buildParams(e+"["+i+"]",t[i],n,r);else r(e,t)}function addToPrefiltersOrTransports(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(core_rnotwhite)||[];if(jQuery.isFunction(n))while(r=s[i++])r[0]==="+"?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function inspectPrefiltersOrTransports(e,t,n,r){function o(u){var a;return i[u]=!0,jQuery.each(e[u]||[],function(e,u){var f=u(t,n,r);if(typeof f=="string"&&!s&&!i[f])return t.dataTypes.unshift(f),o(f),!1;if(s)return!(a=f)}),a}var i={},s=e===transports;return o(t.dataTypes[0])||!i["*"]&&o("*")}function ajaxExtend(e,t){var n,r,i=jQuery.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&jQuery.extend(!0,e,r),e}function ajaxHandleResponses(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while(a[0]==="*")a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}if(s)return s!==a[0]&&a.unshift(s),n[s]}function ajaxConvert(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s){e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift();if(s)if(s==="*")s=a;else if(a!=="*"&&a!==s){o=f[a+" "+s]||f["* "+s];if(!o)for(i in f){u=i.split(" ");if(u[1]===s){o=f[a+" "+u[0]]||f["* "+u[0]];if(o){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}}}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}}return{state:"success",data:t}}function createFxNow(){return setTimeout(function(){fxNow=undefined}),fxNow=jQuery.now()}function createTweens(e,t){jQuery.each(t,function(t,n){var r=(tweeners[t]||[]).concat(tweeners["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function Animation(e,t,n){var r,i,s=0,o=animationPrefilters.length,u=jQuery.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=fxNow||createFxNow(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;o<a;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),s<1&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:jQuery.extend({},t),opts:jQuery.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:fxNow||createFxNow(),duration:n.duration,tweens:[],createTween:function(t,n){var r=jQuery.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;i=!0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;propFilter(l,f.opts.specialEasing);for(;s<o;s++){r=animationPrefilters[s].call(f,e,l,f.opts);if(r)return r}return createTweens(f,l),jQuery.isFunction(f.opts.start)&&f.opts.start.call(e,f),jQuery.fx.timer(jQuery.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function propFilter(e,t){var n,r,i,s,o;for(n in e){r=jQuery.camelCase(n),i=t[r],s=e[n],jQuery.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=jQuery.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function defaultPrefilter(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},v=[],m=e.nodeType&&isHidden(e);n.queue||(l=jQuery._queueHooks(e,"fx"),l.unqueued==null&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,jQuery.queue(e,"fx").length||l.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],jQuery.css(e,"display")==="inline"&&jQuery.css(e,"float")==="none"&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",h.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]})),u=data_priv.get(e,"fxshow");for(r in t){s=t[r];if(rfxtypes.exec(s)){delete t[r],a=a||s==="toggle";if(s===(m?"hide":"show")){if(s!=="show"||u===undefined||u[r]===undefined)continue;m=!0}v.push(r)}}o=v.length;if(o){u=data_priv.get(e,"fxshow")||data_priv.access(e,"fxshow",{}),"hidden"in u&&(m=u.hidden),a&&(u.hidden=!m),m?jQuery(e).show():h.done(function(){jQuery(e).hide()}),h.done(function(){var t;data_priv.remove(e,"fxshow");for(t in d)jQuery.style(e,t,d[t])});for(r=0;r<o;r++)i=v[r],f=h.createTween(i,m?u[i]:0),d[i]=u[i]||jQuery.style(e,i),i in u||(u[i]=f.start,m&&(f.end=f.start,f.start=i==="width"||i==="height"?1:0))}}function Tween(e,t,n,r,i){return new Tween.prototype.init(e,t,n,r,i)}function genFx(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=cssExpand[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function getWindow(e){return jQuery.isWindow(e)?e:e.nodeType===9&&e.defaultView}var rootjQuery,readyList,core_strundefined=typeof undefined,location=window.location,document=window.document,docElem=document.documentElement,_jQuery=window.jQuery,_$=window.$,class2type={},core_deletedIds=[],core_version="2.0.0",core_concat=core_deletedIds.concat,core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_indexOf=core_deletedIds.indexOf,core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty,core_trim=core_version.trim,jQuery=function(e,t){return new jQuery.fn.init(e,t,rootjQuery)},core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,core_rnotwhite=/\S+/g,rquickExpr=/^(?:(<[\w\W]+>)[^>]*|#([\w-]*))$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(e,t){return t.toUpperCase()},completed=function(){document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1),jQuery.ready()};jQuery.fn=jQuery.prototype={jquery:core_version,constructor:jQuery,init:function(e,t,n){var r,i;if(!e)return this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?r=[null,e,null]:r=rquickExpr.exec(e);if(r&&(r[1]||!t)){if(r[1]){t=t instanceof jQuery?t[0]:t,jQuery.merge(this,jQuery.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:document,!0));if(rsingleTag.test(r[1])&&jQuery.isPlainObject(t))for(r in t)jQuery.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=document.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=document,this.selector=e,this}return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e)}return e.nodeType?(this.context=this[0]=e,this.length=1,this):jQuery.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),jQuery.makeArray(e,this))},selector:"",length:0,toArray:function(){return core_slice.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e){var t=jQuery.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return jQuery.each(this,e,t)},ready:function(e){return jQuery.ready.promise().done(e),this},slice:function(){return this.pushStack(core_slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},map:function(e){return this.pushStack(jQuery.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:core_push,sort:[].sort,splice:[].splice},jQuery.fn.init.prototype=jQuery.fn,jQuery.extend=jQuery.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;typeof o=="boolean"&&(f=o,o=arguments[1]||{},u=2),typeof o!="object"&&!jQuery.isFunction(o)&&(o={}),a===u&&(o=this,--u);for(;u<a;u++)if((e=arguments[u])!=null)for(t in e){n=o[t],r=e[t];if(o===r)continue;f&&r&&(jQuery.isPlainObject(r)||(i=jQuery.isArray(r)))?(i?(i=!1,s=n&&jQuery.isArray(n)?n:[]):s=n&&jQuery.isPlainObject(n)?n:{},o[t]=jQuery.extend(f,s,r)):r!==undefined&&(o[t]=r)}return o},jQuery.extend({expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),noConflict:function(e){return window.$===jQuery&&(window.$=_$),e&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},isReady:!1,readyWait:1,holdReady:function(e){e?jQuery.readyWait++:jQuery.ready(!0)},ready:function(e){if(e===!0?--jQuery.readyWait:jQuery.isReady)return;jQuery.isReady=!0;if(e!==!0&&--jQuery.readyWait>0)return;readyList.resolveWith(document,[jQuery]),jQuery.fn.trigger&&jQuery(document).trigger("ready").off("ready")},isFunction:function(e){return jQuery.type(e)==="function"},isArray:Array.isArray,isWindow:function(e){return e!=null&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):typeof e=="object"||typeof e=="function"?class2type[core_toString.call(e)]||"object":typeof e},isPlainObject:function(e){if(jQuery.type(e)!=="object"||e.nodeType||jQuery.isWindow(e))return!1;try{if(e.constructor&&!core_hasOwn.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){if(!e||typeof e!="string")return null;typeof t=="boolean"&&(n=t,t=!1),t=t||document;var r=rsingleTag.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=jQuery.buildFragment([e],t,i),i&&jQuery(i).remove(),jQuery.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||typeof e!="string")return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&jQuery.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code),code&&(code.indexOf("use strict")===1?(script=document.createElement("script"),script.text=code,document.head.appendChild(script).parentNode.removeChild(script)):indirect(code))},camelCase:function(e){return e.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e);if(n)if(o)for(;i<s;i++){r=t.apply(e[i],n);if(r===!1)break}else for(i in e){r=t.apply(e[i],n);if(r===!1)break}else if(o)for(;i<s;i++){r=t.call(e[i],i,e[i]);if(r===!1)break}else for(i in e){r=t.call(e[i],i,e[i]);if(r===!1)break}return e},trim:function(e){return e==null?"":core_trim.call(e)},makeArray:function(e,t){var n=t||[];return e!=null&&(isArraylike(Object(e))?jQuery.merge(n,typeof e=="string"?[e]:e):core_push.call(n,e)),n},inArray:function(e,t,n){return t==null?-1:core_indexOf.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if(typeof n=="number")for(;i<n;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=isArraylike(e),u=[];if(o)for(;i<s;i++)r=t(e[i],i,n),r!=null&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),r!=null&&(u[u.length]=r);return core_concat.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return typeof t=="string"&&(n=e[t],t=e,e=n),jQuery.isFunction(e)?(r=core_slice.call(arguments,2),i=function(){return e.apply(t||this,r.concat(core_slice.call(arguments)))},i.guid=e.guid=e.guid||jQuery.guid++,i):undefined},access:function(e,t,n,r,i,s,o){var u=0,a=e.length,f=n==null;if(jQuery.type(n)==="object"){i=!0;for(u in n)jQuery.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined){i=!0,jQuery.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(jQuery(e),n)}));if(t)for(;u<a;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)))}return i?e:f?t.call(e):a?t(e[0],n):s},now:Date.now,swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),jQuery.ready.promise=function(e){return readyList||(readyList=jQuery.Deferred(),document.readyState==="complete"?setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1))),readyList.promise(e)},jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){class2type["[object "+t+"]"]=t.toLowerCase()}),rootjQuery=jQuery(document),function(e,t){function it(e){return Q.test(e+"")}function st(){var e,t=[];return e=function(n,r){return t.push(n+=" ")>i.cacheLength&&delete e[t.shift()],e[n]=r}}function ot(e){return e[y]=!0,e}function ut(e){var t=c.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function at(e,t,n,r){var i,s,o,u,a,f,h,v,m,E;(t?t.ownerDocument||t:b)!==c&&l(t),t=t||c,n=n||[];if(!e||typeof e!="string")return n;if((u=t.nodeType)!==1&&u!==9)return[];if(p&&!r){if(i=G.exec(e))if(o=i[1]){if(u===9){s=t.getElementById(o);if(!s||!s.parentNode)return n;if(s.id===o)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&g(t,s)&&s.id===o)return n.push(s),n}else{if(i[2])return D.apply(n,t.getElementsByTagName(e)),n;if((o=i[3])&&w.getElementsByClassName&&t.getElementsByClassName)return D.apply(n,t.getElementsByClassName(o)),n}if(w.qsa&&(!d||!d.test(e))){v=h=y,m=t,E=u===9&&e;if(u===1&&t.nodeName.toLowerCase()!=="object"){f=vt(e),(h=t.getAttribute("id"))?v=h.replace(et,"\\$&"):t.setAttribute("id",v),v="[id='"+v+"'] ",a=f.length;while(a--)f[a]=v+mt(f[a]);m=X.test(e)&&t.parentNode||t,E=f.join(",")}if(E)try{return D.apply(n,m.querySelectorAll(E)),n}catch(S){}finally{h||t.removeAttribute("id")}}}return Tt(e.replace(U,"$1"),t,n,r)}function ft(e,t){var n=t&&e,r=n&&(~t.sourceIndex||A)-(~e.sourceIndex||A);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function lt(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}function ct(e,n,r){var i;return r?t:i=e.getAttribute(n,n.toLowerCase()==="type"?1:2)}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function dt(e){return ot(function(t){return t=+t,ot(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(e,t){var n,r,s,o,u,a,f,l=T[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=z.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(s=[]);n=!1;if(r=W.exec(u))n=r.shift(),s.push({value:n,type:r[0].replace(U," ")}),u=u.slice(n.length);for(o in i.filter)(r=K[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(n=r.shift(),s.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?at.error(e):T(e,a).slice(0)}function mt(e){var t=0,n=e.length,r="";for(;t<n;t++)r+=e[t].value;return r}function gt(e,t,n){var i=t.dir,s=n&&i==="parentNode",o=S++;return t.first?function(t,n,r){while(t=t[i])if(t.nodeType===1||s)return e(t,n,r)}:function(t,n,u){var a,f,l,c=E+" "+o;if(u){while(t=t[i])if(t.nodeType===1||s)if(e(t,n,u))return!0}else while(t=t[i])if(t.nodeType===1||s){l=t[y]||(t[y]={});if((f=l[i])&&f[0]===c){if((a=f[1])===!0||a===r)return a===!0}else{f=l[i]=[c],f[1]=e(t,n,u)||r;if(f[1]===!0)return!0}}}}function yt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function bt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function wt(e,t,n,r,i,s){return r&&!r[y]&&(r=wt(r)),i&&!i[y]&&(i=wt(i,s)),ot(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||xt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?bt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=bt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?H.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=bt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):D.apply(o,g)})}function Et(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],f=o?1:0,l=gt(function(e){return e===t},u,!0),c=gt(function(e){return H.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==a)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;f<s;f++)if(n=i.relative[e[f].type])h=[gt(yt(h),n)];else{n=i.filter[e[f].type].apply(null,e[f].matches);if(n[y]){r=++f;for(;r<s;r++)if(i.relative[e[r].type])break;return wt(f>1&&yt(h),f>1&&mt(e.slice(0,f-1)).replace(U,"$1"),n,f<r&&Et(e.slice(f,r)),r<s&&Et(e=e.slice(r)),r<s&&mt(e))}h.push(n)}return yt(h)}function St(e,t){var n=0,s=t.length>0,o=e.length>0,u=function(u,f,l,h,p){var d,v,m,g=[],y=0,b="0",w=u&&[],S=p!=null,x=a,T=u||o&&i.find.TAG("*",p&&f.parentNode||f),N=E+=x==null?1:Math.random()||.1;S&&(a=f!==c&&f,r=n);for(;(d=T[b])!=null;b++){if(o&&d){v=0;while(m=e[v++])if(m(d,f,l)){h.push(d);break}S&&(E=N,r=++n)}s&&((d=!m&&d)&&y--,u&&w.push(d))}y+=b;if(s&&b!==y){v=0;while(m=t[v++])m(w,g,f,l);if(u){if(y>0)while(b--)!w[b]&&!g[b]&&(g[b]=M.call(h));g=bt(g)}D.apply(h,g),S&&!u&&g.length>0&&y+t.length>1&&at.uniqueSort(h)}return S&&(E=N,a=x),w};return s?ot(u):u}function xt(e,t,n){var r=0,i=t.length;for(;r<i;r++)at(e,t[r],n);return n}function Tt(e,t,n,r){var s,o,a,f,l,c=vt(e);if(!r&&c.length===1){o=c[0]=c[0].slice(0);if(o.length>2&&(a=o[0]).type==="ID"&&t.nodeType===9&&p&&i.relative[o[1].type]){t=(i.find.ID(a.matches[0].replace(tt,nt),t)||[])[0];if(!t)return n;e=e.slice(o.shift().value.length)}s=K.needsContext.test(e)?0:o.length;while(s--){a=o[s];if(i.relative[f=a.type])break;if(l=i.find[f])if(r=l(a.matches[0].replace(tt,nt),X.test(o[0].type)&&t.parentNode||t)){o.splice(s,1),e=r.length&&mt(o);if(!e)return D.apply(n,r),n;break}}}return u(e,c)(r,t,!p,n,X.test(e)),n}function Nt(){}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y="sizzle"+ -(new Date),b=e.document,w={},E=0,S=0,x=st(),T=st(),N=st(),C=!1,k=function(){return 0},L=typeof t,A=1<<31,O=[],M=O.pop,_=O.push,D=O.push,P=O.slice,H=O.indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",j="[\\x20\\t\\r\\n\\f]",F="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",I=F.replace("w","w#"),q="\\["+j+"*("+F+")"+j+"*(?:([*^$|!~]?=)"+j+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+I+")|)|)"+j+"*\\]",R=":("+F+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+q.replace(3,8)+")*)|.*)\\)|)",U=new RegExp("^"+j+"+|((?:^|[^\\\\])(?:\\\\.)*)"+j+"+$","g"),z=new RegExp("^"+j+"*,"+j+"*"),W=new RegExp("^"+j+"*([>+~]|"+j+")"+j+"*"),X=new RegExp(j+"*[+~]"),V=new RegExp("="+j+"*([^\\]'\"]*)"+j+"*\\]","g"),$=new RegExp(R),J=new RegExp("^"+I+"$"),K={ID:new RegExp("^#("+F+")"),CLASS:new RegExp("^\\.("+F+")"),TAG:new RegExp("^("+F.replace("w","w*")+")"),ATTR:new RegExp("^"+q),PSEUDO:new RegExp("^"+R),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+j+"*(even|odd|(([+-]|)(\\d*)n|)"+j+"*(?:([+-]|)"+j+"*(\\d+)|))"+j+"*\\)|)","i"),"boolean":new RegExp("^(?:"+B+")$","i"),needsContext:new RegExp("^"+j+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+j+"*((?:-\\d)?\\d*)"+j+"*\\)|)(?=[^-]|$)","i")},Q=/^[^{]+\{\s*\[native \w/,G=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Y=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,et=/'|\\/g,tt=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,nt=function(e,t){var n="0x"+t-65536;return n!==n?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)};try{D.apply(O=P.call(b.childNodes),b.childNodes),O[b.childNodes.length].nodeType}catch(rt){D={apply:O.length?function(e,t){_.apply(e,P.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}o=at.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},l=at.setDocument=function(e){var n=e?e.ownerDocument||e:b;if(n===c||n.nodeType!==9||!n.documentElement)return c;c=n,h=n.documentElement,p=!o(n),w.getElementsByTagName=ut(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),w.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")}),w.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",e.getElementsByClassName("i").length===2}),w.sortDetached=ut(function(e){return e.compareDocumentPosition(c.createElement("div"))&1}),w.getById=ut(function(e){return h.appendChild(e).id=y,!n.getElementsByName||!n.getElementsByName(y).length}),w.getById?(i.find.ID=function(e,t){if(typeof t.getElementById!==L&&p){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},i.filter.ID=function(e){var t=e.replace(tt,nt);return function(e){return e.getAttribute("id")===t}}):(i.find.ID=function(e,n){if(typeof n.getElementById!==L&&p){var r=n.getElementById(e);return r?r.id===e||typeof r.getAttributeNode!==L&&r.getAttributeNode("id").value===e?[r]:t:[]}},i.filter.ID=function(e){var t=e.replace(tt,nt);return function(e){var n=typeof e.getAttributeNode!==L&&e.getAttributeNode("id");return n&&n.value===t}}),i.find.TAG=w.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==L)return t.getElementsByTagName(e)}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if(e==="*"){while(n=s[i++])n.nodeType===1&&r.push(n);return r}return s},i.find.CLASS=w.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==L&&p)return t.getElementsByClassName(e)},v=[],d=[];if(w.qsa=it(n.querySelectorAll))ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+j+"*(?:value|"+B+")"),e.querySelectorAll(":checked").length||d.push(":checked")}),ut(function(e){var t=c.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&d.push("[*^$]="+j+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||d.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),d.push(",.*:")});return(w.matchesSelector=it(m=h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&ut(function(e){w.disconnectedMatch=m.call(e,"div"),m.call(e,"[s!='']:x"),v.push("!=",R)}),d=d.length&&new RegExp(d.join("|")),v=v.length&&new RegExp(v.join("|")),g=it(h.contains)||h.compareDocumentPosition?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&r.nodeType===1&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&e.compareDocumentPosition(r)&16)}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},k=h.compareDocumentPosition?function(e,t){if(e===t)return C=!0,0;var r=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);if(r)return r&1||!w.sortDetached&&t.compareDocumentPosition(e)===r?e===n||g(b,e)?-1:t===n||g(b,t)?1:f?H.call(f,e)-H.call(f,t):0:r&4?-1:1;return e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(e===t)return C=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:f?H.call(f,e)-H.call(f,t):0;if(s===o)return ft(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?ft(u[i],a[i]):u[i]===b?-1:a[i]===b?1:0},c},at.matches=function(e,t){return at(e,null,null,t)},at.matchesSelector=function(e,t){(e.ownerDocument||e)!==c&&l(e),t=t.replace(V,"='$1']");if(w.matchesSelector&&p&&(!v||!v.test(t))&&(!d||!d.test(t)))try{var n=m.call(e,t);if(n||w.disconnectedMatch||e.document&&e.document.nodeType!==11)return n}catch(r){}return at(t,c,null,[e]).length>0},at.contains=function(e,t){return(e.ownerDocument||e)!==c&&l(e),g(e,t)},at.attr=function(e,n){(e.ownerDocument||e)!==c&&l(e);var r=i.attrHandle[n.toLowerCase()],s=r&&r(e,n,!p);return s===t?w.attributes||!p?e.getAttribute(n):(s=e.getAttributeNode(n))&&s.specified?s.value:null:s},at.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},at.uniqueSort=function(e){var t,n=[],r=0,i=0;C=!w.detectDuplicates,f=!w.sortStable&&e.slice(0),e.sort(k);if(C){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return e},s=at.getText=function(e){var t,n="",r=0,i=e.nodeType;if(!i)for(;t=e[r];r++)n+=s(t);else if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue;return n},i=at.selectors={cacheLength:50,createPseudo:ot,match:K,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(tt,nt),e[3]=(e[4]||e[5]||"").replace(tt,nt),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1].slice(0,3)==="nth"?(e[3]||at.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*(e[3]==="even"||e[3]==="odd")),e[5]=+(e[7]+e[8]||e[3]==="odd")):e[3]&&at.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2];return K.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&$.test(n)&&(t=vt(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(tt,nt).toLowerCase();return e==="*"?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=x[e+" "];return t||(t=new RegExp("(^|"+j+")"+e+"("+j+"|$)"))&&x(e,function(e){return t.test(typeof e.className=="string"&&e.className||typeof e.getAttribute!==L&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=at.attr(r,e);return i==null?t==="!=":t?(i+="",t==="="?i===n:t==="!="?i!==n:t==="^="?n&&i.indexOf(n)===0:t==="*="?n&&i.indexOf(n)>-1:t==="$="?n&&i.slice(-n.length)===n:t==="~="?(" "+i+" ").indexOf(n)>-1:t==="|="?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s=e.slice(0,3)!=="nth",o=e.slice(-4)!=="last",u=t==="of-type";return r===1&&i===0?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),b=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;d=v=e==="only"&&!d&&"nextSibling"}return!0}d=[o?m.firstChild:m.lastChild];if(o&&b){l=m[y]||(m[y]={}),f=l[e]||[],p=f[0]===E&&f[1],h=f[0]===E&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(c.nodeType===1&&++h&&c===t){l[e]=[E,p,h];break}}else if(b&&(f=(t[y]||(t[y]={}))[e])&&f[0]===E)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++h){b&&((c[y]||(c[y]={}))[e]=[E,h]);if(c===t)break}return h-=i,h===r||h%r===0&&h/r>=0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||at.error("unsupported pseudo: "+e);return r[y]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?ot(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=H.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:ot(function(e){var t=[],n=[],r=u(e.replace(U,"$1"));return r[y]?ot(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:ot(function(e){return function(t){return at(e,t).length>0}}),contains:ot(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),lang:ot(function(e){return J.test(e||"")||at.error("unsupported lang: "+e),e=e.replace(tt,nt).toLowerCase(),function(t){var n;do if(n=p?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||n.indexOf(e+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===c.activeElement&&(!c.hasFocus||c.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||e.nodeType===3||e.nodeType===4)return!1;return!0},parent:function(e){return!i.pseudos.empty(e)},header:function(e){return Z.test(e.nodeName)},input:function(e){return Y.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},text:function(e){var t;return e.nodeName.toLowerCase()==="input"&&e.type==="text"&&((t=e.getAttribute("type"))==null||t.toLowerCase()===e.type)},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[n<0?n+t:n]}),even:dt(function(e,t){var n=0;for(;n<t;n+=2)e.push(n);return e}),odd:dt(function(e,t){var n=1;for(;n<t;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){var r=n<0?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){var r=n<0?n+t:n;for(;++r<t;)e.push(r);return e})}};for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[n]=ht(n);for(n in{submit:!0,reset:!0})i.pseudos[n]=pt(n);u=at.compile=function(e,t){var n,r=[],i=[],s=N[e+" "];if(!s){t||(t=vt(e)),n=t.length;while(n--)s=Et(t[n]),s[y]?r.push(s):i.push(s);s=N(e,St(i,r))}return s},i.pseudos.nth=i.pseudos.eq,Nt.prototype=i.filters=i.pseudos,i.setFilters=new Nt,w.sortStable=y.split("").sort(k).join("")===y,l(),[0,0].sort(k),w.detectDuplicates=C,ut(function(e){e.innerHTML="<a href='#'></a>";if(e.firstChild.getAttribute("href")!=="#"){var t="type|href|height|width".split("|"),n=t.length;while(n--)i.attrHandle[t[n]]=ct}}),ut(function(e){if(e.getAttribute("disabled")!=null){var t=B.split("|"),n=t.length;while(n--)i.attrHandle[t[n]]=lt}}),jQuery.find=at,jQuery.expr=at.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=at.uniqueSort,jQuery.text=at.getText,jQuery.isXMLDoc=at.isXML,jQuery.contains=at.contains}(window);var optionsCache={};jQuery.Callbacks=function(e){e=typeof e=="string"?optionsCache[e]||createOptions(e):jQuery.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(c){t=e.memory&&c,n=!0,o=i||0,i=0,s=u.length,r=!0;for(;u&&o<s;o++)if(u[o].apply(c[0],c[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){jQuery.each(t,function(t,n){var r=jQuery.type(n);r==="function"?(!e.unique||!l.has(n))&&u.push(n):n&&n.length&&r!=="string"&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&jQuery.each(arguments,function(e,t){var n;while((n=jQuery.inArray(t,u,n))>-1)u.splice(n,1),r&&(n<=s&&s--,n<=o&&o--)}),this},has:function(e){return e?jQuery.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],u&&(!n||a)&&(r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},jQuery.extend({Deferred:function(e){var t=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return jQuery.Deferred(function(n){jQuery.each(t,function(t,s){var o=s[0],u=jQuery.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&jQuery.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return e!=null?jQuery.extend(e,r):r}},i={};return r.pipe=r.then,jQuery.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=core_slice.call(arguments),r=n.length,i=r!==1||e&&jQuery.isFunction(e.promise)?r:0,s=i===1?e:jQuery.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?core_slice.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&jQuery.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),jQuery.support=function(e){var t=document.createElement("input"),n=document.createDocumentFragment(),r=document.createElement("div"),i=document.createElement("select"),s=i.appendChild(document.createElement("option"));return t.type?(t.type="checkbox",e.checkOn=t.value!=="",e.optSelected=s.selected,e.reliableMarginRight=!0,e.boxSizingReliable=!0,e.pixelPosition=!1,t.checked=!0,e.noCloneChecked=t.cloneNode(!0).checked,i.disabled=!0,e.optDisabled=!s.disabled,t=document.createElement("input"),t.value="t",t.type="radio",e.radioValue=t.value==="t",t.setAttribute("checked","t"),t.setAttribute("name","t"),n.appendChild(t),e.checkClone=n.cloneNode(!0).cloneNode(!0).lastChild.checked,e.focusinBubbles="onfocusin"in window,r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle=r.style.backgroundClip==="content-box",jQuery(function(){var t,n,i="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",s=document.getElementsByTagName("body")[0];if(!s)return;t=document.createElement("div"),t.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",s.appendChild(t).appendChild(r),r.innerHTML="",r.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",jQuery.swap(s,s.style.zoom!=null?{zoom:1}:{},function(){e.boxSizing=r.offsetWidth===4}),window.getComputedStyle&&(e.pixelPosition=(window.getComputedStyle(r,null)||{}).top!=="1%",e.boxSizingReliable=(window.getComputedStyle(r,null)||{width:"4px"}).width==="4px",n=r.appendChild(document.createElement("div")),n.style.cssText=r.style.cssText=i,n.style.marginRight=n.style.width="0",r.style.width="1px",e.reliableMarginRight=!parseFloat((window.getComputedStyle(n,null)||{}).marginRight)),s.removeChild(t)}),e):e}({});var data_user,data_priv,rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;Data.uid=1,Data.accepts=function(e){return e.nodeType?e.nodeType===1||e.nodeType===9:!0},Data.prototype={key:function(e){if(!Data.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=Data.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,jQuery.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if(typeof t=="string")s[t]=n;else if(jQuery.isEmptyObject(s))this.cache[i]=t;else for(r in t)s[r]=t[r]},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){return t===undefined||t&&typeof t=="string"&&n===undefined?this.get(e,t):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i=this.key(e),s=this.cache[i];if(t===undefined)this.cache[i]={};else{jQuery.isArray(t)?r=t.concat(t.map(jQuery.camelCase)):t in s?r=[t]:(r=jQuery.camelCase(t),r=r in s?[r]:r.match(core_rnotwhite)||[]),n=r.length;while(n--)delete s[r[n]]}},hasData:function(e){return!jQuery.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){delete this.cache[this.key(e)]}},data_user=new Data,data_priv=new Data,jQuery.extend({acceptData:Data.accepts,hasData:function(e){return data_user.hasData(e)||data_priv.hasData(e)},data:function(e,t,n){return data_user.access(e,t,n)},removeData:function(e,t){data_user.remove(e,t)},_data:function(e,t,n){return data_priv.access(e,t,n)},_removeData:function(e,t){data_priv.remove(e,t)}}),jQuery.fn.extend({data:function(e,t){var n,r,i=this[0],s=0,o=null;if(e===undefined){if(this.length){o=data_user.get(i);if(i.nodeType===1&&!data_priv.get(i,"hasDataAttrs")){n=i.attributes;for(;s<n.length;s++)r=n[s].name,r.indexOf("data-")===0&&(r=jQuery.camelCase(r.substring(5)),dataAttr(i,r,o[r]));data_priv.set(i,"hasDataAttrs",!0)}}return o}return typeof e=="object"?this.each(function(){data_user.set(this,e)}):jQuery.access(this,function(t){var n,r=jQuery.camelCase(e);if(i&&t===undefined){n=data_user.get(i,e);if(n!==undefined)return n;n=data_user.get(i,r);if(n!==undefined)return n;n=dataAttr(i,r,undefined);if(n!==undefined)return n;return}this.each(function(){var n=data_user.get(this,r);data_user.set(this,r,t),e.indexOf("-")!==-1&&n!==undefined&&data_user.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){data_user.remove(this,e)})}}),jQuery.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=data_priv.get(e,t),n&&(!r||jQuery.isArray(n)?r=data_priv.access(e,t,jQuery.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=jQuery.queue(e,t),r=n.length,i=n.shift(),s=jQuery._queueHooks(e,t),o=function(){jQuery.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),s.cur=i,i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return data_priv.get(e,n)||data_priv.access(e,n,{empty:jQuery.Callbacks("once memory").add(function(){data_priv.remove(e,[t+"queue",n])})})}}),jQuery.fn.extend({queue:function(e,t){var n=2;return typeof e!="string"&&(t=e,e="fx",n--),arguments.length<n?jQuery.queue(this[0],e):t===undefined?this:this.each(function(){var n=jQuery.queue(this,e,t);jQuery._queueHooks(this,e),e==="fx"&&n[0]!=="inprogress"&&jQuery.dequeue(this,e)})},dequeue:function(e){return this.each(function(){jQuery.dequeue(this,e)})},delay:function(e,t){return e=jQuery.fx?jQuery.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=jQuery.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};typeof e!="string"&&(t=e,e=undefined),e=e||"fx";while(o--)n=data_priv.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var nodeHook,boolHook,rclass=/[\t\r\n]/g,rreturn=/\r/g,rfocusable=/^(?:input|select|textarea|button)$/i;jQuery.fn.extend({attr:function(e,t){return jQuery.access(this,jQuery.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){jQuery.removeAttr(this,e)})},prop:function(e,t){return jQuery.access(this,jQuery.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[jQuery.propFix[e]||e]})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=typeof e=="string"&&e;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).addClass(e.call(this,t,this.className))});if(a){t=(e||"").match(core_rnotwhite)||[];for(;o<u;o++){n=this[o],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):" ");if(r){s=0;while(i=t[s++])r.indexOf(" "+i+" ")<0&&(r+=i+" ");n.className=jQuery.trim(r)}}}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=arguments.length===0||typeof e=="string"&&e;if(jQuery.isFunction(e))return this.each(function(t){jQuery(this).removeClass(e.call(this,t,this.className))});if(a){t=(e||"").match(core_rnotwhite)||[];for(;o<u;o++){n=this[o],r=n.nodeType===1&&(n.className?(" "+n.className+" ").replace(rclass," "):"");if(r){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?jQuery.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return jQuery.isFunction(e)?this.each(function(n){jQuery(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=jQuery(this),u=t,a=e.match(core_rnotwhite)||[];while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n===core_strundefined||n==="boolean")this.className&&data_priv.set(this,"__className__",this.className),this.className=this.className||e===!1?"":data_priv.get(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(rclass," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];if(!arguments.length){if(i)return t=jQuery.valHooks[i.type]||jQuery.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,typeof n=="string"?n.replace(rreturn,""):n==null?"":n);return}return r=jQuery.isFunction(e),this.each(function(n){var i,s=jQuery(this);if(this.nodeType!==1)return;r?i=e.call(this,n,s.val()):i=e,i==null?i="":typeof i=="number"?i+="":jQuery.isArray(i)&&(i=jQuery.map(i,function(e){return e==null?"":e+""})),t=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!t||!("set"in t)||t.set(this,i,"value")===undefined)this.value=i})}}),jQuery.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(jQuery.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!jQuery.nodeName(n.parentNode,"optgroup"))){t=jQuery(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n,r,i=e.options,s=jQuery.makeArray(t),o=i.length;while(o--){r=i[o];if(r.selected=jQuery.inArray(jQuery(r).val(),s)>=0)n=!0}return n||(e.selectedIndex=-1),s}}},attr:function(e,t,n){var r,i,s=e.nodeType;if(!e||s===3||s===8||s===2)return;if(typeof e.getAttribute===core_strundefined)return jQuery.prop(e,t,n);if(s!==1||!jQuery.isXMLDoc(e))t=t.toLowerCase(),r=jQuery.attrHooks[t]||(jQuery.expr.match.boolean.test(t)?boolHook:nodeHook);if(n===undefined)return r&&"get"in r&&(i=r.get(e,t))!==null?i:(i=jQuery.find.attr(e,t),i==null?undefined:i);if(n!==null)return r&&"set"in r&&(i=r.set(e,n,t))!==undefined?i:(e.setAttribute(t,n+""),n);jQuery.removeAttr(e,t)},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(core_rnotwhite);if(s&&e.nodeType===1)while(n=s[i++])r=jQuery.propFix[n]||n,jQuery.expr.match.boolean.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!jQuery.support.radioValue&&t==="radio"&&jQuery.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(!e||o===3||o===8||o===2)return;return s=o!==1||!jQuery.isXMLDoc(e),s&&(t=jQuery.propFix[t]||t,i=jQuery.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&(r=i.get(e,t))!==null?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||rfocusable.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),boolHook={set:function(e,t,n){return t===!1?jQuery.removeAttr(e,n):e.setAttribute(n,n),n}},jQuery.each(jQuery.expr.match.boolean.source.match(/\w+/g),function(e,t){var n=jQuery.expr.attrHandle[t]||jQuery.find.attr;jQuery.expr.attrHandle[t]=function(e,t,r){var i=jQuery.expr.attrHandle[t],s=r?undefined:(jQuery.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return jQuery.expr.attrHandle[t]=i,s}}),jQuery.support.optSelected||(jQuery.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(e,t){if(jQuery.isArray(t))return e.checked=jQuery.inArray(jQuery(e).val(),t)>=0}},jQuery.support.checkOn||(jQuery.valHooks[this].get=function(e){return e.getAttribute("value")===null?"on":e.value})});var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.get(e);if(!m)return;n.handler&&(s=n,n=s.handler,i=s.selector),n.guid||(n.guid=jQuery.guid++),(a=m.events)||(a=m.events={}),(o=m.handle)||(o=m.handle=function(e){return typeof jQuery===core_strundefined||!!e&&jQuery.event.triggered===e.type?undefined:jQuery.event.dispatch.apply(o.elem,arguments)},o.elem=e),t=(t||"").match(core_rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p)continue;c=jQuery.event.special[p]||{},p=(i?c.delegateType:c.bindType)||p,c=jQuery.event.special[p]||{},l=jQuery.extend({type:p,origType:v,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&jQuery.expr.match.needsContext.test(i),namespace:d.join(".")},s),(h=a[p])||(h=a[p]=[],h.delegateCount=0,(!c.setup||c.setup.call(e,r,d,o)===!1)&&e.addEventListener&&e.addEventListener(p,o,!1)),c.add&&(c.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),i?h.splice(h.delegateCount++,0,l):h.push(l),jQuery.event.global[p]=!0}e=null},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=data_priv.hasData(e)&&data_priv.get(e);if(!m||!(a=m.events))return;t=(t||"").match(core_rnotwhite)||[""],f=t.length;while(f--){u=rtypenamespace.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort();if(!p){for(p in a)jQuery.event.remove(e,p+t[f],n,r,!0);continue}c=jQuery.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],(i||v===l.origType)&&(!n||n.guid===l.guid)&&(!u||u.test(l.namespace))&&(!r||r===l.selector||r==="**"&&l.selector)&&(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&((!c.teardown||c.teardown.call(e,d,m.handle)===!1)&&jQuery.removeEvent(e,p,m.handle),delete a[p])}jQuery.isEmptyObject(a)&&(delete m.handle,data_priv.remove(e,"events"))},trigger:function(e,t,n,r){var i,s,o,u,a,f,l,c=[n||document],h=core_hasOwn.call(e,"type")?e.type:e,p=core_hasOwn.call(e,"namespace")?e.namespace.split("."):[];s=o=n=n||document;if(n.nodeType===3||n.nodeType===8)return;if(rfocusMorph.test(h+jQuery.event.triggered))return;h.indexOf(".")>=0&&(p=h.split("."),h=p.shift(),p.sort()),a=h.indexOf(":")<0&&"on"+h,e=e[jQuery.expando]?e:new jQuery.Event(h,typeof e=="object"&&e),e.isTrigger=r?2:3,e.namespace=p.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=undefined,e.target||(e.target=n),t=t==null?[e]:jQuery.makeArray(t,[e]),l=jQuery.event.special[h]||{};if(!r&&l.trigger&&l.trigger.apply(n,t)===!1)return;if(!r&&!l.noBubble&&!jQuery.isWindow(n)){u=l.delegateType||h,rfocusMorph.test(u+h)||(s=s.parentNode);for(;s;s=s.parentNode)c.push(s),o=s;o===(n.ownerDocument||document)&&c.push(o.defaultView||o.parentWindow||window)}i=0;while((s=c[i++])&&!e.isPropagationStopped())e.type=i>1?u:l.bindType||h,f=(data_priv.get(s,"events")||{})[e.type]&&data_priv.get(s,"handle"),f&&f.apply(s,t),f=a&&s[a],f&&jQuery.acceptData(s)&&f.apply&&f.apply(s,t)===!1&&e.preventDefault();return e.type=h,!r&&!e.isDefaultPrevented()&&(!l._default||l._default.apply(c.pop(),t)===!1)&&jQuery.acceptData(n)&&a&&jQuery.isFunction(n[h])&&!jQuery.isWindow(n)&&(o=n[a],o&&(n[a]=null),jQuery.event.triggered=h,n[h](),jQuery.event.triggered=undefined,o&&(n[a]=o)),e.result},dispatch:function(e){e=jQuery.event.fix(e);var t,n,r,i,s,o=[],u=core_slice.call(arguments),a=(data_priv.get(this,"events")||{})[e.type]||[],f=jQuery.event.special[e.type]||{};u[0]=e,e.delegateTarget=this;if(f.preDispatch&&f.preDispatch.call(this,e)===!1)return;o=jQuery.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())if(!e.namespace_re||e.namespace_re.test(s.namespace))e.handleObj=s,e.data=s.data,r=((jQuery.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation())}return f.postDispatch&&f.postDispatch.call(this,e),e.result},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||e.type!=="click"))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||e.type!=="click"){r=[];for(n=0;n<u;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?jQuery(i,this).index(a)>=0:jQuery.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return u<t.length&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return e.pageX==null&&t.clientX!=null&&(n=e.target.ownerDocument||document,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),!e.which&&s!==undefined&&(e.which=s&1?1:s&2?3:s&4?2:0),e}},fix:function(e){if(e[jQuery.expando])return e;var t,n,r,i=e.type,s=e,o=this.fixHooks[i];o||(this.fixHooks[i]=o=rmouseEvent.test(i)?this.mouseHooks:rkeyEvent.test(i)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new jQuery.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target.nodeType===3&&(e.target=e.target.parentNode),o.filter?o.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input"))return this.click(),!1},_default:function(e){return jQuery.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=jQuery.extend(new jQuery.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?jQuery.event.trigger(i,null,t):jQuery.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},jQuery.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},jQuery.Event=function(e,t){if(!(this instanceof jQuery.Event))return new jQuery.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?returnTrue:returnFalse):this.type=e,t&&jQuery.extend(this,t),this.timeStamp=e&&e.timeStamp||jQuery.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){jQuery.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;if(!i||i!==r&&!jQuery.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),jQuery.support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){jQuery.event.simulate(t,e.target,jQuery.event.fix(e),!0)};jQuery.event.special[t]={setup:function(){n++===0&&document.addEventListener(e,r,!0)},teardown:function(){--n===0&&document.removeEventListener(e,r,!0)}}}),jQuery.fn.extend({on:function(e,t,n,r,i){var s,o;if(typeof e=="object"){typeof t!="string"&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}n==null&&r==null?(r=t,n=t=undefined):r==null&&(typeof t=="string"?(r=n,n=undefined):(r=n,n=t,t=undefined));if(r===!1)r=returnFalse;else if(!r)return this;return i===1&&(s=r,r=function(e){return jQuery().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,jQuery(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if(typeof e=="object"){for(i in e)this.off(i,t,e[i]);return this}if(t===!1||typeof t=="function")n=t,t=undefined;return n===!1&&(n=returnFalse),this.each(function(){jQuery.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){jQuery.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return jQuery.event.trigger(e,t,n,!0)}});var isSimple=/^.[^:#\[\.,]*$/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({find:function(e){var t,n,r,i=this.length;if(typeof e!="string")return t=this,this.pushStack(jQuery(e).filter(function(){for(r=0;r<i;r++)if(jQuery.contains(t[r],this))return!0}));n=[];for(r=0;r<i;r++)jQuery.find(e,this[r],n);return n=this.pushStack(i>1?jQuery.unique(n):n),n.selector=(this.selector?this.selector+" ":"")+e,n},has:function(e){var t=jQuery(e,this),n=t.length;return this.filter(function(){var e=0;for(;e<n;e++)if(jQuery.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(winnow(this,e||[],!0))},filter:function(e){return this.pushStack(winnow(this,e||[],!1))},is:function(e){return!!e&&(typeof e=="string"?rneedsContext.test(e)?jQuery(e,this.context).index(this[0])>=0:jQuery.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=rneedsContext.test(e)||typeof e!="string"?jQuery(e,t||this.context):0;for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:n.nodeType===1&&jQuery.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?jQuery.unique(s):s)},index:function(e){return e?typeof e=="string"?core_indexOf.call(jQuery(e),this[0]):core_indexOf.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?jQuery(e,t):jQuery.makeArray(e&&e.nodeType?[e]:e),r=jQuery.merge(this.get(),n);return this.pushStack(jQuery.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),jQuery.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return jQuery.dir(e,"parentNode")},parentsUntil:function(e,t,n){return jQuery.dir(e,"parentNode",n)},next:function(e){return sibling(e,"nextSibling")},prev:function(e){return sibling(e,"previousSibling")},nextAll:function(e){return jQuery.dir(e,"nextSibling")},prevAll:function(e){return jQuery.dir(e,"previousSibling")},nextUntil:function(e,t,n){return jQuery.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return jQuery.dir(e,"previousSibling",n)},siblings:function(e){return jQuery.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return jQuery.sibling(e.firstChild)},contents:function(e){return jQuery.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:jQuery.merge([],e.childNodes)}},function(e,t){jQuery.fn[e]=function(n,r){var i=jQuery.map(this,t,n);return e.slice(-5)!=="Until"&&(r=n),r&&typeof r=="string"&&(i=jQuery.filter(r,i)),this.length>1&&(guaranteedUnique[e]||jQuery.unique(i),e[0]==="p"&&i.reverse()),this.pushStack(i)}}),jQuery.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),t.length===1&&r.nodeType===1?jQuery.find.matchesSelector(r,e)?[r]:[]:jQuery.find.matches(e,jQuery.grep(t,function(e){return e.nodeType===1}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&e.nodeType!==9)if(e.nodeType===1){if(i&&jQuery(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,manipulation_rcheckableType=/^(?:checkbox|radio)$/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.col=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.fn.extend({text:function(e){return jQuery.access(this,function(e){return e===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=manipulationTarget(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?jQuery.filter(e,this):this,i=0;for(;(n=r[i])!=null;i++)!t&&n.nodeType===1&&jQuery.cleanData(getAll(n)),n.parentNode&&(t&&jQuery.contains(n.ownerDocument,n)&&setGlobalEval(getAll(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++)e.nodeType===1&&(jQuery.cleanData(getAll(e,!1)),e.textContent="");return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return jQuery.clone(this,e,t)})},html:function(e){return jQuery.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&t.nodeType===1)return t.innerHTML;if(typeof e=="string"&&!rnoInnerhtml.test(e)&&!wrapMap[(rtagName.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(rxhtmlTag,"<$1></$2>");try{for(;n<r;n++)t=this[n]||{},t.nodeType===1&&(jQuery.cleanData(getAll(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=jQuery.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],s=e[t++];s&&(jQuery(this).remove(),s.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=core_concat.apply([],e);var r,i,s,o,u,a,f=0,l=this.length,c=this,h=l-1,p=e[0],d=jQuery.isFunction(p);if(d||!(l<=1||typeof p!="string"||jQuery.support.checkClone||!rchecked.test(p)))return this.each(function(r){var i=c.eq(r);d&&(e[0]=p.call(this,r,i.html())),i.domManip(e,t,n)});if(l){r=jQuery.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,r.childNodes.length===1&&(r=i);if(i){s=jQuery.map(getAll(r,"script"),disableScript),o=s.length;for(;f<l;f++)u=r,f!==h&&(u=jQuery.clone(u,!0,!0),o&&jQuery.merge(s,getAll(u,"script"))),t.call(this[f],u,f);if(o){a=s[s.length-1].ownerDocument,jQuery.map(s,restoreScript);for(f=0;f<o;f++)u=s[f],rscriptType.test(u.type||"")&&!data_priv.access(u,"globalEval")&&jQuery.contains(a,u)&&(u.src?jQuery._evalUrl(u.src):jQuery.globalEval(u.textContent.replace(rcleanScript,"")))}}}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){jQuery.fn[e]=function(e){var n,r=[],i=jQuery(e),s=i.length-1,o=0;for(;o<=s;o++)n=o===s?this:this.clone(!0),jQuery(i[o])[t](n),core_push.apply(r,n.get());return this.pushStack(r)}}),jQuery.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=jQuery.contains(e.ownerDocument,e);if(!jQuery.support.noCloneChecked&&(e.nodeType===1||e.nodeType===11)&&!jQuery.isXMLDoc(e)){o=getAll(u),s=getAll(e);for(r=0,i=s.length;r<i;r++)fixInput(s[r],o[r])}if(t)if(n){s=s||getAll(e),o=o||getAll(u);for(r=0,i=s.length;r<i;r++)cloneCopyEvent(s[r],o[r])}else cloneCopyEvent(e,u);return o=getAll(u,"script"),o.length>0&&setGlobalEval(o,!a&&getAll(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=0,c=e.length,h=t.createDocumentFragment(),p=[];for(;l<c;l++){i=e[l];if(i||i===0)if(jQuery.type(i)==="object")jQuery.merge(p,i.nodeType?[i]:i);else if(!rhtml.test(i))p.push(t.createTextNode(i));else{s=s||h.appendChild(t.createElement("div")),o=(rtagName.exec(i)||["",""])[1].toLowerCase(),u=wrapMap[o]||wrapMap._default,s.innerHTML=u[1]+i.replace(rxhtmlTag,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.firstChild;jQuery.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}}h.textContent="",l=0;while(i=p[l++]){if(r&&jQuery.inArray(i,r)!==-1)continue;a=jQuery.contains(i.ownerDocument,i),s=getAll(h.appendChild(i),"script"),a&&setGlobalEval(s);if(n){f=0;while(i=s[f++])rscriptType.test(i.type||"")&&n.push(i)}}return h},cleanData:function(e){var t,n,r,i=e.length,s=0,o=jQuery.event.special;for(;s<i;s++){n=e[s];if(jQuery.acceptData(n)){t=data_priv.access(n);if(t)for(r in t.events)o[r]?jQuery.event.remove(n,r):jQuery.removeEvent(n,r,t.handle)}data_user.discard(n),data_priv.discard(n)}},_evalUrl:function(e){return jQuery.ajax({url:e,type:"GET",dataType:"text",async:!1,global:!1,success:jQuery.globalEval})}}),jQuery.fn.extend({wrapAll:function(e){var t;return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapAll(e.call(this,t))}):(this[0]&&(t=jQuery(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return jQuery.isFunction(e)?this.each(function(t){jQuery(this).wrapInner(e.call(this,t))}):this.each(function(){var t=jQuery(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=jQuery.isFunction(e);return this.each(function(n){jQuery(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}});var curCSS,iframe,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),elemdisplay={BODY:"block"},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"];jQuery.fn.extend({css:function(e,t){return jQuery.access(this,function(e,t,n){var r,i,s={},o=0;if(jQuery.isArray(t)){r=getStyles(e),i=t.length;for(;o<i;o++)s[t[o]]=jQuery.css(e,t[o],!1,r);return s}return n!==undefined?jQuery.style(e,t,n):jQuery.css(e,t)},e,t,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(e){var t=typeof e=="boolean";return this.each(function(){(t?e:isHidden(this))?jQuery(this).show():jQuery(this).hide()})}}),jQuery.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=curCSS(e,"opacity");return n===""?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var i,s,o,u=jQuery.camelCase(t),a=e.style;t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(a,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u];if(n===undefined)return o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t];s=typeof n,s==="string"&&(i=rrelNum.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(jQuery.css(e,t)),s="number");if(n==null||s==="number"&&isNaN(n))return;s==="number"&&!jQuery.cssNumber[u]&&(n+="px"),!jQuery.support.clearCloneStyle&&n===""&&t.indexOf("background")===0&&(a[t]="inherit");if(!o||!("set"in o)||(n=o.set(e,n,r))!==undefined)a[t]=n},css:function(e,t,n,r){var i,s,o,u=jQuery.camelCase(t);return t=jQuery.cssProps[u]||(jQuery.cssProps[u]=vendorPropName(e.style,u)),o=jQuery.cssHooks[t]||jQuery.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=curCSS(e,t,r)),i==="normal"&&t in cssNormalTransform&&(i=cssNormalTransform[t]),n===""||n?(s=parseFloat(i),n===!0||jQuery.isNumeric(s)?s||0:i):i}}),curCSS=function(e,t,n){var r,i,s,o=n||getStyles(e),u=o?o.getPropertyValue(t)||o[t]:undefined,a=e.style;return o&&(u===""&&!jQuery.contains(e.ownerDocument,e)&&(u=jQuery.style(e,t)),rnumnonpx.test(u)&&rmargin.test(t)&&(r=a.width,i=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=u,u=o.width,a.width=r,a.minWidth=i,a.maxWidth=s)),u},jQuery.each(["height","width"],function(e,t){jQuery.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&rdisplayswap.test(jQuery.css(e,"display"))?jQuery.swap(e,cssShow,function(){return getWidthOrHeight(e,t,r)}):getWidthOrHeight(e,t,r)},set:function(e,n,r){var i=r&&getStyles(e);return setPositiveNumber(e,n,r?augmentWidthOrHeight(e,t,r,jQuery.support.boxSizing&&jQuery.css(e,"boxSizing",!1,i)==="border-box",i):0)}}}),jQuery(function(){jQuery.support.reliableMarginRight||(jQuery.cssHooks.marginRight={get:function(e,t){if(t)return jQuery.swap(e,{display:"inline-block"},curCSS,[e,"marginRight"])}}),!jQuery.support.pixelPosition&&jQuery.fn.position&&jQuery.each(["top","left"],function(e,t){jQuery.cssHooks[t]={get:function(e,n){if(n)return n=curCSS(e,t),rnumnonpx.test(n)?jQuery(e).position()[t]+"px":n}}})}),jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},jQuery.expr.filters.visible=function(e){return!jQuery.expr.filters.hidden(e)}),jQuery.each({margin:"",padding:"",border:"Width"},function(e,t){jQuery.cssHooks[e+t]={expand:function(n){var r=0,i={},s=typeof n=="string"?n.split(" "):[n];for(;r<4;r++)i[e+cssExpand[r]+t]=s[r]||s[r-2]||s[0];return i}},rmargin.test(e)||(jQuery.cssHooks[e+t].set=setPositiveNumber)});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=jQuery.prop(this,"elements");return e?jQuery.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(e)&&(this.checked||!manipulation_rcheckableType.test(e))}).map(function(e,t){var n=jQuery(this).val();return n==null?null:jQuery.isArray(n)?jQuery.map(n,function(e){return{name:t.name,value:e.replace(rCRLF,"\r\n")}}):{name:t.name,value:n.replace(rCRLF,"\r\n")}}).get()}}),jQuery.param=function(e,t){var n,r=[],i=function(e,t){t=jQuery.isFunction(t)?t():t==null?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};t===undefined&&(t=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional);if(jQuery.isArray(e)||e.jquery&&!jQuery.isPlainObject(e))jQuery.each(e,function(){i(this.name,this.value)});else for(n in e)buildParams(n,e[n],t,i);return r.join("&").replace(r20,"+")},jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){jQuery.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),jQuery.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)}});var ajaxLocParts,ajaxLocation,ajax_nonce=jQuery.now(),ajax_rquery=/\?/,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.fn.load=function(e,t,n){if(typeof e!="string"&&_load)return _load.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),jQuery.isFunction(t)?(n=t,t=undefined):t&&typeof t=="object"&&(i="POST"),o.length>0&&jQuery.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?jQuery("<div>").append(jQuery.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){jQuery.fn[t]=function(e){return this.on(t,e)}}),jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?ajaxExtend(ajaxExtend(e,jQuery.ajaxSettings),t):ajaxExtend(jQuery.ajaxSettings,e)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(e,t){function S(e,t,s,u){var f,m,g,b,E,S=t;if(y===2)return;y=2,o&&clearTimeout(o),n=undefined,i=u||"",w.readyState=e>0?4:0,f=e>=200&&e<300||e===304,s&&(b=ajaxHandleResponses(l,w,s)),b=ajaxConvert(l,b,w,f);if(f)l.ifModified&&(E=w.getResponseHeader("Last-Modified"),E&&(jQuery.lastModified[r]=E),E=w.getResponseHeader("etag"),E&&(jQuery.etag[r]=E)),e===204?S="nocontent":e===304?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g);else{g=S;if(e||!S)S="error",e<0&&(e=0)}w.status=e,w.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,w]):p.rejectWith(c,[w,S,g]),w.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[w,l,f?m:g]),d.fireWith(c,[w,S]),a&&(h.trigger("ajaxComplete",[w,l]),--jQuery.active||jQuery.event.trigger("ajaxStop"))}typeof e=="object"&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=jQuery.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?jQuery(c):jQuery.event,p=jQuery.Deferred(),d=jQuery.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(y===2){if(!s){s={};while(t=rheaders.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return y===2?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(y<2)for(t in e)v[t]=[v[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),S(0,t),this}};p.promise(w).complete=d.add,w.success=w.done,w.error=w.fail,l.url=((e||l.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=jQuery.trim(l.dataType||"*").toLowerCase().match(core_rnotwhite)||[""],l.crossDomain==null&&(u=rurl.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===ajaxLocParts[1]&&u[2]===ajaxLocParts[2]&&(u[3]||(u[1]==="http:"?"80":"443"))===(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443")))),l.data&&l.processData&&typeof l.data!="string"&&(l.data=jQuery.param(l.data,l.traditional)),inspectPrefiltersOrTransports(prefilters,l,t,w);if(y===2)return w;a=l.global,a&&jQuery.active++===0&&jQuery.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!rnoContent.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(ajax_rquery.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=rts.test(r)?r.replace(rts,"$1_="+ajax_nonce++):r+(ajax_rquery.test(r)?"&":"?")+"_="+ajax_nonce++)),l.ifModified&&(jQuery.lastModified[r]&&w.setRequestHeader("If-Modified-Since",jQuery.lastModified[r]),jQuery.etag[r]&&w.setRequestHeader("If-None-Match",jQuery.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&w.setRequestHeader("Content-Type",l.contentType),w.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+(l.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)w.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,w,l)!==!1&&y!==2){b="abort";for(f in{success:1,error:1,complete:1})w[f](l[f]);n=inspectPrefiltersOrTransports(transports,l,t,w);if(!n)S(-1,"No Transport");else{w.readyState=1,a&&h.trigger("ajaxSend",[w,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){w.abort("timeout")},l.timeout));try{y=1,n.send(m,S)}catch(E){if(!(y<2))throw E;S(-1,E)}}return w}return w.abort()},getJSON:function(e,t,n){return jQuery.get(e,t,n,"json")},getScript:function(e,t){return jQuery.get(e,undefined,t,"script")}}),jQuery.each(["get","post"],function(e,t){jQuery[t]=function(e,n,r,i){return jQuery.isFunction(n)&&(i=i||r,r=n,n=undefined),jQuery.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return jQuery.globalEval(e),e}}}),jQuery.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),jQuery.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=jQuery("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i(e.type==="error"?404:200,e.type)}),document.head.appendChild(t[0])},abort:function(){n&&n()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=oldCallbacks.pop()||jQuery.expando+"_"+ajax_nonce++;return this[e]=!0,e}}),jQuery.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,s,o=e.jsonp!==!1&&(rjsonp.test(e.url)?"url":typeof e.data=="string"&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(e.data)&&"data");if(o||e.dataTypes[0]==="jsonp")return r=e.jsonpCallback=jQuery.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,o?e[o]=e[o].replace(rjsonp,"$1"+r):e.jsonp!==!1&&(e.url+=(ajax_rquery.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return s||jQuery.error(r+" was not called"),s[0]},e.dataTypes[0]="json",i=window[r],window[r]=function(){s=arguments},n.always(function(){window[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,oldCallbacks.push(r)),s&&jQuery.isFunction(i)&&i(s[0]),s=i=undefined}),"script"}),jQuery.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xhrSupported=jQuery.ajaxSettings.xhr(),xhrSuccessStatus={0:200,1223:204},xhrId=0,xhrCallbacks={};window.ActiveXObject&&jQuery(window).on("unload",function(){for(var e in xhrCallbacks)xhrCallbacks[e]();xhrCallbacks=undefined}),jQuery.support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,jQuery.support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(e){var t;if(jQuery.support.cors||xhrSupported&&!e.crossDomain)return{send:function(n,r){var i,s,o=e.xhr();o.open(e.type,e.url,e.async,e.username,e.password);if(e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),!e.crossDomain&&!n["X-Requested-With"]&&(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete xhrCallbacks[s],t=o.onload=o.onerror=null,e==="abort"?o.abort():e==="error"?r(o.status||404,o.statusText):r(xhrSuccessStatus[o.status]||o.status,o.statusText,typeof o.responseText=="string"?{text:o.responseText}:undefined,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=xhrCallbacks[s=xhrId++]=t("abort"),o.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}});var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=rfxnum.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(jQuery.cssNumber[e]?"":"px");if(r!=="px"&&u){u=jQuery.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,jQuery.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(e,t){jQuery.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],tweeners[n]=tweeners[n]||[],tweeners[n].unshift(t)},prefilter:function(e,t){t?animationPrefilters.unshift(e):animationPrefilters.push(e)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(jQuery.cssNumber[n]?"":"px")},cur:function(){var e=Tween.propHooks[this.prop];return e&&e.get?e.get(this):Tween.propHooks._default.get(this)},run:function(e){var t,n=Tween.propHooks[this.prop];return this.options.duration?this.pos=t=jQuery.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=jQuery.css(e.elem,e.prop,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){jQuery.fx.step[e.prop]?jQuery.fx.step[e.prop](e):e.elem.style&&(e.elem.style[jQuery.cssProps[e.prop]]!=null||jQuery.cssHooks[e.prop])?jQuery.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},jQuery.each(["toggle","show","hide"],function(e,t){var n=jQuery.fn[t];jQuery.fn[t]=function(e,r,i){return e==null||typeof e=="boolean"?n.apply(this,arguments):this.animate(genFx(t,!0),e,r,i)}}),jQuery.fn.extend({fadeTo:function(e,t,n,r){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=jQuery.isEmptyObject(e),s=jQuery.speed(t,n,r),o=function(){var t=Animation(this,jQuery.extend({},e),s);o.finish=function(){t.stop(!0)},(i||data_priv.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return typeof e!="string"&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=e!=null&&e+"queueHooks",s=jQuery.timers,o=data_priv.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&rrun.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem===this&&(e==null||s[i].queue===e)&&(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&jQuery.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=data_priv.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=jQuery.timers,o=r?r.length:0;n.finish=!0,jQuery.queue(this,e,[]),i&&i.cur&&i.cur.finish&&i.cur.finish.call(this);for(t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){jQuery.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),jQuery.speed=function(e,t,n){var r=e&&typeof e=="object"?jQuery.extend({},e):{complete:n||!n&&t||jQuery.isFunction(e)&&e,duration:e,easing:n&&t||t&&!jQuery.isFunction(t)&&t};r.duration=jQuery.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in jQuery.fx.speeds?jQuery.fx.speeds[r.duration]:jQuery.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){jQuery.isFunction(r.old)&&r.old.call(this),r.queue&&jQuery.dequeue(this,r.queue)},r},jQuery.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},jQuery.timers=[],jQuery.fx=Tween.prototype.init,jQuery.fx.tick=function(){var e,t=jQuery.timers,n=0;fxNow=jQuery.now();for(;n<t.length;n++)e=t[n],!e()&&t[n]===e&&t.splice(n--,1);t.length||jQuery.fx.stop(),fxNow=undefined},jQuery.fx.timer=function(e){e()&&jQuery.timers.push(e)&&jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fx.step={},jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.animated=function(e){return jQuery.grep(jQuery.timers,function(t){return e===t.elem}).length}),jQuery.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){jQuery.offset.setOffset(this,e,t)});var t,n,r=this[0],i={top:0,left:0},s=r&&r.ownerDocument;if(!s)return;return t=s.documentElement,jQuery.contains(t,r)?(typeof r.getBoundingClientRect!==core_strundefined&&(i=r.getBoundingClientRect()),n=getWindow(s),{top:i.top+n.pageYOffset-t.clientTop,left:i.left+n.pageXOffset-t.clientLeft}):i},jQuery.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=jQuery.css(e,"position"),c=jQuery(e),h={};l==="static"&&(e.style.position="relative"),u=c.offset(),s=jQuery.css(e,"top"),a=jQuery.css(e,"left"),f=(l==="absolute"||l==="fixed")&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),jQuery.isFunction(t)&&(t=t.call(e,n,u)),t.top!=null&&(h.top=t.top-u.top+o),t.left!=null&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},jQuery.fn.extend({position:function(){if(!this[0])return;var e,t,n=this[0],r={top:0,left:0};return jQuery.css(n,"position")==="fixed"?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),jQuery.nodeName(e[0],"html")||(r=e.offset()),r.top+=jQuery.css(e[0],"borderTopWidth",!0),r.left+=jQuery.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-jQuery.css(n,"marginTop",!0),left:t.left-r.left-jQuery.css(n,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||docElem;while(e&&!jQuery.nodeName(e,"html")&&jQuery.css(e,"position")==="static")e=e.offsetParent;return e||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;jQuery.fn[e]=function(r){return jQuery.access(this,function(e,r,i){var s=getWindow(e);if(i===undefined)return s?s[t]:e[r];s?s.scrollTo(n?window.pageXOffset:i,n?i:window.pageYOffset):e[r]=i},e,r,arguments.length,null)}}),jQuery.each({Height:"height",Width:"width"},function(e,t){jQuery.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){jQuery.fn[r]=function(r,i){var s=arguments.length&&(n||typeof r!="boolean"),o=n||(r===!0||i===!0?"margin":"border");return jQuery.access(this,function(t,n,r){var i;return jQuery.isWindow(t)?t.document.documentElement["client"+e]:t.nodeType===9?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?jQuery.css(t,n,o):jQuery.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,typeof module=="object"&&typeof module.exports=="object"?module.exports=jQuery:typeof define=="function"&&define.amd&&define("jquery",[],function(){return jQuery}),typeof window=="object"&&typeof window.document=="object"&&(window.jQuery=window.$=jQuery)})(window),module.exports=window.jQuery},"spine/index":function(e,t,n){n.exports=t("./lib/spine")},"spine/lib/spine":function(e,t,n){(function(){var e,t,r,i,s,o,u,a,f,l,c,h,p=[].slice,d=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},v={}.hasOwnProperty,m=function(e,t){function r(){this.constructor=e}for(var n in t)v.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},g=function(e,t){return function(){return e.apply(t,arguments)}};r={bind:function(e,t){var n,r,i,s,o;r=e.split(" "),n=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={});for(s=0,o=r.length;s<o;s++)i=r[s],n[i]||(n[i]=[]),n[i].push(t);return this},one:function(e,t){var n;return this.bind(e,n=function(){return this.unbind(e,n),t.apply(this,arguments)})},trigger:function(){var e,t,n,r,i,s,o;e=1<=arguments.length?p.call(arguments,0):[],n=e.shift(),r=this.hasOwnProperty("_callbacks")&&((o=this._callbacks)!=null?o[n]:void 0);if(!r)return;for(i=0,s=r.length;i<s;i++){t=r[i];if(t.apply(this,e)===!1)break}return!0},listenTo:function(e,t,n){return e.bind(t,n),this.listeningTo||(this.listeningTo=[]),this.listeningTo.push(e),this},listenToOnce:function(e,t,n){var r;return r=this.listeningToOnce||(this.listeningToOnce=[]),r.push(e),e.one(t,function(){var t;return t=r.indexOf(e),t!==-1&&r.splice(t,1),n.apply(this,arguments)}),this},stopListening:function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,v;if(arguments.length===0){s=[],h=[this.listeningTo,this.listeningToOnce];for(o=0,f=h.length;o<f;o++){i=h[o];if(!i)continue;for(u=0,l=i.length;u<l;u++){e=i[u];if(d.call(s,e)>=0)continue;e.unbind(),s.push(e)}}return this.listeningTo=void 0,this.listeningToOnce=void 0}if(e){t&&e.unbind(t,n),t||e.unbind(),p=[this.listeningTo,this.listeningToOnce],v=[];for(a=0,c=p.length;a<c;a++){i=p[a];if(!i)continue;r=i.indexOf(e),r!==-1?v.push(i.splice(r,1)):v.push(void 0)}return v}},unbind:function(e,t){var n,r,i,s,o,u,a,f,l,c;if(arguments.length===0)return this._callbacks={},this;if(!e)return this;r=e.split(" ");for(u=0,f=r.length;u<f;u++){o=r[u],s=(c=this._callbacks)!=null?c[o]:void 0;if(!s)continue;if(!t){delete this._callbacks[o];continue}for(i=a=0,l=s.length;a<l;i=++a){n=s[i];if(n!==t)continue;s=s.slice(),s.splice(i,1),this._callbacks[o]=s;break}}return this}},r.on=r.bind,r.off=r.unbind,i={trace:!0,logPrefix:"(App)",log:function(){var e;e=1<=arguments.length?p.call(arguments,0):[];if(!this.trace)return;return this.logPrefix&&e.unshift(this.logPrefix),typeof console!="undefined"&&console!==null&&typeof console.log=="function"&&console.log.apply(console,e),this}},h=["included","extended"],o=function(){function e(){typeof this.init=="function"&&this.init.apply(this,arguments)}return e.include=function(e){var t,n,r;if(!e)throw new Error("include(obj) requires obj");for(t in e)n=e[t],d.call(h,t)<0&&(this.prototype[t]=n);return(r=e.included)!=null&&r.apply(this),this},e.extend=function(e){var t,n,r;if(!e)throw new Error("extend(obj) requires obj");for(t in e)n=e[t],d.call(h,t)<0&&(this[t]=n);return(r=e.extended)!=null&&r.apply(this),this},e.proxy=function(e){var t=this;return function(){return e.apply(t,arguments)}},e.prototype.proxy=function(e){var t=this;return function(){return e.apply(t,arguments)}},e}(),s=function(t){function n(e){n.__super__.constructor.apply(this,arguments),e&&this.load(e),this.cid=this.constructor.uid("c-")}return m(n,t),n.extend(r),n.records=[],n.irecords={},n.crecords={},n.attributes=[],n.configure=function(){var e,t;return t=arguments[0],e=2<=arguments.length?p.call(arguments,1):[],this.className=t,this.deleteAll(),e.length&&(this.attributes=e),this.attributes&&(this.attributes=c(this.attributes)),this.attributes||(this.attributes=[]),this.unbind(),this},n.toString=function(){return""+this.className+"("+this.attributes.join(", ")+")"},n.find=function(e){var t;t=this.exists(e);if(!t)throw new Error('"'+this.className+'" model could not find a record for the ID "'+e+'"');return t},n.exists=function(e){var t,n;return(t=(n=this.irecords[e])!=null?n:this.crecords[e])!=null?t.clone():void 0},n.refresh=function(e,t){var n,r,i,s,o;t==null&&(t={}),t.clear&&this.deleteAll(),r=this.fromJSON(e),f(r)||(r=[r]);for(s=0,o=r.length;s<o;s++)n=r[s],n.id&&this.irecords[n.id]?this.records[this.records.indexOf(this.irecords[n.id])]=n:(n.id||(n.id=n.cid),this.records.push(n)),this.irecords[n.id]=n,this.crecords[n.cid]=n;return this.sort(),i=this.cloneArray(r),this.trigger("refresh",this.cloneArray(r)),i},n.select=function(e){var t,n,r,i,s;i=this.records,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],e(t)&&s.push(t.clone());return s},n.findByAttribute=function(e,t){var n,r,i,s;s=this.records;for(r=0,i=s.length;r<i;r++){n=s[r];if(n[e]===t)return n.clone()}return null},n.findAllByAttribute=function(e,t){return this.select(function(n){return n[e]===t})},n.each=function(e){var t,n,r,i,s;i=this.records,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(e(t.clone()));return s},n.all=function(){return this.cloneArray(this.records)},n.first=function(){var e;return(e=this.records[0])!=null?e.clone():void 0},n.last=function(){var e;return(e=this.records[this.records.length-1])!=null?e.clone():void 0},n.count=function(){return this.records.length},n.deleteAll=function(){return this.records=[],this.irecords={},this.crecords={}},n.destroyAll=function(e){var t,n,r,i,s;i=this.records,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(t.destroy(e));return s},n.update=function(e,t,n){return this.find(e).updateAttributes(t,n)},n.create=function(e,t){var n;return n=new this(e),n.save(t)},n.destroy=function(e,t){return this.find(e).destroy(t)},n.change=function(e){return typeof e=="function"?this.bind("change",e):this.trigger.apply(this,["change"].concat(p.call(arguments)))},n.fetch=function(e){return typeof e=="function"?this.bind("fetch",e):this.trigger.apply(this,["fetch"].concat(p.call(arguments)))},n.toJSON=function(){return this.records},n.fromJSON=function(e){var t,n,r,i;if(!e)return;typeof e=="string"&&(e=JSON.parse(e));if(f(e)){i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(new this(t));return i}return new this(e)},n.fromForm=function(){var e;return(e=new this).fromForm.apply(e,arguments)},n.sort=function(){return this.comparator&&this.records.sort(this.comparator),this.records},n.cloneArray=function(e){var t,n,r,i;i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(t.clone());return i},n.idCounter=0,n.uid=function(e){var t;return e==null&&(e=""),t=e+this.idCounter++,this.exists(t)&&(t=this.uid(e)),t},n.prototype.isNew=function(){return!this.exists()},n.prototype.isValid=function(){return!this.validate()},n.prototype.validate=function(){},n.prototype.load=function(e){var t,n;e.id&&(this.id=e.id);for(t in e)n=e[t],e.hasOwnProperty(t)&&typeof this[t]=="function"?this[t](n):this[t]=n;return this},n.prototype.attributes=function(){var e,t,n,r,i;t={},i=this.constructor.attributes;for(n=0,r=i.length;n<r;n++)e=i[n],e in this&&(typeof this[e]=="function"?t[e]=this[e]():t[e]=this[e]);return this.id&&(t.id=this.id),t},n.prototype.eql=function(e){return!!(e&&e.constructor===this.constructor&&e.cid===this.cid||e.id&&e.id===this.id)},n.prototype.save=function(e){var t,n;e==null&&(e={});if(e.validate!==!1){t=this.validate();if(t)return this.trigger("error",t),!1}return this.trigger("beforeSave",e),n=this.isNew()?this.create(e):this.update(e),this.stripCloneAttrs(),this.trigger("save",e),n},n.prototype.stripCloneAttrs=function(){var e,t;if(this.hasOwnProperty("cid"))return;for(e in this){if(!v.call(this,e))continue;t=this[e],this.constructor.attributes.indexOf(e)>-1&&delete this[e]}return this},n.prototype.updateAttribute=function(e,t,n){var r;return r={},r[e]=t,this.updateAttributes(r,n)},n.prototype.updateAttributes=function(e,t){return this.load(e),this.save(t)},n.prototype.changeID=function(e){var t;return t=this.constructor.irecords,t[e]=t[this.id],delete t[this.id],this.id=e,this.save()},n.prototype.destroy=function(e){var t,n,r,i,s;e==null&&(e={}),this.trigger("beforeDestroy",e),r=this.constructor.records.slice(0);for(t=i=0,s=r.length;i<s;t=++i){n=r[t];if(!this.eql(n))continue;r.splice(t,1);break}return this.constructor.records=r,delete this.constructor.irecords[this.id],delete this.constructor.crecords[this.cid],this.destroyed=!0,this.trigger("destroy",e),this.trigger("change","destroy",e),this.listeningTo&&this.stopListening(),this.unbind(),this},n.prototype.dup=function(e){var t;return t=new this.constructor(this.attributes()),e===!1?t.cid=this.cid:delete t.id,t},n.prototype.clone=function(){return a(this)},n.prototype.reload=function(){var e;return this.isNew()?this:(e=this.constructor.find(this.id),this.load(e.attributes()),e)},n.prototype.toJSON=function(){return this.attributes()},n.prototype.toString=function(){return"<"+this.constructor.className+" ("+JSON.stringify(this)+")>"},n.prototype.fromForm=function(t){var n,r,i,s,o;r={},o=e(t).serializeArray();for(i=0,s=o.length;i<s;i++)n=o[i],r[n.name]=n.value;return this.load(r)},n.prototype.exists=function(){return this.constructor.exists(this.id)},n.prototype.update=function(e){var t,n;return this.trigger("beforeUpdate",e),n=this.constructor.irecords,n[this.id].load(this.attributes()),this.constructor.sort(),t=n[this.id].clone(),t.trigger("update",e),t.trigger("change","update",e),t},n.prototype.create=function(e){var t,n;return this.trigger("beforeCreate",e),this.id||(this.id=this.cid),n=this.dup(!1),this.constructor.records.push(n),this.constructor.irecords[this.id]=n,this.constructor.crecords[this.cid]=n,this.constructor.sort(),t=n.clone(),t.trigger("create",e),t.trigger("change","create",e),t},n.prototype.bind=function(e,t){var n,r,i,s,o,u,a=this;this.constructor.bind(e,n=function(e){if(e&&a.eql(e))return t.apply(a,arguments)}),u=e.split(" "),i=function(e){var r;return a.constructor.bind("unbind",r=function(i,s,o){if(i&&a.eql(i)){if(s&&s!==e)return;if(o&&o!==t)return;return a.constructor.unbind(e,n),a.constructor.unbind("unbind",r)}})};for(s=0,o=u.length;s<o;s++)r=u[s],i(r);return this},n.prototype.one=function(e,t){var n,r=this;return this.bind(e,n=function(){return r.unbind(e,n),t.apply(r,arguments)})},n.prototype.trigger=function(){var e,t;return e=1<=arguments.length?p.call(arguments,0):[],e.splice(1,0,this),(t=this.constructor).trigger.apply(t,e)},n.prototype.listenTo=function(e,t,n){return e.bind(t,n),this.listeningTo||(this.listeningTo=[]),this.listeningTo.push(e)},n.prototype.listenToOnce=function(e,t,n){var r,i,s=this;return i=this.listeningToOnce||(this.listeningToOnce=[]),i.push(e),e.bind(t,r=function(){var s;return s=i.indexOf(e),s!==-1&&i.splice(s,1),e.unbind(t,r),n.apply(e,arguments)})},n.prototype.stopListening=function(e,t,n){var r,i,s,o,u,a,f,l,c,h,p,v,m;if(arguments.length===0){s=[],h=[this.listeningTo,this.listeningToOnce];for(o=0,f=h.length;o<f;o++){i=h[o];if(!i)continue;p=this.listeningTo;for(u=0,l=p.length;u<l;u++){e=p[u];if(d.call(s,e)>=0)continue;e.unbind(),s.push(e)}}this.listeningTo=void 0,this.listeningToOnce=void 0;return}if(e){t||e.unbind(),t&&e.unbind(t,n),v=[this.listeningTo,this.listeningToOnce],m=[];for(a=0,c=v.length;a<c;a++){i=v[a];if(!i)continue;r=i.indexOf(e),r!==-1?m.push(i.splice(r,1)):m.push(void 0)}return m}},n.prototype.unbind=function(e,t){var n,r,i,s,o;if(arguments.length===0)return this.trigger("unbind");if(e){s=e.split(" "),o=[];for(r=0,i=s.length;r<i;r++)n=s[r],o.push(this.trigger("unbind",n,t));return o}},n}(o),s.prototype.on=s.prototype.bind,s.prototype.off=s.prototype.unbind,t=function(t){function n(t){this.release=g(this.release,this);var r,i,s,o,u;this.options=t,u=this.options;for(i in u)o=u[i],this[i]=o;this.el||(this.el=document.createElement(this.tag)),this.el=e(this.el),this.$el=this.el,this.className&&this.el.addClass(this.className),this.attributes&&this.el.attr(this.attributes),this.events||(this.events=this.constructor.events),this.elements||(this.elements=this.constructor.elements),r=this;while(s=r.constructor.__super__)s.events&&(this.events=e.extend({},s.events,this.events)),s.elements&&(this.elements=e.extend({},s.elements,this.elements)),r=s;this.events&&this.delegateEvents(this.events),this.elements&&this.refreshElements(),n.__super__.constructor.apply(this,arguments)}return m(n,t),n.include(r),n.include(i),n.prototype.eventSplitter=/^(\S+)\s*(.*)$/,n.prototype.tag="div",n.prototype.release=function(){return this.trigger("release",this),this.el.remove(),this.unbind(),this.stopListening()},n.prototype.$=function(t){return e(t,this.el)},n.prototype.delegateEvents=function(e){var t,n,r,i,s,o,u=this;o=[];for(n in e){i=e[n];if(typeof i=="function")i=function(e){return function(){return e.apply(u,arguments),!0}}(i);else{if(!this[i])throw new Error(""+i+" doesn't exist");i=function(e){return function(){return u[e].apply(u,arguments),!0}}(i)}r=n.match(this.eventSplitter),t=r[1],s=r[2],s===""?o.push(this.el.bind(t,i)):o.push(this.el.delegate(s,t,i))}return o},n.prototype.refreshElements=function(){var e,t,n,r;n=this.elements,r=[];for(e in n)t=n[e],r.push(this[t]=this.$(e));return r},n.prototype.delay=function(e,t){return setTimeout(this.proxy(e),t||0)},n.prototype.html=function(e){return this.el.html(e.el||e),this.refreshElements(),this.el},n.prototype.append=function(){var e,t,n;return t=1<=arguments.length?p.call(arguments,0):[],t=function(){var n,r,i;i=[];for(n=0,r=t.length;n<r;n++)e=t[n],i.push(e.el||e);return i}(),(n=this.el).append.apply(n,t),this.refreshElements(),this.el},n.prototype.appendTo=function(e){return this.el.appendTo(e.el||e),this.refreshElements(),this.el},n.prototype.prepend=function(){var e,t,n;return t=1<=arguments.length?p.call(arguments,0):[],t=function(){var n,r,i;i=[];for(n=0,r=t.length;n<r;n++)e=t[n],i.push(e.el||e);return i}(),(n=this.el).prepend.apply(n,t),this.refreshElements(),this.el},n.prototype.replace=function(t){var n,r;return r=[this.el,e(t.el||t)],n=r[0],this.el=r[1],n.replaceWith(this.el),this.delegateEvents(this.events),this.refreshElements(),this.el},n}(o),e=(typeof window!="undefined"&&window!==null?window.jQuery:void 0)||(typeof window!="undefined"&&window!==null?window.Zepto:void 0)||function(e){return e},a=Object.create||function(e){var t;return t=function(){},t.prototype=e,new t},f=function(e){return Object.prototype.toString.call(e)==="[object Array]"},l=function(e){var t;if(!e)return!0;for(t in e)return!1;return!0},c=function(e){return Array.prototype.slice.call(e,0)},u=this.Spine={},typeof n!="undefined"&&n!==null&&(n.exports=u),u.version="1.1.0",u.isArray=f,u.isBlank=l,u.$=e,u.Events=r,u.Log=i,u.Module=o,u.Controller=t,u.Model=s,o.extend.call(u,r),o.create=o.sub=t.create=t.sub=s.sub=function(e,t){var n,r;return n=function(e){function t(){return r=t.__super__.constructor.apply(this,arguments),r}return m(t,e),t}(this),e&&n.include(e),t&&n.extend(t),typeof n.unbind=="function"&&n.unbind(),n},s.setup=function(e,t){var n,r;return t==null&&(t=[]),n=function(e){function t(){return r=t.__super__.constructor.apply(this,arguments),r}return m(t,e),t}(this),n.configure.apply(n,[e].concat(p.call(t))),n},u.Class=o}).call(this)},"spine/lib/local":function(e,t,n){(function(){var e;e=this.Spine||t("spine"),e.Model.Local={extended:function(){return this.change(this.saveLocal),this.fetch(this.loadLocal)},saveLocal:function(){var e;return e=JSON.stringify(this),localStorage[this.className]=e},loadLocal:function(){var e;return e=localStorage[this.className],this.refresh(e||[],{clear:!0})}},typeof n!="undefined"&&n!==null&&(n.exports=e.Model.Local)}).call(this)},"spine/lib/ajax":function(e,t,n){(function(){var e,r,i,s,o,u,a,f,l,c,h=[].slice,p=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty,v=function(e,t){function r(){this.constructor=e}for(var n in t)d.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};c=this.Spine||t("spine"),e=c.$,a=c.Model,f=e({}),r={getURL:function(e){return(typeof e.url=="function"?e.url():void 0)||e.url},getScope:function(e){return(typeof e.scope=="function"?e.scope():void 0)||e.scope},generateURL:function(){var e,t,n,i,s;return n=arguments[0],e=2<=arguments.length?h.call(arguments,1):[],n.className?(t=n.className.toLowerCase()+"s",s=r.getScope(n)):(typeof n.constructor.url=="string"?t=n.constructor.url:t=n.constructor.className.toLowerCase()+"s",s=r.getScope(n)||r.getScope(n.constructor)),e.unshift(t),e.unshift(s),i=e.join("/"),i=i.replace(/(\/\/)/g,"/"),i=i.replace(/^\/|\/$/g,""),i.indexOf("../")!==0?a.host+"/"+i:i},enabled:!0,disable:function(e){var t;if(!this.enabled)return e();this.enabled=!1;try{return e()}catch(n){throw t=n,t}finally{this.enabled=!0}},queue:function(e){return e?f.queue(e):f.queue()},clearQueue:function(){return this.queue([])}},i=function(){function t(){}return t.prototype.defaults={dataType:"json",processData:!1,headers:{"X-Requested-With":"XMLHttpRequest"}},t.prototype.queue=r.queue,t.prototype.ajax=function(t,n){return e.ajax(this.ajaxSettings(t,n))},t.prototype.ajaxQueue=function(t,n){var i,s,o,u,a;return s=null,i=e.Deferred(),o=i.promise(),r.enabled?(a=this.ajaxSettings(t,n),u=function(t){return s=e.ajax(a).done(i.resolve).fail(i.reject).then(t,t)},o.abort=function(t){var n;return s?s.abort(t):(n=e.inArray(u,this.queue()),n>-1&&this.queue().splice(n,1),i.rejectWith(a.context||a,[o,t,""]),o)},this.queue(u),o):o},t.prototype.ajaxSettings=function(t,n){return e.extend({},this.defaults,n,t)},t}(),s=function(e){function t(e){this.model=e,this.failResponse=p(this.failResponse,this),this.recordsResponse=p(this.recordsResponse,this)}return v(t,e),t.prototype.find=function(e,t){var n;return n=new this.model({id:e}),this.ajaxQueue(t,{type:"GET",url:r.getURL(n)}).done(this.recordsResponse).fail(this.failResponse)},t.prototype.all=function(e){return this.ajaxQueue(e,{type:"GET",url:r.getURL(this.model)}).done(this.recordsResponse).fail(this.failResponse)},t.prototype.fetch=function(e,t){var n,r=this;return e==null&&(e={}),t==null&&(t={}),(n=e.id)?(delete e.id,this.find(n,e).done(function(e){return r.model.refresh(e,t)})):this.all(e).done(function(e){return r.model.refresh(e,t)})},t.prototype.recordsResponse=function(e,t,n){return this.model.trigger("ajaxSuccess",null,t,n)},t.prototype.failResponse=function(e,t,n){return this.model.trigger("ajaxError",null,e,t,n)},t}(i),l=function(e){function t(e){this.record=e,this.failResponse=p(this.failResponse,this),this.recordResponse=p(this.recordResponse,this),this.model=this.record.constructor}return v(t,e),t.prototype.reload=function(e,t){return this.ajaxQueue(e,{type:"GET",url:r.getURL(this.record)}).done(this.recordResponse(t)).fail(this.failResponse(t))},t.prototype.create=function(e,t){return this.ajaxQueue(e,{type:"POST",contentType:"application/json",data:JSON.stringify(this.record),url:r.getURL(this.model)}).done(this.recordResponse(t)).fail(this.failResponse(t))},t.prototype.update=function(e,t){return this.ajaxQueue(e,{type:"PUT",contentType:"application/json",data:JSON.stringify(this.record),url:r.getURL(this.record)}).done(this.recordResponse(t)).fail(this.failResponse(t))},t.prototype.destroy=function(e,t){return this.ajaxQueue(e,{type:"DELETE",url:r.getURL(this.record)}).done(this.recordResponse(t)).fail(this.failResponse(t))},t.prototype.recordResponse=function(e){var t=this;return e==null&&(e={}),function(n,i,s){var o,u;return c.isBlank(n)||t.record.destroyed?n=!1:n=t.model.fromJSON(n),r.disable(function(){if(n)return n.id&&t.record.id!==n.id&&t.record.changeID(n.id),t.record.updateAttributes(n.attributes())}),t.record.trigger("ajaxSuccess",n,i,s),(o=e.success)!=null&&o.apply(t.record),(u=e.done)!=null?u.apply(t.record):void 0}},t.prototype.failResponse=function(e){var t=this;return e==null&&(e={}),function(n,r,i){var s,o;return t.record.trigger("ajaxError",n,r,i),(s=e.error)!=null&&s.apply(t.record),(o=e.fail)!=null?o.apply(t.record):void 0}},t}(i),a.host="",u={ajax:function(){return new l(this)},url:function(){var e;return e=1<=arguments.length?h.call(arguments,0):[],e.unshift(encodeURIComponent(this.id)),r.generateURL.apply(r,[this].concat(h.call(e)))}},o={ajax:function(){return new s(this)},url:function(){var e;return e=1<=arguments.length?h.call(arguments,0):[],r.generateURL.apply(r,[this].concat(h.call(e)))}},a.Ajax={extended:function(){return this.fetch(this.ajaxFetch),this.change(this.ajaxChange),this.extend(o),this.include(u)},ajaxFetch:function(){var e;return(e=this.ajax()).fetch.apply(e,arguments)},ajaxChange:function(e,t,n){n==null&&(n={});if(n.ajax===!1)return;return e.ajax()[t](n.ajax,n)}},a.Ajax.Methods={extended:function(){return this.extend(o),this.include(u)}},r.defaults=i.prototype.defaults,c.Ajax=r,typeof n!="undefined"&&n!==null&&(n.exports=r)}).call(this)},"spine/lib/route":function(e,t,n){(function(){var e,r,i,s,o,u,a={}.hasOwnProperty,f=function(e,t){function r(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},l=[].slice;r=this.Spine||t("spine"),e=r.$,s=/^#*/,o=/:([\w\d]+)/g,u=/\*([\w\d]+)/g,i=/[-[\]{}()+?.,\\^$|#\s]/g,r.Route=function(t){function a(e,t){var n;this.path=e,this.callback=t,this.names=[];if(typeof e=="string"){o.lastIndex=0;while((n=o.exec(e))!==null)this.names.push(n[1]);u.lastIndex=0;while((n=u.exec(e))!==null)this.names.push(n[1]);e=e.replace(i,"\\$&").replace(o,"([^/]*)").replace(u,"(.*?)"),this.route=new RegExp("^"+e+"$")}else this.route=e}var n;return f(a,t),a.extend(r.Events),a.historySupport=((n=window.history)!=null?n.pushState:void 0)!=null,a.routes=[],a.options={trigger:!0,history:!1,shim:!1,replace:!1},a.add=function(e,t){var n,r,i;if(typeof e!="object"||e instanceof RegExp)return this.routes.push(new this(e,t));i=[];for(n in e)r=e[n],i.push(this.add(n,r));return i},a.setup=function(t){t==null&&(t={}),this.options=e.extend({},this.options,t),this.options.history&&(this.history=this.historySupport&&this.options.history);if(this.options.shim)return;return this.history?e(window).bind("popstate",this.change):e(window).bind("hashchange",this.change),this.change()},a.unbind=function(){if(this.options.shim)return;return this.history?e(window).unbind("popstate",this.change):e(window).unbind("hashchange",this.change)},a.navigate=function(){var t,n,r,i;t=1<=arguments.length?l.call(arguments,0):[],r={},n=t[t.length-1],typeof n=="object"?r=t.pop():typeof n=="boolean"&&(r.trigger=t.pop()),r=e.extend({},this.options,r),i=t.join("/");if(this.path===i)return;this.path=i,this.trigger("navigate",this.path),r.trigger&&this.matchRoute(this.path,r);if(r.shim)return;return this.history&&r.replace?history.replaceState({},document.title,this.path):this.history?history.pushState({},document.title,this.path):window.location.hash=this.path},a.getPath=function(){var e;return this.history?(e=window.location.pathname,e.substr(0,1)!=="/"&&(e="/"+e)):(e=window.location.hash,e=e.replace(s,"")),e},a.getHost=function(){return""+window.location.protocol+"//"+window.location.host},a.change=function(){var e;e=this.getPath();if(e===this.path)return;return this.path=e,this.matchRoute(this.path)},a.matchRoute=function(e,t){var n,r,i,s;s=this.routes;for(r=0,i=s.length;r<i;r++){n=s[r];if(!n.match(e,t))continue;return this.trigger("change",n,e),n}},a.prototype.match=function(e,t){var n,r,i,s,o,u;t==null&&(t={}),r=this.route.exec(e);if(!r)return!1;t.match=r,s=r.slice(1);if(this.names.length)for(n=o=0,u=s.length;o<u;n=++o)i=s[n],t[this.names[n]]=i;return this.callback.call(null,t)!==!1},a}(r.Module),r.Route.change=r.Route.proxy(r.Route.change),r.Controller.include({route:function(e,t){return r.Route.add(e,this.proxy(t))},routes:function(e){var t,n,r;r=[];for(t in e)n=e[t],r.push(this.route(t,n));return r},navigate:function(){return r.Route.navigate.apply(r.Route,arguments)}}),typeof n!="undefined"&&n!==null&&(n.exports=r.Route)}).call(this)},"spine/lib/manager":function(e,t,n){(function(){var e,r,i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},o=[].slice;r=this.Spine||t("spine"),e=r.$,r.Manager=function(e){function t(){this.controllers=[],this.bind("change",this.change),this.add.apply(this,arguments)}return s(t,e),t.include(r.Events),t.prototype.add=function(){var e,t,n,r,i;t=1<=arguments.length?o.call(arguments,0):[],i=[];for(n=0,r=t.length;n<r;n++)e=t[n],i.push(this.addOne(e));return i},t.prototype.addOne=function(e){var t=this;return e.bind("active",function(){var n;return n=1<=arguments.length?o.call(arguments,0):[],t.trigger.apply(t,["change",e].concat(o.call(n)))}),e.bind("release",function(){return t.controllers.splice(t.controllers.indexOf(e),1)}),this.controllers.push(e)},t.prototype.deactivate=function(){return this.trigger.apply(this,["change",!1].concat(o.call(arguments)))},t.prototype.change=function(){var e,t,n,r,i,s,u;n=arguments[0],e=2<=arguments.length?o.call(arguments,1):[],s=this.controllers,u=[];for(r=0,i=s.length;r<i;r++)t=s[r],t===n?u.push(t.activate.apply(t,e)):u.push(t.deactivate.apply(t,e));return u},t}(r.Module),r.Controller.include({active:function(){var e;return e=1<=arguments.length?o.call(arguments,0):[],typeof e[0]=="function"?this.bind("active",e[0]):(e.unshift("active"),this.trigger.apply(this,e)),this},isActive:function(){return this.el.hasClass("active")},activate:function(){return this.el.addClass("active"),this},deactivate:function(){return this.el.removeClass("active"),this}}),r.Stack=function(e){function t(){var e,n,i,s,o,u=this;t.__super__.constructor.apply(this,arguments),this.manager=new r.Manager,s=this.controllers;for(e in s){n=s[e];if(this[e]!=null)throw Error("'@"+e+"' already assigned - choose a different name");this[e]=new n({stack:this}),this.add(this[e])}o=this.routes,i=function(e,t){var n;return typeof t=="function"&&(n=t),n||(n=function(){var e;return(e=u[t]).active.apply(e,arguments)}),u.route(e,n)};for(e in o)n=o[e],i(e,n);this["default"]&&this[this["default"]].active()}return s(t,e),t.prototype.controllers={},t.prototype.routes={},t.prototype.className="spine stack",t.prototype.add=function(e){return this.manager.add(e),this.append(e)},t}(r.Controller),typeof n!="undefined"&&n!==null&&(n.exports=r.Manager),typeof n!="undefined"&&n!==null&&(n.exports.Stack=r.Stack)}).call(this)},"spine/lib/relation":function(exports,require,module){(function(){var Collection,Instance,Singleton,Spine,association,isArray,require,singularize,underscore,__hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};Spine=this.Spine||require("spine"),isArray=Spine.isArray,require=this.require||function(value){return eval(value)},Collection=function(e){function t(e){var t,n;e==null&&(e={});for(t in e)n=e[t],this[t]=n}return __extends(t,e),t.prototype.all=function(){var e=this;return this.model.select(function(t){return e.associated(t)})},t.prototype.first=function(){return this.all()[0]},t.prototype.last=function(){var e;return e=this.all(),e[e.length-1]},t.prototype.count=function(){return this.all().length},t.prototype.find=function(e){var t,n=this;t=this.select(function(t){return""+t.id==""+e});if(!t[0])throw new Error('"'+this.model.className+'" model could not find a record for the ID "'+e+'"');return t[0]},t.prototype.findAllByAttribute=function(e,t){var n=this;return this.model.select(function(r){return n.associated(r)&&r[e]===t})},t.prototype.findByAttribute=function(e,t){return this.findAllByAttribute(e,t)[0]},t.prototype.select=function(e){var t=this;return this.model.select(function(n){return t.associated(n)&&e(n)})},t.prototype.refresh=function(e){var t,n,r,i,s,o,u,a,f,l,c;if(e==null)return this;l=this.all();for(i=0,u=l.length;i<u;i++){r=l[i],delete this.model.irecords[r.id],c=this.model.records;for(t=s=0,a=c.length;s<a;t=++s){n=c[t];if(n.id!==r.id)continue;this.model.records.splice(t,1);break}}isArray(e)||(e=[e]);for(o=0,f=e.length;o<f;o++)r=e[o],r.newRecord=!1,r[this.fkey]=this.record.id;return this.model.refresh(e),this},t.prototype.create=function(e,t){return e[this.fkey]=this.record.id,this.model.create(e,t)},t.prototype.add=function(e,t){return e.updateAttribute(this.fkey,this.record.id,t)},t.prototype.remove=function(e,t){return e.updateAttribute(this.fkey,null,t)},t.prototype.associated=function(e){return e[this.fkey]===this.record.id},t}(Spine.Module),Instance=function(e){function t(e){var t,n;e==null&&(e={});for(t in e)n=e[t],this[t]=n}return __extends(t,e),t.prototype.exists=function(){return this.record[this.fkey]?this.model.exists(this.record[this.fkey]):!1},t.prototype.update=function(e){return e==null?this:(e instanceof this.model||(e=new this.model(e)),e.isNew()&&e.save(),this.record[this.fkey]=e&&e.id,this)},t}(Spine.Module),Singleton=function(e){function t(e){var t,n;e==null&&(e={});for(t in e)n=e[t],this[t]=n}return __extends(t,e),t.prototype.find=function(){return this.record.id&&this.model.findByAttribute(this.fkey,this.record.id)},t.prototype.update=function(e){return e==null?this:(e instanceof this.model||(e=this.model.fromJSON(e)),e[this.fkey]=this.record.id,e.save(),this)},t}(Spine.Module),singularize=function(e){return e.replace(/s$/,"")},underscore=function(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()},association=function(e,t,n,r,i){return typeof t=="string"&&(t=require(t)),new i({name:e,model:t,record:n,fkey:r})},Spine.Model.extend({hasMany:function(e,t,n){return n==null&&(n=""+underscore(this.className)+"_id"),this.prototype[e]=function(r){return association(e,t,this,n,Collection).refresh(r)}},belongsTo:function(e,t,n){return n==null&&(n=""+underscore(singularize(e))+"_id"),this.prototype[e]=function(r){return association(e,t,this,n,Instance).update(r).exists()},this.attributes.push(n)},hasOne:function(e,t,n){return n==null&&(n=""+underscore(this.className)+"_id"),this.prototype[e]=function(r){return association(e,t,this,n,Singleton).update(r).find()}}}),Spine.Collection=Collection,Spine.Singleton=Singleton,Spine.Instance=Instance}).call(this)},"controllers/drawings":function(e,t,n){(function(){var e,r,i,s,o,u,a,f,l,c,h,p,d=function(e,t){return function(){return e.apply(t,arguments)}},v={}.hasOwnProperty,m=function(e,t){function r(){this.constructor=e}for(var n in t)v.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};f=t("models/palette_specification"),i=t("models/drawing"),Spine.SubStack=t("lib/substack"),e=t("views/drawings/canvas_renderer"),h=t("controllers/toolbox"),l=t("controllers/selection"),r=t("models/commands/commander"),a=t("models/palette"),u=t("models/node_shape"),o=function(e){function n(){this.extractFormData=d(this.extractFormData,this),this["delete"]=d(this["delete"],this),this.create=d(this.create,this),this.render=d(this.render,this),n.__super__.constructor.apply(this,arguments),this.active(this.render),i.bind("fetch",this.render)}return m(n,e),n.prototype.events={"submit form":"create","click .delete":"delete"},n.prototype.render=function(){var e;return e={drawings:i.all(),palette_specs:f.all()},this.html(t("views/drawings/index")(e))},n.prototype.create=function(e){var t,n,r;return e.preventDefault(),t=this.extractFormData($(e.target)),n=i.create({name:t.name}),n&&n.save()?(r=f.find(t.palette_specification_id).instantiate(),r.drawing_id=n.id,r.save(),this.navigate("/drawings",n.id)):this.$("input#name").focus()},n.prototype["delete"]=function(e){var t,n;return t=this.$(e.currentTarget),n=t.data("id"),i.destroy(n),this.render()},n.prototype.extractFormData=function(e){var t,n,r,i,s;n={},s=e.serializeArray();for(r=0,i=s.length;r<i;r++)t=s[r],n[t.name]=t.value;return n},n}(Spine.Controller),c=function(n){function s(){this.change=d(this.change,this),s.__super__.constructor.apply(this,arguments),this.active(this.change)}return m(s,n),s.prototype.change=function(e){return this.commander=new r,this.item=i.find(e.id),this.item.clearSelection(),this.log("Palette: "+this.item.palette().id),this.render()},s.prototype.render=function(){this.html(t("views/drawings/show"));if(this.item)return new e({drawing:this.item,canvas:this.$("#drawing")[0]}),this.toolbox=new h({commander:this.commander,item:this.item,el:this.$("#toolbox")}),this.selection=new l({commander:this.commander,item:this.item,el:this.$("#selection")})},s.prototype.deactivate=function(){s.__super__.deactivate.apply(this,arguments);if(this.toolbox)return this.toolbox.release()},s}(Spine.Controller),s=function(e){function t(){return p=t.__super__.constructor.apply(this,arguments),p}return m(t,e),t.prototype.controllers={index:o,show:c},t.prototype.routes={"/drawings":"index","/drawings/:id":"show"},t.prototype["default"]="index",t}(Spine.SubStack),n.exports=s}).call(this)},"controllers/link_tool":function(e,t,n){(function(){var e,r,i,s,o,u=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,f=function(e,t){function r(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};s=t("controllers/tool"),r=t("models/link"),e=t("models/commands/create_link"),i=function(t){function r(){return this.onMouseUp=u(this.onMouseUp,this),this.onMouseDrag=u(this.onMouseDrag,this),this.onMouseDown=u(this.onMouseDown,this),this.onMouseMove=u(this.onMouseMove,this),o=r.__super__.constructor.apply(this,arguments),o}var n;return f(r,t),r.prototype.parameters={shape:null},r.prototype.drafting=!1,r.prototype.timer=0,r.prototype.onMouseMove=function(e){},r.prototype.onMouseDown=function(e){if(this.parameters.shape&&this.hitTester.nodeAt(e.point))return this.drafting=!0,this.draftLink=new n(e.point)},r.prototype.onMouseDrag=function(e){var t;t=(new Date).getTime();if(t-this.timer>90){this.timer=t;if(this.drafting){this.draftLink.extendTo(e.point);if(this.hitTester.nodeAt(e.point))return this.changeSelectionTo(this.hitTester.nodeAt(e.point))}}},r.prototype.onMouseUp=function(t){var n;if(this.drafting)return this.hitTester.nodeAt(t.point)&&(n=this.draftLink.finalise(),this.parameters.sourceId=this.hitTester.nodeAt(n.firstSegment.point).id,this.parameters.targetId=this.hitTester.nodeAt(n.lastSegment.point).id,this.parameters.segments=n.segments,this.run(new e(this.drawing,this.parameters))),this.draftLink.remove(),this.clearSelection(),this.drafting=!1},n=function(){function e(e){this.path=new paper.Path([e]),this.path.layer.insertChild(0,this.path),this.path.strokeColor="black",this.path.dashArray=[10,4]}return e.prototype.extendTo=function(e){return this.path.add(e)},e.prototype.finalise=function(){return this.path.simplify(100),this.path},e.prototype.remove=function(){return this.path.remove()},e}(),r}(s),n.exports=i}).call(this)},"controllers/node_tool":function(e,t,n){(function(){var e,r,i,s,o=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},f=this;i=t("controllers/tool"),e=t("models/commands/create_node"),r=function(t){function n(){return this.onMouseDown=o(this.onMouseDown,this),s=n.__super__.constructor.apply(this,arguments),s}return a(n,t),n.prototype.parameters={shape:null},n.prototype.timer=0,n.prototype.onMouseDown=function(t){if(this.parameters.shape)return this.parameters.position=t.point,this.run(new e(this.drawing,this.parameters)),this.clearSelection()},n}(i),{onMouseMove:function(e){}},n.exports=r}).call(this)},"controllers/notations/eugenia_notation":function(e,t,n){(function(){var e,r;r=t("models/node_shape"),e=function(){function e(){}return e.prototype.reconstruct=function(e){return this.deserialise(this.serialise(e))},e.prototype.serialisePalette=function(e){return this.serialisePaletteHeader(e)+this.serialisePaletteBody(e)},e.prototype.serialisePaletteHeader=function(e){var t,n,r;return r=e.nodeShapes().all().concat(e.linkShapes().all()),t=function(){var e,t,i;i=[];for(e=0,t=r.length;e<t;e++)n=r[e],i.push("  val "+n.name+"[*] "+n.name.toLowerCase()+"s;");return i}().join("\n"),'@namespace(uri="yourlanguage", prefix="yourlanguage")\npackage yourlanguage;\n\n@gmf.diagram(foo="bar")\nclass Root {\n'+t+"\n}\n\nabstract class Element {}\n\n"},e.prototype.serialisePaletteBody=function(e){var t,n,r;return r=e.nodeShapes().all().concat(e.linkShapes().all()),t=function(){var e,t,i;i=[];for(e=0,t=r.length;e<t;e++)n=r[e],i.push(this.serialise(n));return i}.call(this),t.join("\n\n")},e.prototype.serialise=function(e){return e instanceof r?this.serialiseNode(e):this.serialiseLink(e)},e.prototype.serialiseNode=function(e){var t,n,r;return r="",e.elements&&e.elements.length>0&&(t=e.elements[0],t.borderColor&&(r&&(r+=", "),r+='border.color="'+this.serialiseColor(t.borderColor)+'"'),t.fillColor&&(r&&(r+=", "),r+='color="'+this.serialiseColor(t.fillColor)+'"'),t.figure&&(r&&(r+=", "),r+='figure="'+t.figure+'"'),t.size&&t.size.width&&t.size.height&&(r&&(r+=", "),r+='size="'+t.size.width+","+t.size.height+'"')),e.label?(n=e.label,n["for"]&&(r&&(r+=", "),r+='label="'+n["for"].join(",")+'"'),n.pattern&&(r&&(r+=", "),r+='label.pattern="'+n.pattern+'"'),n.placement&&(r&&(r+=", "),r+='label.placement="'+n.placement+'"'),n.length&&(r&&(r+=", "),r+='label.length="'+n.length+'"'),n.color&&(r&&(r+=", "),r+='label.color="'+this.serialiseColor(n.color)+'"')):(r&&(r+=", "),r+='label.placement="none"'),"@gmf.node("+r+")\nclass "+e.name+" extends Element {\n"+this.serialiseAttributes(e)+"\n}"},e.prototype.serialiseAttributes=function(e){var t;return e.properties?function(){var n,r,i,s;i=e.properties,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(this.serialiseAttribute(t));return s}.call(this).join("\n"):""},e.prototype.serialiseAttribute=function(e){return"  attr String[0..1] "+e+";"},e.prototype.serialiseLink=function(e){return e.style||(e.style="solid"),e.color||(e.color="black"),'@gmf.link(style="'+e.style+'", color="'+this.serialiseColor(e.color)+'", source="source", target="target")\nclass '+e.name+" {\n  ref Element[1] source;\n  ref Element[1] target;\n}"},e.prototype.serialiseColor=function(e){var t;return t=new paper.Color(e),""+t.red*255+","+t.green*255+","+t.blue*255},e.prototype.deserialise=function(e){return e.match(/@gmf.node/)?this.deserialiseNode(e):this.deserialiseLink(e)},e.prototype.deserialiseNode=function(e){var t,n,r,i,s,o;return r={},r.name=this.deserialiseName(e),r.properties=this.deserialiseAttributes(e),i=this.deserialiseProperties(e),n={},i.label&&(n["for"]=i.label.split(","),delete i.label),i["label.placement"]&&(n.placement=i["label.placement"],delete i["label.placement"]),i["label.pattern"]&&(n.pattern=i["label.pattern"],delete i["label.pattern"]),i["label.color"]&&(n.color=this.deserialiseColor(i["label.color"]),delete i["label.color"]),i["label.length"]&&(n.length=parseInt(i["label.length"]),delete i["label.length"]),i["border.color"]&&(i.borderColor=this.deserialiseColor(i["border.color"]),delete i["border.color"]),i.color&&(i.fillColor=this.deserialiseColor(i.color),delete i.color),i.size&&(o=i.size.split(",").slice(0,2),s=o[0],t=o[1],i.size={width:parseInt(s),height:parseInt(t)}),$.isEmptyObject(i)||(r.elements=[i]),$.isEmptyObject(n)||(r.label=n),r},e.prototype.deserialiseLink=function(e){var t;return t=this.deserialiseProperties(e),t.name=this.deserialiseName(e),t.color&&(t.color=this.deserialiseColor(t.color)),t.source&&delete t.source,t.target&&delete t.target,t},e.prototype.deserialiseColor=function(e){var t,n,r,i,s;return s=e.match("(\\d+),(\\d+),(\\d+)"),t=s[0],i=s[1],r=s[2],n=s[3],(new paper.Color(i/255,r/255,n/255)).toCssString()},e.prototype.deserialiseName=function(e){var t;return t=/class\s+(\w*)/,e.match(t)[1]},e.prototype.deserialiseAttributes=function(e){var t,n,r,i,s,o,u;n=/attr String\[0..1\] \w*;/g,t=/attr String\[0..1\] (\w*);/;if(e.match(n)){o=e.match(n),u=[];for(i=0,s=o.length;i<s;i++)r=o[i],u.push(r.match(t)[1]);return u}},e.prototype.deserialiseProperties=function(e){var t,n,r,i,s,o,u,a,f,l,c;o={},r=/@gmf\.\w*\((.*)\)/,n=e.match(r)[1],l=n.split(", ");for(a=0,f=l.length;a<f;a++)i=l[a],s=/([^=]*)="([^"]*)"/,c=i.match(s).slice(1,3),t=c[0],u=c[1],o[t]=u;return o},e}(),n.exports=e}).call(this)},"controllers/notations/json_notation":function(e,t,n){(function(){var e;e=function(){function e(){}return e.prototype.serialiseNode=function(e){return JSON.stringify(e,null,2)},e.prototype.serialiseLink=function(e){return JSON.stringify(e,null,2)},e.prototype.deserialise=function(e){return JSON.parse(e)},e}(),n.exports=e}).call(this)},"controllers/palettes":function(e,t,n){(function(){var e,r,i,s,o,u,a,f,l,c,h,p,d,v,m=function(e,t){return function(){return e.apply(t,arguments)}},g={}.hasOwnProperty,y=function(e,t){function r(){this.constructor=e}for(var n in t)g.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};o=t("controllers/notations/json_notation"),s=t("controllers/notations/eugenia_notation"),Spine.SubStack=t("lib/substack"),i=t("models/drawing"),a=t("models/node_shape"),u=t("models/link_shape"),f=t("models/palette"),r=function(e){function n(){this.extractFormData=m(this.extractFormData,this),this.removeIds=m(this.removeIds,this),this.back=m(this.back,this),this.cancel=m(this.cancel,this),this["delete"]=m(this["delete"],this),this.define=m(this.define,this),this.example_link=m(this.example_link,this),this.example_node=m(this.example_node,this),this.example=m(this.example,this),this.item=m(this.item,this),this.safe=m(this.safe,this),this.serialise=m(this.serialise,this),this.changeNotation=m(this.changeNotation,this),this.currentNotation=m(this.currentNotation,this),n.__super__.constructor.apply(this,arguments),this.notations={json:new o,eugenia:new s},this.notation="json",this.active(this.change)}return y(n,e),n.prototype.events={"submit form":"define","click [data-notation]":"changeNotation","click #delete":"delete","click #cancel":"cancel"},n.prototype.currentNotation=function(){return this.notations[this.notation]},n.prototype.change=function(e){return this._item=null,this.params=e,this.type=this.params.type.slice(0,-1),this.palette=i.find(this.params.d_id).palette(),this.render()},n.prototype.changeNotation=function(e){return e.preventDefault(),this.notation=$(e.target).data("notation"),this.render()},n.prototype.render=function(){var e;return e={serialisation:this.serialise(this.item()),example:this.serialise(this.example()),verb:this.verb(),type:this.type,notation:this.notation},this.html(t("views/palettes/define")(e))},n.prototype.serialise=function(e){return this.type==="node"?this.currentNotation().serialiseNode(this.safe(e)):this.currentNotation().serialiseLink(this.safe(e))},n.prototype.safe=function(e){return this.removeIds(e.toJSON())},n.prototype.item=function(){return this.type==="node"?this._item!=null?this._item:this._item=this.node():this._item!=null?this._item:this._item=this.link()},n.prototype.example=function(){return this.type==="node"?this._example!=null?this._example:this._example=this.example_node():this._example!=null?this._example:this._example=this.example_link()},n.prototype.example_node=function(){return new a({name:"InitialState",elements:[{figure:"ellipse",size:{width:10,height:10},fillColor:"white",borderColor:"black"}]})},n.prototype.example_link=function(){return new u({name:"Link",color:"gray",style:"dash"})},n.prototype.define=function(e){var t,n,r;e.preventDefault(),n=this.extractFormData($(e.target));try{return r=this.removeIds(this.currentNotation().deserialise(n.definition)),this.item().updateAttributes(r).save(),this.back()}catch(i){return t=i,this.log(t.message)}},n.prototype["delete"]=function(e){return e.preventDefault(),this.item().destroy(),this.back()},n.prototype.cancel=function(e){return e.preventDefault(),this.back()},n.prototype.back=function(){return this.navigate("/drawings/"+this.params.d_id)},n.prototype.removeIds=function(e){return delete e.id,delete e.palette_id,e},n.prototype.extractFormData=function(e){var t,n,r,i,s;n={},s=e.serializeArray();for(r=0,i=s.length;r<i;r++)t=s[r],n[t.name]=t.value;return n},n}(Spine.Controller),e=function(e){function t(){return this.link=m(this.link,this),this.node=m(this.node,this),this.verb=m(this.verb,this),p=t.__super__.constructor.apply(this,arguments),p}return y(t,e),t.prototype.verb=function(){return"Create"},t.prototype.node=function(){return new a({name:"TheNode",elements:[{}],palette_id:this.palette.id})},t.prototype.link=function(){return new u({name:"TheLink",palette_id:this.palette.id})},t}(r),h=function(e){function t(){return this.link=m(this.link,this),this.node=m(this.node,this),this.verb=m(this.verb,this),d=t.__super__.constructor.apply(this,arguments),d}return y(t,e),t.prototype.verb=function(){return"Update"},t.prototype.node=function(){return this.palette.nodeShapes().find(this.params.id)},t.prototype.link=function(){return this.palette.linkShapes().find(this.params.id)},t}(r),c=function(e){function n(){this.change=m(this.change,this),n.__super__.constructor.apply(this,arguments),this.active(this.change)}return y(n,e),n.prototype.change=function(e){return this.item=i.find(e.d_id).palette(),this.render()},n.prototype.render=function(){var e;return e={eugenia:(new s).serialisePalette(this.item)},this.html(t("views/palettes/show")(e))},n}(Spine.Controller),l=function(t){function n(){return v=n.__super__.constructor.apply(this,arguments),v}return y(n,t),n.prototype.controllers={create:e,edit:h,show:c},n.prototype.routes={"/drawings/:d_id/palette":"show","/drawings/:d_id/:type/new":"create","/drawings/:d_id/:type/:id":"edit"},n}(Spine.SubStack),n.exports=l}).call(this)},"controllers/select_tool":function(e,t,n){(function(){var e,r,i,s,o,u=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,f=function(e,t){function r(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};s=t("controllers/tool"),r=t("models/node"),e=t("models/commands/move_node"),i=function(t){function n(){return this.onMouseUp=u(this.onMouseUp,this),this.onMouseDrag=u(this.onMouseDrag,this),this.onMouseDown=u(this.onMouseDown,this),o=n.__super__.constructor.apply(this,arguments),o}return f(n,t),n.prototype.parameters={},n.prototype.timer=0,n.prototype.onMouseDown=function(e){return this.clearSelection(),this.select(this.hitTester.nodeOrLinkAt(e.point)),this.current=e.point,this.start=e.point},n.prototype.onMouseDrag=function(t){var n,i,s,o,u,a;n=(new Date).getTime();if(n-this.timer>100){this.timer=n,u=this.selection(),a=[];for(s=0,o=u.length;s<o;s++){i=u[s];if(!(i instanceof r))continue;this.run(new e(i,t.point.subtract(this.current)),{undoable:!1}),a.push(this.current=t.point)}return a}},n.prototype.onMouseUp=function(t){var n,i,s,o,u;o=this.selection(),u=[];for(i=0,s=o.length;i<s;i++)n=o[i],n instanceof r&&u.push(this.commander.add(new e(n,t.point.subtract(this.start))));return u},n}(s),n.exports=i}).call(this)},"controllers/selection":function(e,t,n){(function(){var e,r,i,s=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};i=t("spine"),e=t("models/commands/change_property"),r=function(n){function r(){this.updatePropertyValue=s(this.updatePropertyValue,this),this.render=s(this.render,this),r.__super__.constructor.apply(this,arguments),this.item.bind("update",this.render),this.render()}return u(r,n),r.prototype.events={"change input[data-property]":"updatePropertyValue"},r.prototype.render=function(){if(this.item)return this.selection=null,this.item.selection.length===1&&(this.selection=this.item.selection[0]),this.html(t("views/drawings/selection")(this.selection))},r.prototype.updatePropertyValue=function(t){var n,r;return r=$(t.target).data("property"),n=$(t.target).val(),this.commander.run(new e(this.selection,r,n))},r}(i.Controller),n.exports=r}).call(this)},"controllers/tool":function(e,t,n){(function(){var e,r,i,s,o,u=function(e,t){return function(){return e.apply(t,arguments)}};i=t("models/node"),r=t("models/link"),e=t("models/commands/delete_element"),o=function(){function t(e){this.onKeyDown=u(this.onKeyDown,this),this.activate=u(this.activate,this),this.commander=e.commander,this.hitTester=e.hitTester,this.hitTester||(this.hitTester=new s),this.drawing=e.drawing,this._tool=new paper.Tool,this._tool.onMouseMove=this.onMouseMove,this._tool.onMouseDrag=this.onMouseDrag,this._tool.onMouseDown=this.onMouseDown,this._tool.onMouseUp=this.onMouseUp,this._tool.onKeyDown=this.onKeyDown,this._tool.onKeyUp=this.onKeyUp}return t.prototype.activate=function(){return this._tool.activate()},t.prototype.setParameter=function(e,t){return this.parameters||(this.parameters={}),this.parameters[e]=t},t.prototype.run=function(e,t){return t==null&&(t={undoable:!0}),this.commander.run(e,t)},t.prototype.onKeyDown=function(t){var n,r,i,s;if(document.activeElement===document.body){if(t.key==="delete"){s=this.selection();for(r=0,i=s.length;r<i;r++)n=s[r],this.run(new e(this.drawing,n));return this.clearSelection()}if(t.key==="z")return this.commander.undo()}},t.prototype.changeSelectionTo=function(e){return this.clearSelection(),this.select(e)},t.prototype.clearSelection=function(){return this.drawing.clearSelection()},t.prototype.select=function(e){return this.drawing.select(e)},t.prototype.selection=function(){return this.drawing.selection},t}(),s=function(){function e(){}return e.prototype.nodeOrLinkAt=function(e){var t;return t=this.nodeAt(e),t||(t=this.linkAt(e)),t},e.prototype.linkAt=function(e){return this.xAt(e,r)},e.prototype.nodeAt=function(e){return this.xAt(e,i)},e.prototype.xAt=function(e,t){var n;n=paper.project.hitTest(e);if(n&&n.item.model instanceof t)return n.item.model},e}(),n.exports=o}).call(this)},"controllers/toolbox":function(e,t,n){(function(){var e,r,i,s,o,u,a,f=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,c=function(e,t){function r(){this.constructor=e}for(var n in t)l.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};u=t("spine"),r=t("controllers/link_tool"),s=t("controllers/node_tool"),o=t("controllers/select_tool"),i=t("models/node_shape"),e=t("models/link_shape"),a=function(n){function u(){this.switchTo=f(this.switchTo,this),this.reactToToolSelection=f(this.reactToToolSelection,this),this.showEditor=f(this.showEditor,this),this.render=f(this.render,this),u.__super__.constructor.apply(this,arguments),this.render(),i.bind("change",this.render),e.bind("change",this.render),this.createTools(),this.switchTo("select")}return c(u,n),u.prototype.events={"click a[data-tool-name]":"reactToToolSelection","dblclick a":"showEditor"},u.prototype.createTools=function(){return paper.tools=[],this.tools={node:new s({commander:this.commander,drawing:this.item}),select:new o({commander:this.commander,drawing:this.item}),link:new r({commander:this.commander,drawing:this.item})}},u.prototype.render=function(){if(this.item)return this.html(t("views/drawings/toolbox")(this.item))},u.prototype.showEditor=function(e){var t,n;e.preventDefault(),t=$(e.currentTarget),n=t.data("toolName");if(n!=="select")return this.navigate("/drawings/"+this.item.id+"/"+n+"s/"+t.data("toolShape"))},u.prototype.reactToToolSelection=function(e){var t;return t=$(e.currentTarget),this.switchTo(t.data("toolName")),this.currentTool.setParameter("shape",t.data("toolShape")),$("li.active").removeClass("active"),t.parent().addClass("active"),e.preventDefault()},u.prototype.switchTo=function(e){if(!this.tools[e])throw"There is no tool named '"+e+"'";return this.currentTool=this.tools[e],this.currentTool.activate()},u}(u.Controller),n.exports=a}).call(this)},index:function(e,t,n){(function(){var e,r,i,s,o={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)o.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};t("lib/setup"),t("lib/fetch_models"),s=t("spine"),r=t("controllers/drawings"),i=t("controllers/palettes"),e=function(e){function t(){t.__super__.constructor.apply(this,arguments),s.Route.setup(),this.navigate("/drawings")}return u(t,e),t.prototype.controllers={palettes:i,drawings:r},t.prototype.routes={"/drawings/:d_id/palette":"palettes","/drawings":"drawings"},t.prototype["default"]="drawings",t}(s.Stack),n.exports=e}).call(this)},"lib/bootstrap":function(e,t,n){!function(e){e(function(){"use strict";e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function s(){i.trigger("closed").remove()}var n=e(this),r=n.attr("data-target"),i;r||(r=n.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),i=e(r),t&&t.preventDefault(),i.length||(i=n.hasClass("alert")?n:n.parent()),i.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;i.removeClass("in"),e.support.transition&&i.hasClass("fade")?i.on(e.support.transition.end,s):s()},e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e(function(){e("body").on("click.alert.data-api",t,n.prototype.close)})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.parent('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")},e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=n,this.options.slide&&this.slide(this.options.slide),this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},to:function(t){var n=this.$element.find(".item.active"),r=n.parent().children(),i=r.index(n),s=this;if(t>r.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){s.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",e(r[t]))},pause:function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle()),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".item.active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",a=this,f=e.Event("slide",{relatedTarget:i[0]});this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u]();if(i.hasClass("active"))return;if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(f);if(f.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger("slid")},0)})}else{this.$element.trigger(f);if(f.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}},e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e(function(){e("body").on("click.carousel.data-api","[data-slide]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=!i.data("modal")&&e.extend({},i.data(),n.data());i.carousel(s),t.preventDefault()})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning)return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),e.support.transition&&this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning)return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=typeof n=="object"&&n;i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e(function(){e("body").on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();n[e(i).hasClass("in")?"addClass":"removeClass"]("collapsed"),e(i).collapse(s)})})}(window.jQuery),!function(e){"use strict";function r(){i(e(t)).removeClass("open")}function i(t){var n=t.attr("data-target"),r;return n||(n=t.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),r=e(n),r.length||(r=t.parent()),r}var t="[data-toggle=dropdown]",n=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};n.prototype={constructor:n,toggle:function(t){var n=e(this),s,o;if(n.is(".disabled, :disabled"))return;return s=i(n),o=s.hasClass("open"),r(),o||(s.toggleClass("open"),n.focus()),!1},keydown:function(t){var n,r,s,o,u,a;if(!/(38|40|27)/.test(t.keyCode))return;n=e(this),t.preventDefault(),t.stopPropagation();if(n.is(".disabled, :disabled"))return;o=i(n),u=o.hasClass("open");if(!u||u&&t.keyCode==27)return n.click();r=e("[role=menu] li:not(.divider) a",o);if(!r.length)return;a=r.index(r.filter(":focus")),t.keyCode==38&&a>0&&a--,t.keyCode==40&&a<r.length-1&&a++,~a||(a=0),r.eq(a).focus()}},e.fn.dropdown=function(t){return this.each(function(){var r=e(this),i=r.data("dropdown");i||r.data("dropdown",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.dropdown.Constructor=n,e(function(){e("html").on("click.dropdown.data-api touchstart.dropdown.data-api",r),e("body").on("click.dropdown touchstart.dropdown.data-api",".dropdown",function(e){e.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",t,n.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",t+", [role=menu]",n.prototype.keydown)})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;e("body").addClass("modal-open"),this.isShown=!0,this.escape(),this.backdrop(function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1).focus(),t.enforceFocus(),n?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")})},hide:function(t){t&&t.preventDefault();var n=this;t=e.Event("hide"),this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=!1,e("body").removeClass("modal-open"),this.escape(),e(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){t.$element[0]!==e.target&&!t.$element.has(e.target).length&&t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){t.which==27&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(e.support.transition.end),t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(e){this.$element.hide().trigger("hidden"),this.backdrop()},removeBackdrop:function(){this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var i=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.options.backdrop!="static"&&this.$backdrop.click(e.proxy(this.hide,this)),i&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),i?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(this.removeBackdrop,this)):this.removeBackdrop()):t&&t()}},e.fn.modal=function(n){return this.each(function(){var r=e(this),i=r.data("modal"),s=e.extend({},e.fn.modal.defaults,r.data(),typeof n=="object"&&n);i||r.data("modal",i=new t(this,s)),typeof n=="string"?i[n]():s.show&&i.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=t,e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r=n.attr("href"),i=e(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({remote:!/#/.test(r)&&r},i.data(),n.data());t.preventDefault(),i.modal(s).one("hide",function(){n.focus()})})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,this.options.trigger=="click"?this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this)):this.options.trigger!="manual"&&(i=this.options.trigger=="hover"?"mouseenter":"focus",s=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(i+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.show)return n.show();clearTimeout(this.timeout),n.hoverState="in",this.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(s),e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body),n=this.getPosition(t),r=e[0].offsetWidth,i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}e.css(o).addClass(s).addClass("in")}},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function r(){var t=setTimeout(function(){n.off(e.support.transition.end).remove()},500);n.one(e.support.transition.end,function(){clearTimeout(t),n.remove()})}var t=this,n=this.tip();return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?r():n.remove(),this},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}},e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0,html:!0}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content > *")[this.options.html?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}}),e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(e){"use strict";function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll-spy.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var t=e(this),n=t.data("target")||t.attr("href"),r=/^#\w/.test(n)&&e(n);return r&&r.length&&[[r.position().top,n]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}},e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e(window).on("load",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active a").last()[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function o(){i.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var i=n.find("> .active"),s=r&&e.support.transition&&i.hasClass("fade");s?i.one(e.support.transition.end,o):o(),i.removeClass("in")}},e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e(function(){e("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=e(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:t.top+t.height,left:t.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=e.grep(t,function(e){return n.matcher(e)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),(e.browser.webkit||e.browser.msie)&&this.$element.on("keydown",e.proxy(this.keydown,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault(),this.prev();break;case 40:e.preventDefault(),this.next()}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=!~e.inArray(t.keyCode,[40,38,9,13,27]),this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},blur:function(e){var t=this;setTimeout(function(){t.hide()},150)},click:function(e){e.stopPropagation(),e.preventDefault(),this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")}},e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},e.fn.typeahead.Constructor=t,e(function(){e("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;t.preventDefault(),n.typeahead(n.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.options=e.extend({},e.fn.affix.defaults,n),this.$window=e(window).on("scroll.affix.data-api",e.proxy(this.checkPosition,this)),this.$element=e(t),this.checkPosition()};t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var t=e(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),i=this.options.offset,s=i.bottom,o=i.top,u="affix affix-top affix-bottom",a;typeof i!="object"&&(s=o=i),typeof o=="function"&&(o=i.top()),typeof s=="function"&&(s=i.bottom()),a=this.unpin!=null&&n+this.unpin<=r.top?!1:s!=null&&r.top+this.$element.height()>=t-s?"bottom":o!=null&&n<=o?"top":!1;if(this.affixed===a)return;this.affixed=a,this.unpin=a=="bottom"?r.top-n:null,this.$element.removeClass(u).addClass("affix"+(a?"-"+a:""))},e.fn.affix=function(n){return this.each(function(){var r=e(this),i=r.data("affix"),s=typeof n=="object"&&n;i||r.data("affix",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.affix.Constructor=t,e.fn.affix.defaults={offset:0},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery)},"lib/fetch_models":function(e,t,n){(function(){var e,n,r,i,s,o;e=t("spine"),i=["palette_specification","palette","link_shape","node_shape","drawing","node","link"];for(s=0,o=i.length;s<o;s++)r=i[s],n=t("models/"+r),r!=="palette_specification"&&n.extend(e.Model.Realtime),r==="palette_specification"&&n.fetch()}).call(this)},"lib/setup":function(e,t,n){(function(){t("json2ify"),t("es5-shimify"),t("jqueryify"),t("lib/bootstrap"),t("spine"),t("spine/lib/local"),t("spine/lib/ajax"),t("spine/lib/manager"),t("spine/lib/route"),t("spine/lib/relation"),t("models/realtime")}).call(this)},"lib/substack":function(e,t,n){(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};Spine.SubStack=function(e){function n(){var e,t,r,i,s=this;i=this.routes,r=function(e,t){return s.routes[e]=function(){var e;return s.active(),(e=s[t]).active.apply(e,arguments)}};for(e in i)t=i[e],r(e,t);n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(Spine.Stack),n.exports=Spine.SubStack}).call(this)},"models/commands/change_property":function(e,t,n){(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e,n,r){this.element=e,this.property=n,this.newValue=r,this.undo=t(this.undo,this),this.run=t(this.run,this)}return e.prototype.run=function(){return this.oldValue=this.element.getPropertyValue(this.property),this.element.setPropertyValue(this.property,this.newValue)},e.prototype.undo=function(){return this.element.setPropertyValue(this.property,this.oldValue)},e}(),n.exports=e}).call(this)},"models/commands/commander":function(e,t,n){(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(){this.undo=t(this.undo,this),this.run=t(this.run,this),this.add=t(this.add,this),this.history=[]}return e.prototype.add=function(e){return this.history.push(e)},e.prototype.run=function(e,t){return t==null&&(t={undoable:!0}),t.undoable&&this.add(e),e.run()},e.prototype.undo=function(){if(this.history.length)return this.history.pop().undo()},e}(),n.exports=e}).call(this)},"models/commands/create_link":function(e,t,n){(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e,n){this.drawing=e,this.parameters=n,this.undo=t(this.undo,this),this.run=t(this.run,this)}return e.prototype.run=function(){return this.link=this.drawing.addLink(this.parameters)},e.prototype.undo=function(){return this.link.destroy()},e}(),n.exports=e}).call(this)},"models/commands/create_node":function(e,t,n){(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e,n){this.drawing=e,this.parameters=n,this.undo=t(this.undo,this),this.run=t(this.run,this)}return e.prototype.run=function(){return this.node=this.drawing.addNode(this.parameters)},e.prototype.undo=function(){return this.node.destroy()},e}(),n.exports=e}).call(this)},"models/commands/delete_element":function(e,t,n){(function(){var e,r,i,s,o=function(e,t){return function(){return e.apply(t,arguments)}};i=t("models/commands/delete_node"),r=t("models/commands/delete_link"),s=t("models/node"),e=function(){function e(e,t){this.undo=o(this.undo,this),this.run=o(this.run,this),t instanceof s?this.delegate=new i(e,t):this.delegate=new r(e,t)}return e.prototype.run=function(){return this.delegate.run()},e.prototype.undo=function(){return this.delegate.undo()},e}(),n.exports=e}).call(this)},"models/commands/delete_link":function(e,t,n){(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e,n){this.drawing=e,this.link=n,this.rebase=t(this.rebase,this),this.undo=t(this.undo,this),this.run=t(this.run,this)}return e.prototype.run=function(){return this.memento=this.link.destroy()},e.prototype.undo=function(){return this.drawing.addLink(this.memento)},e.prototype.rebase=function(e,t){this.memento.sourceId===e&&(this.memento.sourceId=t);if(this.memento.targetId===e)return this.memento.targetId=t},e}(),n.exports=e}).call(this)},"models/commands/delete_node":function(e,t,n){(function(){var e,r,i=function(e,t){return function(){return e.apply(t,arguments)}};e=t("models/commands/delete_link"),r=function(){function t(e,t){this.drawing=e,this.node=t,this.undoDeleteLinks=i(this.undoDeleteLinks,this),this.runDeleteLinks=i(this.runDeleteLinks,this),this.undo=i(this.undo,this),this.run=i(this.run,this)}return t.prototype.run=function(){return this.runDeleteLinks(),this.nodeMemento=this.node.destroy()},t.prototype.undo=function(){var e;return e=this.node.id,this.node=this.drawing.addNode(this.nodeMemento),this.undoDeleteLinks(e,this.node.id)},t.prototype.runDeleteLinks=function(){var t,n,r,i,s,o;this.linkCommands=[],s=this.node.links(),o=[];for(r=0,i=s.length;r<i;r++)n=s[r],t=new e(this.drawing,n),t.run(),o.push(this.linkCommands.push(t));return o},t.prototype.undoDeleteLinks=function(e,t){var n,r,i,s,o;s=this.linkCommands,o=[];for(r=0,i=s.length;r<i;r++)n=s[r],n.rebase(e,t),o.push(n.undo());return o},t}(),n.exports=r}).call(this)},"models/commands/logging_commander":function(e,t,n){(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e){this.delegate=e,this.log=t(this.log,this),this.undo=t(this.undo,this),this.run=t(this.run,this),this.add=t(this.add,this)}return e.prototype.add=function(e){return this.delegate.add(e)},e.prototype.run=function(e,t){return t==null&&(t={undoable:!0}),this.delegate.run(e,t),this.log("Run",e)},e.prototype.undo=function(e){return this.delegate.undo(e),this.log("Undo",e)},e.prototype.log=function(e,t){return console.log(e+": "+JSON.stringify(t))},e}(),n.exports=e}).call(this)},"models/commands/move_node":function(e,t,n){(function(){var e,r,i=function(e,t){return function(){return e.apply(t,arguments)}};r=t("models/point"),e=function(){function e(e,t){this.node=e,this.undo=i(this.undo,this),this.run=i(this.run,this),this.offset=new r(t.x,t.y)}return e.prototype.run=function(){return this.node.moveBy(this.offset)},e.prototype.undo=function(){return this.node.moveBy(this.offset.invert())},e}(),n.exports=e}).call(this)},"models/drawing":function(e,t,n){(function(){var e,r,i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=t("spine"),e=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.selection||(this.selection=[]),this.bind("destroy",this.destroyChildren),this.bind("selectionChanged",this.updateCanvas)}return s(t,e),t.configure("Drawing","name","selection","cache"),t.hasOne("palette","models/palette"),t.hasMany("nodes","models/node"),t.hasMany("links","models/link"),t.prototype.select=function(e){if(e)return this.selection.push(e),this.save(),this.trigger("selectionChanged")},t.prototype.clearSelection=function(){return this.selection=[],this.save(),this.trigger("selectionChanged")},t.prototype.validate=function(){if(!this.name)return"Name is required"},t.prototype.destroyChildren=function(){var e,t,n,r,i,s,o,u;o=this.nodes().all();for(n=0,i=o.length;n<i;n++)t=o[n],t.destroy();u=this.links().all();for(r=0,s=u.length;r<s;r++)e=u[r],e.destroy();if(this.palette())return this.palette().destroy()},t.prototype.addNode=function(e){return this.nodes().create(e)},t.prototype.addLink=function(e){return this.links().create(e)},t.prototype.updateCanvas=function(){var e,t,n,r,i;if(paper.project){paper.project.activeLayer.selected=!1,r=this.selection!=null,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.select(paper.project.activeLayer));return i}},t}(r.Model),n.exports=e}).call(this)},"models/link":function(e,t,n){(function(){var e,r,i,s,o,u=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,f=function(e,t){function r(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};o=t("spine"),i=t("models/moves_path"),s=t("models/simplifies_segments"),r=t("models/link_shape"),e=function(e){function t(e){this.toSegments=u(this.toSegments,this),this.destroy=u(this.destroy,this),this.select=u(this.select,this),this.toPath=u(this.toPath,this),this.paperId=u(this.paperId,this),this.reconnectTo=u(this.reconnectTo,this),this.updateSegments=u(this.updateSegments,this);var n,r;t.__super__.constructor.apply(this,arguments);for(n in e)r=e[n],this.k=r;e&&this.updateSegments(e.segments)}return f(t,e),t.configure("Link","sourceId","targetId","segments","shape"),t.belongsTo("drawing","models/drawing"),t.prototype.select=function(){return this.drawing().select(this)},t.prototype.updateSegments=function(e){return this.segments=(new s)["for"](e)},t.prototype.reconnectTo=function(e,t){var n;return n=new i(this.toPath(),t),e===this.sourceId&&n.moveStart(),e===this.targetId&&n.moveEnd(),this.updateSegments(n.finalise()),this.save()},t.prototype.paperId=function(){return"link"+this.id},t.prototype.toPath=function(){var e,t;return t=r.find(this.shape),e=t.draw(this.toSegments()),e.name=this.paperId(),e},t.prototype.select=function(e){return e.children[this.paperId()].selected=!0},t.prototype.destroy=function(e){var n,r;return e==null&&(e={}),n=t.__super__.destroy.call(this,e),r={sourceId:n.sourceId,targetId:n.targetId,segments:n.segments,shape:n.shape}},t.prototype.toSegments=function(){var e,t,n,r,i;r=this.segments,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(new paper.Segment(e.point,e.handleIn,e.handleOut));return i},t}(o.Model),n.exports=e}).call(this)},"models/link_shape":function(e,t,n){(function(){var e,r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=t("spine"),e=function(e){function n(e){this.draw=i(this.draw,this),this.displayName=i(this.displayName,this),n.__super__.constructor.apply(this,arguments),this.bind("destroy",this.destroyLinks)}return o(n,e),n.configure("LinkShape","name","color","style"),n.belongsTo("palette","models/palette"),n.prototype.displayName=function(){return this.name.charAt(0).toUpperCase()+this.name.slice(1)},n.prototype.draw=function(e){var t;return t=new paper.Path(e),t.strokeColor=this.color,this.style==="dash"&&(t.dashArray=[4,4]),t},n.prototype.destroyLinks=function(){var e,n,r,i,s;i=t("models/link").findAllByAttribute("shape",this.id),s=[];for(n=0,r=i.length;n<r;n++)e=i[n],s.push(e.destroy());return s},n}(r.Model),n.exports=e}).call(this)},"models/moves_path":function(e,t,n){(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e,n){this.finalise=t(this.finalise,this),this.moveEnd=t(this.moveEnd,this),this.moveStart=t(this.moveStart,this),this.path=e,this.offset=n}return e.prototype.moveStart=function(){return this.path.firstSegment.point.x+=this.offset.x,this.path.firstSegment.point.y+=this.offset.y},e.prototype.moveEnd=function(){return this.path.lastSegment.point.x+=this.offset.x,this.path.lastSegment.point.y+=this.offset.y},e.prototype.finalise=function(){return this.path.removeSegments(1,this.path.segments.size-2),this.path.simplify(100),this.path.remove(),this.path.segments},e}(),n.exports=e}).call(this)},"models/node":function(e,t,n){(function(){var e,r,i,s,o=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};s=t("spine"),e=t("models/link"),i=t("models/node_shape"),r=function(t){function n(e){this.nodeShape=o(this.nodeShape,this),this.destroy=o(this.destroy,this),this.select=o(this.select,this),this.toPath=o(this.toPath,this),this.paperId=o(this.paperId,this),this.moveBy=o(this.moveBy,this),this.links=o(this.links,this);var t,r;n.__super__.constructor.apply(this,arguments);for(t in e)r=e[t],this.k=r;this.initialisePropertyValues()}return a(n,t),n.configure("Node","shape","position","propertyValues"),n.belongsTo("drawing","models/drawing"),n.prototype.initialisePropertyValues=function(){return this.nodeShape()&&(this.propertyValues||(this.propertyValues=this.nodeShape().defaultPropertyValues())),this.propertyValues||(this.propertyValues={})},n.prototype.setPropertyValue=function(e,t){return this.propertyValues[e]=t,this.save()},n.prototype.getPropertyValue=function(e){return this.propertyValues[e]},n.prototype.links=function(){var t=this;return e.select(function(e){return e.sourceId===t.id||e.targetId===t.id})},n.prototype.moveBy=function(e){var t,n,r,i;this.position=e.add(this.position),i=this.links();for(n=0,r=i.length;n<r;n++)t=i[n],t.reconnectTo(this.id,e);return this.save()},n.prototype.paperId=function(){return"node"+this.id},n.prototype.toPath=function(){var e;return e=this.nodeShape().draw(this),e.name=this.paperId(),e},n.prototype.select=function(e){return e.children[this.paperId()].selected=!0},n.prototype.destroy=function(e){var t,r;return e==null&&(e={}),t=n.__super__.destroy.call(this,e),r={shape:t.shape,position:t.position}},n.prototype.nodeShape=function(){if(this.shape&&i.exists(this.shape))return i.find(this.shape)},n}(s.Model),n.exports=r}).call(this)},"models/node_shape":function(e,t,n){(function(){var e,r,i,s,o=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty,a=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};s=t("spine"),r=function(){function e(e){this.definition=e,this.definition&&this.definition.placement!=="none"?(this.definition["for"]instanceof Array||(this.definition["for"]=[this.definition["for"]]),this.definition.pattern||(this.definition.pattern=this.default_pattern())):this.definition={placement:"none"}}return e.prototype.default_pattern=function(){var e,t,n,r,i,s;return n=function(){s=[];for(var e=0,t=this.definition["for"].length-1;0<=t?e<=t:e>=t;0<=t?e++:e--)s.push(e);return s}.apply(this),e=function(){var e,r,i;i=[];for(e=0,r=n.length;e<r;e++)t=n[e],i.push("{"+t+"}");return i}(),e.join(",")},e.prototype.draw=function(e,t){var n,r;return r=new paper.Group(t),this.definition.placement!=="none"&&(n=this.positionFor(t),r.addChild(this.createText(e,n))),r},e.prototype.positionFor=function(e){return this.definition.placement==="external"?e.bounds.bottomCenter.add([0,20]):e.position.add([0,5])},e.prototype.createText=function(e,t){var n;return n=new paper.PointText(t),n.justification="center",n.fillColor=this.definition.color,n.content=this.contentFor(e),n},e.prototype.contentFor=function(e){var t,n,r,i,s,o;t=this.definition.pattern;for(n=s=0,o=this.definition["for"].length-1;0<=o?s<=o:s>=o;n=0<=o?++s:--s)r=RegExp("\\{"+n+"\\}","g"),i=e.getPropertyValue(this.definition["for"][n]),t=t.replace(r,i);return this.trimText(t)},e.prototype.trimText=function(e){return e?e.length>this.definition.length?e.substring(0,this.definition.length-3).trim()+"...":e:""},e}(),e=function(){function e(e){this.createPath=o(this.createPath,this),this.createElement=o(this.createElement,this),this.elements=e}return e.prototype.draw=function(e){var t,n;return t=function(){var t,r,i,s;i=this.elements,s=[];for(t=0,r=i.length;t<r;t++)n=i[t],s.push(this.createElement(n,e.position));return s}.call(this),new paper.Group(t)},e.prototype.createElement=function(e,t){var n;return e.x||(e.x=0),e.y||(e.y=0),n=this.createPath(e.figure,e.size),n.position=(new paper.Point(t)).add(e.x,e.y),n.fillColor=e.fillColor,n.strokeColor=e.borderColor,n},e.prototype.createPath=function(e,t){var n;switch(e){case"rounded":return n=new paper.Rectangle(0,0,t.width,t.height),new paper.Path.RoundRectangle(n,new paper.Size(10,10));case"ellipse":return n=new paper.Rectangle(0,0,t.width*2,t.height*2),new paper.Path.Oval(n);case"rectangle":return new paper.Path.Rectangle(0,0,t.width,t.height)}},e}(),i=function(n){function i(e){this.draw=o(this.draw,this),this.displayName=o(this.displayName,this),this.defaultPropertyValues=o(this.defaultPropertyValues,this),this.createDelegates=o(this.createDelegates,this),i.__super__.constructor.apply(this,arguments),this.createDelegates(),this.bind("update",this.createDelegates),this.bind("destroy",this.destroyNodes)}return a(i,n),i.configure("NodeShape","name","properties","label","elements"),i.belongsTo("palette","models/palette"),i.prototype.createDelegates=function(){return this._elements=new e(this.elements),this._label=new r(this.label)},i.prototype.defaultPropertyValues=function(){var e,t,n,r,i;e={};if(this.properties){i=this.properties;for(n=0,r=i.length;n<r;n++)t=i[n],e[t]=""}return e},i.prototype.displayName=function(){return this.name.charAt(0).toUpperCase()+this.name.slice(1)},i.prototype.draw=function(e){return this._label.draw(e,this._elements.draw(e))},i.prototype.destroyNodes=function(){var e,n,r,i,s;i=t("models/node").findAllByAttribute("shape",this.id),s=[];for(n=0,r=i.length;n<r;n++)e=i[n],s.push(e.destroy());return s},i}(s.Model),n.exports=i}).call(this)},"models/palette":function(e,t,n){(function(){var e,r,i={}.hasOwnProperty,s=function(e,t){function r(){this.constructor=e}for(var n in t)i.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};r=t("spine"),e=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.bind("destroy",this.destroyChildren)}return s(t,e),t.configure("Palette"),t.hasMany("nodeShapes","models/node_shape"),t.hasMany("linkShapes","models/link_shape"),t.belongsTo("drawing","models/drawing"),t.prototype.destroyChildren=function(){var e,t,n,r,i,s,o,u,a;o=this.nodeShapes().all();for(n=0,i=o.length;n<i;n++)t=o[n],t.destroy();u=this.linkShapes().all(),a=[];for(r=0,s=u.length;r<s;r++)e=u[r],a.push(e.destroy());return a},t}(r.Model),n.exports=e}).call(this)},"models/palette_specification":function(e,t,n){(function(){var e,r,i,s,o,u,a=function(e,t){return function(){return e.apply(t,arguments)}},f={}.hasOwnProperty,l=function(e,t){function r(){this.constructor=e}for(var n in t)f.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};s=t("spine"),e=t("models/palette"),o=function(){function e(){}return e.create=function(){return r.create({name:"State Machine",json:this.json()}).save()},e.json=function(){return'{      "name": "State Machine",      "nodeShapes": [        {          "name": "State",          "properties": ["name", "recurrent"],          "label" : {            "for" : "name",            "color" : "green",            "placement" : "internal",            "length" : 15          },          "elements": [            {              "figure": "rounded",              "size": {"width": 100, "height": 50},              "fillColor": "white",              "borderColor": "black"            }          ]        },        {          "name": "Initial",          "properties": ["name"],          "elements": [            {              "figure": "ellipse",              "size": {"width": 10, "height": 10},              "fillColor": "black",              "borderColor": "black"            }          ]        },        {          "name": "Final",          "properties": ["name"],          "elements": [            {              "figure": "ellipse",              "size": {"width": 10, "height": 10},              "fillColor": "white",              "borderColor": "black"            },            {              "figure": "ellipse",              "size": {"width": 7, "height": 7},              "fillColor": "black",              "borderColor": "black"            }          ]        }      ],      "linkShapes": [        {          "name": "Transition",          "color": "black",          "style": "solid"        },        {          "name": "Dependency",          "color": "gray",          "style": "dash"        }      ]    }'},e}(),i=function(){function e(){}return e.create=function(){return r.create({name:"Petri net",json:this.json()}).save()},e.json=function(){return'{      "name": "Petri net",      "nodeShapes": [        {          "name": "Net",          "elements": [            {              "figure": "ellipse",              "size": {"width": 30, "height": 30},              "fillColor": "white",              "borderColor": "black"            }          ]        },        {          "name": "Arc",          "elements": [            {              "figure": "rectangle",              "size": {"width": 10, "height": 50},              "fillColor": "black",              "borderColor": "black"            }          ]        }      ],      "linkShapes": [        {          "name": "Transition",          "color": "black",          "style": "solid"        }      ]    }'},e}(),r=function(t){function n(){return this.instantiate=a(this.instantiate,this),u=n.__super__.constructor.apply(this,arguments),u}return l(n,t),n.configure("PaletteSpecification","name","json"),n.fetch=function(){return o.create(),i.create()},n.prototype.instantiate=function(){var t,n,r,i,s,o,u,a,f,l;t=JSON.parse(this.json),i=e.create().save();if(t.nodeShapes){f=t.nodeShapes;for(s=0,u=f.length;s<u;s++)r=f[s],i.nodeShapes().create(r).save()}if(t.linkShapes){l=t.linkShapes;for(o=0,a=l.length;o<a;o++)n=l[o],i.linkShapes().create(n).save()}return i},n}(s.Model),n.exports=r}).call(this)},"models/point":function(e,t,n){(function(){var e;e=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.subtract=function(e){return add(-e)},e.prototype.invert=function(){return new e(-this.x,-this.y)},e}(),n.exports=e}).call(this)},"models/realtime":function(e,t,n){(function(){var e;e=t("models/rtc"),Spine.Model.Realtime={extended:function(){var t=this;return this.bind("update",e.updateJSON),this.bind("create",e.createJSON),this.bind("destroy",e.deleteJSON),Spine.Model.bind("Model:fileLoad",function(e){return t.loadModelMap(e)}),Spine.Model.bind("Model:fileUpdate",function(e){return t.modelMapUpdate(e)}),this.idCounter=Math.random()},loadModelMap:function(e){var t,n,r;return console.log("load map "+this.className),r=e.get(this.className),n="",r&&(n=r.values().toString()),t="["+n+"]",this.refresh(t||[],{clear:!0}),this.fetch()},modelMapUpdate:function(t){var n,r,i,s,o,u;return this.unbind("update",e.updateJSON),this.unbind("destroy",e.deleteJSON),this.unbind("create",e.createJSON),console.log("modelMapUpdate"),r=t.property,n=r.lastIndexOf(this.className,0)===0,n&&(u=this.fromJSON(t.oldValue),o=this.fromJSON(t.newValue),o?this.exists(o.id)?(s=this.find(o.id),i=s.attributes().selection,i!=null&&o.updateAttribute("selection",i),s.updateAttributes(o.attributes())):(console.log("create:  "+this.className),console.log(o.attributes()),this.create(o.attributes())):(s=this.find(u.id),console.log("null delete "+(s!=null)),s.destroy())),this.bind("update",e.updateJSON),this.bind("create",e.createJSON),this.bind("destroy",e.deleteJSON)}},typeof n!="undefined"&&n!==null&&(n.exports=Spine.Model.Realtime)}).call(this)},"models/rtc":function(e,t,n){function a(){u(),realtimeLoader=new S.RealtimeLoader(realTimeOptions),realtimeLoader.start(f)}function l(e){console.log("initializeModel");var t=e.createMap();e.getRoot().set("modelsMap",t)}function c(e){console.log("onFileLoaded");var t=e.getModel().getRoot().get("modelsMap");t.addEventListener(gapi.drive.realtime.EventType.VALUE_CHANGED,y);var n=t.keys();for(var r in n){var s=t.get(n[r]);s.addEventListener(gapi.drive.realtime.EventType.VALUE_CHANGED,b)}i=e,Spine.Model.trigger("Model:fileLoad",t),w(),E()}Spine=t("spine");var r=r||{};CREATE_SELECTOR="#createDoc",OPEN_SELECTOR="#openDoc",AUTH_BUTTON="authorizeButton",SHARE_SELECTOR="#share",realTimeOptions={appID:"465627783329",clientId:"465627783329-5rt9n9o1m3oum4i1o9quvhe5641u182f.apps.googleusercontent.com",authButtonElementId:AUTH_BUTTON,initializeModel:l,autoCreate:!1,defaultTitle:"Contacts_Map",onFileLoaded:c};var i=null,s=null,o=0,u=function(){$(OPEN_SELECTOR).attr("disabled","true"),$(CREATE_SELECTOR).attr("disabled","true")},f=function(){$(SHARE_SELECTOR).click(d),$(OPEN_SELECTOR).click(h),$(CREATE_SELECTOR).click(function(){var e=prompt("New file name:","");e&&realtimeLoader.createNewFileAndRedirect(e)}),$(OPEN_SELECTOR).removeAttr("disabled"),$(CREATE_SELECTOR).removeAttr("disabled")},h=function(){var e=gapi.auth.getToken().access_token,t=new google.picker.View(google.picker.ViewId.DOCS);t.setMimeTypes(S.REALTIME_MIMETYPE);var n=(new google.picker.PickerBuilder).enableFeature(google.picker.Feature.NAV_HIDDEN).setAppId(realTimeOptions.appId).setOAuthToken(e).addView(t).addView(new google.picker.DocsUploadView).setCallback(p).build();n.setVisible(!0)},p=function(e){if(e.action==google.picker.Action.PICKED){var t=e.docs[0].id;S.redirectTo(t,realtimeLoader.authorizer.userId)}},d=function(){var e=new gapi.drive.share.ShareClient(realTimeOptions.appId);e.setItemIds([S.params.fileId]),e.showSettingsDialog()},v=function(e){var t=i.getModel().getRoot().get("modelsMap"),n=t.get(this.className);n.delete(this.className+e.id)},m=function(e){var t=i.getModel().getRoot().get("modelsMap");if(t.has(this.className)){var n=t.get(this.className);n.set(this.className+e.id,JSON.stringify(e))}else{var n=i.getModel().createMap();t.set(this.className,n),n.set(this.className+e.id,JSON.stringify(e)),n.addEventListener(gapi.drive.realtime.EventType.VALUE_CHANGED,b)}},g=function(e){var t=(new Date).getTime();o=t,console.log("updateJSON ");var n=i.getModel().getRoot().get("modelsMap"),r=n.get(this.className);r.set(this.className+e.id,JSON.stringify(e))},y=function(e){var t=e.isLocal;if(!t){var n=i.getModel().getRoot().get("modelsMap"),r=n.get(e.property);r.addEventListener(gapi.drive.realtime.EventType.VALUE_CHANGED,b)}},b=function(e){var t=e.isLocal;t||Spine.Model.trigger("Model:fileUpdate",e)},w=function(){i.addEventListener(gapi.drive.realtime.EventType.COLLABORATOR_JOINED,E),i.addEventListener(gapi.drive.realtime.EventType.COLLABORATOR_LEFT,E)},E=function(){if(!document.getElementById("collaborators")&&document.getElementsByClassName){var e=document.getElementsByClassName("brand")[0],t=document.createElement("span");t.id="collaborators",t.style.position="absolute",t.style.right="15px",e.appendChild(t)}var t=document.getElementById("collaborators");if(t){var n=i.getCollaborators();t.innerHTML="";if(n.length>1){var r=document.createElement("span");r.style.horizontalAlign="left",t.appendChild(r);for(var o=0;o<n.length;o+=1){var u=n[o];if(!u.isMe){var a=document.createElement("img");a.src=u.photoUrl,a.alt=u.displayName,a.title=u.displayName,a.style.backgroundColor=u.color,a.style.marginLeft="5px",a.style.height="25px",a.style.width="25px",a.style.paddingBottom="5px",t.appendChild(a)}else s=u.userId}}else if(n.length==1){var u=n[0];u.isMe&&(s=u.userId)}}};window.onload=a,e.updateJSON=g,e.deleteJSON=v,e.createJSON=m,"use strict";var S=S||{};S.INSTALL_SCOPE="https://www.googleapis.com/auth/drive.install",S.FILE_SCOPE="https://www.googleapis.com/auth/drive.file",S.OPENID_SCOPE="openid",S.REALTIME_MIMETYPE="application/vnd.google-apps.drive-sdk."+realTimeOptions.appID,S.getParams=function(){var e={},t=window.location.search;if(t){var n=t.slice(1).split("&");for(var r=0;r<n.length;r++){var i=n[r].split("=");e[i[0]]=unescape(i[1])}}return e},S.params=S.getParams(),S.getOption=function(e,t,n){var r=e[t]==undefined?n:e[t];return r==undefined&&console.error(t+" should be present in the options."),r},S.Authorizer=function(e){this.clientId=S.getOption(e,"clientId"),this.userId=S.params.userId,this.authButton=document.getElementById(S.getOption(e,"authButtonElementId"))},S.Authorizer.prototype.start=function(e){var t=this;gapi.load("auth:client,drive-realtime,drive-share",function(){t.authorize(e)})},S.Authorizer.prototype.authorize=function(e){var t=this.clientId,n=this.userId,r=this,i=function(t){t&&!t.error?(r.authButton.disabled=!0,r.fetchUserId(e)):(r.authButton.disabled=!1,r.authButton.onclick=s)},s=function(){gapi.auth.authorize({client_id:t,scope:[S.INSTALL_SCOPE,S.FILE_SCOPE,S.OPENID_SCOPE],user_id:n,immediate:!1},i)};gapi.auth.authorize({client_id:t,scope:[S.INSTALL_SCOPE,S.FILE_SCOPE,S.OPENID_SCOPE],user_id:n,immediate:!0},i)},S.Authorizer.prototype.fetchUserId=function(e){var t=this;gapi.client.load("oauth2","v2",function(){gapi.client.oauth2.userinfo.get().execute(function(n){n.id&&(t.userId=n.id),e&&e()})})},S.createRealtimeFile=function(e,t){gapi.client.load("drive","v2",function(){gapi.client.drive.files.insert({resource:{mimeType:S.REALTIME_MIMETYPE,title:e}}).execute(t)})},S.getFileMetadata=function(e,t){gapi.client.load("drive","v2",function(){gapi.client.drive.files.get({fileId:id}).execute(t)})},S.parseState=function(e){try{var t=JSON.parse(e);return t}catch(n){return null}},S.redirectTo=function(e,t){var n=[];e&&n.push("fileId="+e),t&&n.push("userId="+t),window.location.href=n.length==0?"/":"?"+n.join("&")},S.RealtimeLoader=function(e){this.onFileLoaded=S.getOption(e,"onFileLoaded"),this.initializeModel=S.getOption(e,"initializeModel"),this.registerTypes=S.getOption(e,"registerTypes",function(){}),this.autoCreate=S.getOption(e,"autoCreate",!1),this.defaultTitle=S.getOption(e,"defaultTitle","New Realtime File"),this.authorizer=new S.Authorizer(e)},S.RealtimeLoader.prototype.start=function(e){var t=this;this.authorizer.start(function(){t.registerTypes&&t.registerTypes(),e&&e(),t.load()})},S.RealtimeLoader.prototype.load=function(){var e=S.params.fileId,t=this.authorizer.userId,n=S.params.state,r=this.authorizer,i=function(e){e.type==gapi.drive.realtime.ErrorType.TOKEN_REFRESH_REQUIRED?r.authorize():e.type==gapi.drive.realtime.ErrorType.CLIENT_ERROR?(alert("An Error happened: "+e.message),window.location.href="/"):e.type==gapi.drive.realtime.ErrorType.NOT_FOUND&&(alert("The file was not found. It does not exist or you do not have read access to the file."),window.location.href="/")};if(e){gapi.drive.realtime.load(e,this.onFileLoaded,this.initializeModel,i);return}if(n){var s=S.parseState(n);if(s.action=="open"){e=s.ids[0],t=s.userId,S.redirectTo(e,t);return}}this.autoCreate&&this.createNewFileAndRedirect()},S.RealtimeLoader.prototype.createNewFileAndRedirect=function(e){var t=this;S.createRealtimeFile(e,function(e){e.id?S.redirectTo(e.id,t.authorizer.userId):(console.error("Error creating file."),console.error(e))})}},"models/simplifies_segments":function(e,t,n){(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(){this["for"]=t(this["for"],this)}return e.prototype["for"]=function(e){var t,n,r,i;if(e){i=[];for(n=0,r=e.length;n<r;n++)t=e[n],i.push(this.simplified(t));return i}},e.prototype.simplified=function(e){return{point:{x:e.point.x,y:e.point.y},handleIn:{x:e.handleIn.x,y:e.handleIn.y},handleOut:{x:e.handleOut.x,y:e.handleOut.y}}},e}(),n.exports=e}).call(this)},"views/drawings/canvas_renderer":function(e,t,n){(function(){var e,r,i,s=function(e,t){return function(){return e.apply(t,arguments)}};r=t("models/link"),i=t("models/node"),e=function(){function e(e){this.updateDrawingCache=s(this.updateDrawingCache,this),this.renderOne=s(this.renderOne,this),this.addOne=s(this.addOne,this),this.addAll=s(this.addAll,this),this.bindToChangeEvents=s(this.bindToChangeEvents,this),this.canvas=e.canvas,this.drawing=e.drawing,paper.setup(this.canvas),this.bindToChangeEvents(),this.addAll(i),this.addAll(r)}return e.prototype.bindToChangeEvents=function(){var e=this;return i.bind("refresh",function(){return e.addAll(i)}),r.bind("refresh",function(){return e.addAll(r)}),i.bind("create",this.addOne),r.bind("create",this.addOne)},e.prototype.addAll=function(e){var t,n,r,i,s;t=e.className.toLowerCase()+"s",r=this.drawing[t]().all(),console.log("adding all "+r.length+" "+e.className+"s");for(i=0,s=r.length;i<s;i++)n=r[i],this.renderOne(n);return this.updateDrawingCache()},e.prototype.addOne=function(e){return this.renderOne(e),this.updateDrawingCache()},e.prototype.renderOne=function(e){var n;return n=t("views/drawings/"+e.constructor.className.toLowerCase()+"_renderer"),n?(new n(e)).render():console.warn("no renderer attached for "+e)},e.prototype.updateDrawingCache=function(){return this.drawing.cache=this.canvas.toDataURL(),this.drawing.save()},e}(),n.exports=e}).call(this)},"views/drawings/element_renderer":function(e,t,n){(function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}};e=function(){function e(e){this.remove=t(this.remove,this),this.draw=t(this.draw,this),this.linkElementToModel=t(this.linkElementToModel,this),this.render=t(this.render,this),this.item=e,this.item.bind("update",this.render),this.item.bind("destroy",this.remove)}return e.prototype.render=function(){var e;return e=this.el,this.draw(),this.linkElementToModel(this.el),e&&(this.el.selected=e.selected,e.remove()),paper.view.draw()},e.prototype.linkElementToModel=function(e){var t,n,r,i,s;e.model=this.item;if(e.children){i=e.children,s=[];for(n=0,r=i.length;n<r;n++)t=i[n],s.push(this.linkElementToModel(t));return s}},e.prototype.draw=function(){throw"No draw method has been defined for: "+this.item},e.prototype.remove=function(){return this.el.remove()},e}(),n.exports=e}).call(this)},"views/drawings/index":function(e,t,n){var r=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f,l;t.push('<div class="hero-unit">\n  <div class="row-fluid">\n    <div class="span6">\n      <h2>Rapidly design graphical DSLs</h2>\n      <p>\n         EuGENia Live allows you to quickly build a\n         graphical editor for a domain-specific language.\n         You can use your DSL in the browser, or export and\n         generate more powerful DSL tools that integrate with the\n         Eclipse development environment.\n      </p>\n      <p>\n        <a class="btn btn-medium" target="_blank" href="http://www.di.univaq.it/diruscio/sites/XM2012/xm2012_submission_6.pdf">Workshop Paper &raquo;</a>\n      	<a class="btn btn-medium" target="_blank" href="https://speakerdeck.com/louismrose/eugenia-live-a-flexible-graphical-modelling-tool">Presentation &raquo;</a>\n      	<a class="btn btn-medium" target="_blank" href="https://github.com/louismrose/eugenia-live/"  >Source &raquo;</a>\n      </p>\n    </div>\n    <div class="span5 offset1" style="padding-top: 1em;">\n      <div id="showcase" class="carousel slide">\n        <div class="carousel-inner">\n          <div class="active item">\n            <img src="./img/example_dsl.png" style="" />\n            <!-- <div class="carousel-caption">\n                          <h4>Build a DSL for seating plans...</h4>\n                        </div> -->\n          </div>\n          <div class="item"><img src="http://placekitten.com/g/400/250" /></div>\n          <div class="item"><img src="http://placekitten.com/g/400/250" /></div>\n        </div>\n        <!-- <a class="carousel-control left" href="#showcase" data-slide="prev">&lsaquo;</a>\n                <a class="carousel-control right" href="#showcase" data-slide="next">&rsaquo;</a> -->\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class="row-fluid">\n  <ul class="thumbnails">  \n    <li class="span4">\n      <div class="well" style="background-color: #dcdcdc;">\n        <form>\n		      <legend>Create a new drawing</legend>\n          <label>Name:</label>\n          <input id="name" name="name" type="text" class="span12" required>\n          <label class="select">Palette:</label>\n          <select id="palette" name="palette_specification_id" class="span12">\n            '),f=this.palette_specs;for(s=0,u=f.length;s<u;s++)i=f[s],t.push('\n              <option value="'),t.push(r(i.id)),t.push('">'),t.push(r(i.name)),t.push("</option>\n            ");t.push('\n          </select>\n          <button id="new" class="btn btn-primary" type="submit" style="margin-top: 1.5em;">Go</button>\n          <a href="#" style="margin-top: 1.5em;" class="btn btn-link popover-test" rel="popover" data-trigger="hover" data-placement="right" data-content="Your drawings are stored by your browser. They won\'t be available from other computers, or from other web browsers on the same computer." data-original-title="Local Storage">Where are drawings stored?</a>\n        </form>\n      </div>\n    </li>\n  \n    '),l=this.drawings;for(n=o=0,a=l.length;o<a;n=++o)e=l[n],t.push('\n    <li class="span4 well">\n      <div style="margin-bottom: 10px;">\n        <h3 style="margin-top: 0;">'),t.push(r(e.name)),t.push('</h3>\n      </div>\n      <div>\n        <a href="#/drawings/'),t.push(r(e.id)),t.push('">\n          <img src="'),t.push(r(e.cache)),t.push('" style="background-color: white; border: 1px solid #ddd">\n        </a>\n      </div>\n      <div style="margin-top: 10px; text-align: right;">\n        <button class="btn btn-danger delete" data-id="'),t.push(r(e.id)),t.push('" style="display:inline;">Delete</button>\n      </div>\n    </li>\n    '),(n+2)%3===0&&t.push('\n  </ul>\n</div>\n<div class="row-fluid">\n  <ul class="thumbnails">\n    '),t.push("\n");t.push("\n  </ul>\n</div>")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")};n.exports=r},"views/drawings/link_renderer":function(e,t,n){(function(){var e,r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};e=t("views/drawings/element_renderer"),r=function(e){function t(e){this.draw=i(this.draw,this),t.__super__.constructor.call(this,e)}return o(t,e),t.prototype.draw=function(){return this.el=this.item.toPath(),paper.project.activeLayer.insertChild(0,this.el)},t}(e),n.exports=r}).call(this)},"views/drawings/node_renderer":function(e,t,n){(function(){var e,r,i=function(e,t){return function(){return e.apply(t,arguments)}},s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};e=t("views/drawings/element_renderer"),r=function(e){function t(e){this.draw=i(this.draw,this),t.__super__.constructor.call(this,e)}return o(t,e),t.prototype.draw=function(){return this.el=this.item.toPath()},t}(e),n.exports=r}).call(this)},"views/drawings/selection":function(e,t,n){var r=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i;if(!$.isEmptyObject(this.propertyValues)){t.push('\n  <table class="table table-bordered">\n    <thead>\n      <tr>\n        <th>Property</th>\n        <th>Value</th>\n      </tr>\n    </thead>\n    <tbody>\n      '),i=this.propertyValues;for(e in i)n=i[e],t.push('\n      <tr>\n        <td style="vertical-align:middle">'),t.push(r(e)),t.push('</td>\n        <td><input type="text" data-property="'),t.push(r(e)),t.push('" value="'),t.push(r(n)),t.push('" style="margin-bottom: 0"></td>\n      </tr>\n      ');t.push("\n    </tbody>\n  </table>\n")}}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")};n.exports=r},"views/drawings/show":function(e,t,n){var r=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="row-fluid">\n  <div id="toolbox" class="span2">\n    \n  </div>\n  <div class="span10">\n    <div id="canvas" style="height:400px">\n      <canvas id="drawing" width="1000" height="400"></canvas>\n    </div>\n\n    <div id="selection" class="well">\n    </div>\n  </div>\n</div>')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")};n.exports=r},"views/drawings/toolbox":function(e,t,n){var r=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,n,i,s,o,u,a,f;t.push('<div id="toolbox" class="well">\n\n  <ul class="nav nav-list">\n    <li class="nav-header">Built-in</li>\n    <li class="active"><a href="#" data-tool-name="select">Select</i></a></li>\n  \n    <li class="nav-header">Nodes</li>\n    '),a=this.palette().nodeShapes().all();for(i=0,o=a.length;i<o;i++)n=a[i],t.push('\n      <li><a href="#" data-tool-name="node" data-tool-shape="'),t.push(r(n.id)),t.push('">'),t.push(r(n.displayName())),t.push("</a></li>\n    ");t.push('\n    <li><a href="#/drawings/'),t.push(r(this.id)),t.push('/nodes/new">New...</a></li>\n  \n    <li class="nav-header">Links</li>\n    '),f=this.palette().linkShapes().all();for(s=0,u=f.length;s<u;s++)e=f[s],t.push('\n      <li><a href="#" data-tool-name="link" data-tool-shape="'),t.push(r(e.id)),t.push('">'),t.push(r(e.displayName())),t.push("</a></li>\n    ");t.push('\n      <li><a href="#/drawings/'),t.push(r(this.id)),t.push('/links/new">New...</a></li>\n  </ul>\n\n  <a id="palette-export" class="btn btn-primary" href="#/drawings/'),t.push(r(this.id)),t.push('/palette">\n    <i class="icon-download icon-white"></i> Export palette\n  </a>\n</div>')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")};n.exports=r},"views/palettes/define":function(e,t,n){var r=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="row-fluid">\n  <form>\n    <legend>'),t.push(r(this.verb)),t.push(" "),t.push(r(this.type)),t.push('\n      <ul class="nav nav-pills" style="display: inline; float: right;">\n        <li class="'),this.notation==="json"&&t.push(r("active")),t.push('">\n          <a data-notation="json" href="#">JSON</a>\n        </li>\n        <li class="'),this.notation==="eugenia"&&t.push(r("active")),t.push('">\n          <a data-notation="eugenia" href="#">EuGENia</a>\n        </li>\n      </ul>\n    </legend>\n    <fieldset>\n      <div class="row-fluid">\n        <div class="span6" style="padding-left: 20px">\n          <label for="definition">Definition</label>\n          <textarea class="input-xlarge" style="width: 90%;" id="definition" name="definition" rows="12" required>'),t.push(r(this.serialisation)),t.push('</textarea>\n        </div>\n        <div class="span6" style="padding-right: 20px">\n          <p class="help-block">\n			For example:\n			<pre>'),t.push(r(this.example)),t.push('</pre>\n          </p>\n        </div>\n      </div>\n      <div class="form-actions" style="padding-left: 20px;">\n        <button type="submit" class="btn btn-primary">'),t.push(r(this.verb)),t.push(" "),t.push(r(this.type)),t.push('</button>\n		<button id="cancel" class="btn">Cancel</button>\n		'),this.verb==="Update"&&(t.push('\n		<button id="delete" class="btn btn-danger" style="float:right;">Delete '),t.push(r(this.type)),t.push("</button>\n		")),t.push("	\n      </div>\n    </fieldset>\n  </form>\n</div>")}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")};n.exports=r},"views/palettes/show":function(e,t,n){var r=function(e){e||(e={});var t=[],n=function(e){var n=t,r;return t=[],e.call(this),r=t.join(""),t=n,i(r)},r=function(e){return e&&e.ecoSafe?e:typeof e!="undefined"&&e!=null?o(e):""},i,s=e.safe,o=e.escape;return i=e.safe=function(e){if(e&&e.ecoSafe)return e;if(typeof e=="undefined"||e==null)e="";var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){t.push('<div class="page-header">\n  <h1>Export your palette&nbsp;&nbsp;<small>Generate an Eclipse-based editor</small></h1>\n</div>\n\n<div class="row-fluid">\n  <div class="span8">\n    <p>\n      Follow the instructions below to generate a graphical editor from\n      your EuGENia Live palette. The generated editor will integrate \n      with the Eclipse IDE. You\'ll be able to extend your editor with lots\n      of features that EuGENia Live doesn\'t yet support, such as: \n      <a href="http://epsilonblog.wordpress.com/2008/01/18/model-refactoring-in-gmf-based-editors-with-ewl/">wizards</a> and <a href="http://www.eclipse.org/epsilon/doc/articles/evl-gmf-integration/">validation</a> using Epsilon or automatic layout using\n      <a href="http://www.informatik.uni-kiel.de/en/rtsys/kieler/">KIELER</a>.\n    </p>\n    \n    <ol class="instructions">\n      <li>\n        <strong>Install Epsilon, EuGENia and Emfatic</strong> by following <a href="http://www.eclipse.org/epsilon/download/" target="_blank">these instructions</a>.\n      </li>\n      \n      <li>\n        <strong>Copy the following Emfatic code to the clipboard</strong>\n        <pre>'),t.push(r(this.eugenia)),t.push('</pre>\n      </li>\n      \n      <li>\n        <strong>Create a new EuGENia project</strong>\n        <ol>\n          <li>Start Eclipse</li>\n          <li>Select File -&gt; New -&gt; Project... and select Java Project. Give the project a name, and use the default options.</li>\n          <li>Select File -&gt; New -&gt; Other... and select Emfatic file. Select your project as the container, and give the file a name. </li>\n          <li>Open the Emfatic file and replace its contents with the Emfatic code shown above.</li>\n          <li>Save the Emfatic file.</li>\n          <li>Right-click the Emfatic file and select Eugenia -&gt; Generate GMF Editor.</li>\n        </ol>\n      </li>\n      \n      <li>\n        <strong>Use the generated GMF editor</strong>\n        <ol>\n          <li>Select Run -&gt; Run Configurations... and create a new\nEclipse Application run configuration.</li>\n         <li>Use the following VM arguments: <pre>-XX:PermSize=64M -XX:MaxPermSize=128M -Xms512M -Xmx1024M</pre></li>\n         <li>Click Run</li>\n         <li>In the new Eclipse instance, use the File -&gt; New menu to create a new diagram with your GMF editor. The resulting editor will look similar to the one shown below.</li>\n        </ol>\n        <img src="http://www.eclipse.org/epsilon/doc/articles/eugenia-gmf-tutorial/Filesystemscreenshot2.png"/>\n      </li>\n      \n      <li>\n        <strong>Learn more about EuGENia</strong> by reading <a href="http://www.eclipse.org/epsilon/doc/eugenia/">the documentation</a>.\n      </li>\n    </ol>\n  </div>\n</div>')}).call(this)}.call(e),e.safe=s,e.escape=o,t.join("")};n.exports=r}}),jade.rethrow=function(t,n,r){throw t}